{"version":3,"file":"index.js","sources":["../src/reflect.ts","../src/isprimitive.ts","../src/util.ts","../src/assetbrowser.ts","../src/reactivestate.ts","../src/iscomponent.ts","../src/readysymbol.ts","../src/dom.ts","../src/isconnected.ts","../src/directives.ts","../src/context-mounted-unmounted-.ts","../src/watch.ts","../src/toArray.ts","../src/onevent.ts","../src/CustomElementRegistry.ts","../src/customelement.ts","../src/mount.ts","../node_modules/dom-element-attribute-agent-proxy/dist/index.js","../src/merge-entries.ts","../src/virtualdom.ts","../src/rendervdomtoreal.ts","../src/attrchange.ts","../src/setimmediate.ts","../src/readonlyproxy.ts","../node_modules/deep-observe-agent-proxy/dist/index.js","../src/createstate.ts","../node_modules/htm/dist/htm.module.js","../src/createelement.ts","../src/createApp.ts","../src/html.ts","../src/cssurlblob.ts","../src/parsecss.ts","../src/createComponent.ts","../src/elementonmountandunmount.ts","../src/conditon.ts","../src/computed.ts","../src/createref.ts","../src/extend-directive.ts","../src/input-textarea-value-directive-Bidirectional-binding.ts","../src/index.ts"],"sourcesContent":["const Reflect = window.Reflect;\r\nexport default Reflect;\r\n\r\nexport const {\r\n  //   apply,\r\n  construct,\r\n  //   defineProperty,\r\n  deleteProperty,\r\n  get,\r\n  getOwnPropertyDescriptor,\r\n  getPrototypeOf,\r\n  has,\r\n\r\n  //   isExtensible,\r\n  ownKeys,\r\n  //   preventExtensions,\r\n  set\r\n  //   setPrototypeOf\r\n} = Reflect;\r\n// export {};\r\n/*\r\napply()\r\n对一个函数进行调用操作，同时可以传入一个数组作为调用参数。和 Function.prototype.apply() 功能类似。\r\nconstruct()\r\n对构造函数进行 new 操作，相当于执行 new target(...args)。\r\ndefineProperty()\r\n和 Object.defineProperty() 类似。\r\ndeleteProperty()\r\n作为函数的delete操作符，相当于执行 delete target[name]。\r\n//Reflect.enumerate()\r\n该方法会返回一个包含有目标对象身上所有可枚举的自身字符串属性以及继承字符串属性的迭代器，for...in 操作遍历到的正是这些属性。\r\nget()\r\n获取对象身上某个属性的值，类似于 target[name]。\r\ngetOwnPropertyDescriptor()\r\n类似于 Object.getOwnPropertyDescriptor()。\r\ngetPrototypeOf()\r\n类似于 Object.getPrototypeOf()。\r\nhas()\r\n判断一个对象是否存在某个属性，和 in 运算符 的功能完全相同。\r\nisExtensible()\r\n类似于 Object.isExtensible().\r\nownKeys()\r\n返回一个包含所有自身属性（不包含继承属性）的数组。(类似于 Object.keys(), 但不会受enumerable影响).\r\npreventExtensions()\r\n类似于 Object.preventExtensions()。返回一个Boolean。\r\nset()\r\n将值分配给属性的函数。返回一个Boolean，如果更新成功，则返回true。\r\nsetPrototypeOf()\r\n类似于 Object.setPrototypeOf()。\r\n*/\r\n","import { isString, isnumber, isboolean, isundefined } from \"./util\";\r\nexport default function(a: any) {\r\n  return (\r\n    isString(a) ||\r\n    isnumber(a) ||\r\n    isboolean(a) ||\r\n    isundefined(a) ||\r\n    typeof a === \"bigint\"\r\n  );\r\n}\r\n","import { /* has,  */ get } from \"./reflect\";\r\nimport { isFunction } from \"./util\";\r\n/* eslint-disable @typescript-eslint/explicit-function-return-type */\r\nexport function isundefined(a: any) {\r\n  return typeof a === \"undefined\";\r\n}\r\n\r\nexport function isnumber(a: any): a is number {\r\n  return typeof a === \"number\";\r\n}\r\nexport function isboolean(a: any) {\r\n  return typeof a === \"boolean\";\r\n}\r\nexport function isobject(a: any): a is object {\r\n  return typeof a === \"object\" && a !== null;\r\n}\r\n// export function isstring(a: string): true;\r\n// export function isstring(a): boolean;\r\nexport function isstring(a: any): a is string {\r\n  return typeof a === \"string\";\r\n}\r\nexport function isfunction(a: any): a is Function {\r\n  return typeof a === \"function\";\r\n}\r\n\r\nexport function isarray(a: any): a is Array<any> {\r\n  return a instanceof Array && Array.isArray(a) && gettagtype(a) === \"array\";\r\n}\r\nexport { isfunction as isFunction, isarray as isArray, isstring as isString };\r\nexport function getsymbol(a: string) {\r\n  return Symbol(a);\r\n}\r\nexport function gettagtype(a: any): string {\r\n  return {}.toString\r\n    .call(a)\r\n    .replace(\"[object \", \"\")\r\n    .replace(\"]\", \"\")\r\n    .toLowerCase()\r\n    .trim();\r\n}\r\nexport function ispromise(a: any): a is Promise<any> {\r\n  return gettagtype(a) === \"promise\" && isFunction(get(a, \"then\"));\r\n}\r\nexport function isSet(a: any): a is Set<any> {\r\n  return gettagtype(a) === \"set\" && a instanceof Set;\r\n}\r\nimport isprimitive from \"./isprimitive\";\r\nexport { isprimitive };\r\n","import { isobject, isfunction } from \"./util\";\r\nif (\r\n  !isfunction(window.HTMLElement) ||\r\n  //   typeof HTMLElement !== \"function\" ||\r\n  !isfunction(window.Proxy) ||\r\n  //   typeof Proxy !== \"function\" ||\r\n  !isobject(window.customElements) ||\r\n  //   typeof customElements !== \"object\" ||\r\n  !isfunction(window.CustomElementRegistry)\r\n  //||\r\n  //   typeof CustomElementRegistry !== \"function\"\r\n) {\r\n  throw new TypeError(\" browser not supported !\");\r\n}\r\n","export const invalid_primitive_or_object_state =\r\n  \"invalid primitive or object state\";\r\nexport function isReactiveState(a: any): a is ReactiveState {\r\n  return a instanceof ReactiveState;\r\n}\r\n// import Reflect from \"./reflect\";\r\nimport { getsymbol, isobject, isSet } from \"./util\";\r\n// export const textnodesymbol = Symbol(\"textnode\");\r\nexport const changetextnodesymbol = Symbol(\"changetextnode\");\r\nimport isprimitive from \"./isprimitive\";\r\nimport { get } from \"./reflect\";\r\nexport const eventtargetsymbol = Symbol(\"eventtatget\");\r\nexport const memlisteners = Symbol(\"memlisteners\");\r\nexport const dispatchsymbol = Symbol(\"dispatch\");\r\nexport const subscribesymbol = getsymbol(\"subscribe\");\r\nexport const removeallistenerssymbol = getsymbol(\"removeallisteners\");\r\nexport const addallistenerssymbol = getsymbol(\"addallisteners\");\r\n/* const forkarryaprototype = {};\r\nownKeys(Array.prototype).forEach(key => {\r\n  forkarryaprototype[key] = Array.prototype[key];\r\n}); */\r\n/* class forkarray {}\r\nObject.assign(forkarray.prototype, forkarryaprototype);\r\nforkarray.prototype.constructor = forkarray;\r\ndeleteProperty(forkarray.prototype, \"length\"); */\r\nexport default class ReactiveState\r\n/* extends forkarray  */\r\n\r\n{\r\n  /* get [Symbol.toStringTag]() {\r\n    return \"ReativeState\";\r\n\r\n} */\r\n  [addallistenerssymbol]() {\r\n    this[memlisteners].forEach(([value, callback]) => {\r\n      this[eventtargetsymbol].addEventListener(value, callback);\r\n    });\r\n  }\r\n  /*  [changetextnodesymbol](textnode: Text) {\r\n    this[textnodesymbol] = textnode;\r\n  } */\r\n  // [textnodesymbol]: Text | undefined;\r\n  value: string | number | boolean | undefined | object;\r\n  [eventtargetsymbol] = new EventTarget();\r\n  [memlisteners]: Array<[string, EventListener]> = [];\r\n  constructor(init?: string | number | boolean | object | undefined) {\r\n    //super();\r\n    if (isprimitive(init) || isobject(init)) {\r\n      Object.defineProperty(this, \"value\", {\r\n        value: init,\r\n        configurable: true,\r\n        writable: true\r\n      });\r\n\r\n      // this.value = init;\r\n    } else {\r\n      console.error(init);\r\n      throw TypeError(invalid_primitive_or_object_state);\r\n    }\r\n    // this[eventtargetsymbol] = new EventTarget();\r\n\r\n    /*\r\n    Object.defineProperty(this, Symbol.toStringTag, {\r\n      value: \"ReactiveState\",\r\n      configurable: true\r\n    });\r\n\r\n*/\r\n  }\r\n\r\n  valueOf() {\r\n    return this.value;\r\n  }\r\n  toString() {\r\n    const value = this.value;\r\n    return isprimitive(value)\r\n      ? String(value)\r\n      : isSet(value)\r\n      ? JSON.stringify([...value])\r\n      : isobject(value)\r\n      ? JSON.stringify(value)\r\n      : \"\";\r\n  }\r\n  [dispatchsymbol](eventname?: string) {\r\n    const name = eventname ? String(eventname) : \"value\";\r\n    if (name !== \"value\") {\r\n      this[eventtargetsymbol].dispatchEvent(\r\n        new CustomEvent(name, { detail: name })\r\n      );\r\n    }\r\n\r\n    this[eventtargetsymbol].dispatchEvent(\r\n      new CustomEvent(\"value\", { detail: name })\r\n    );\r\n  }\r\n  [subscribesymbol](callback: Function, eventname?: string) {\r\n    // this[eventtargetsymbol].addEventListener(\"value\", callback);\r\n    const name = eventname ? String(eventname) : \"value\";\r\n    this[memlisteners].push([\r\n      name,\r\n      (event: Event) => callback.call(undefined, this, get(event, \"detail\"))\r\n    ]);\r\n  } /*  */\r\n  [removeallistenerssymbol]() {\r\n    this[memlisteners].forEach(([value, callback]) => {\r\n      this[eventtargetsymbol].removeEventListener(value, callback);\r\n    });\r\n  }\r\n  [Symbol.toPrimitive]() {\r\n    //return this.value;\r\n    const value = this.value;\r\n    return isprimitive(value)\r\n      ? value\r\n      : isobject(value)\r\n      ? JSON.stringify(value)\r\n      : void 0;\r\n  }\r\n}\r\nReflect.defineProperty(ReactiveState.prototype, Symbol.toStringTag, {\r\n  value: \"ReactiveState\"\r\n});\r\n","const componentsymbol = Symbol(\"component\");\r\nexport { componentsymbol };\r\n","export const readysymbol = Symbol(\"ready\");\r\n","const document = window.document;\r\n//import { seteletext, setelehtml } from \"./directives\";\r\n//export { seteletext, setelehtml };\r\n\r\nexport function seteletext(e: Element | Node, v: string) {\r\n  e.textContent = v;\r\n}\r\nexport function setelehtml(e: Element, v: string) {\r\n  e.innerHTML = v;\r\n}\r\nexport function appendchild(\r\n  container: HTMLElement | SVGSVGElement | SVGElement | Element | Node,\r\n  ele: HTMLElement | SVGElement | Element | Node\r\n) {\r\n  container.appendChild(ele);\r\n}\r\nexport function createsvgelement() {\r\n  return createElementNS(svgnamespace, \"svg\");\r\n}\r\nexport function createnonescript() {\r\n  return createDocumentFragment();\r\n}\r\nexport function createDocumentFragment() {\r\n  return document.createDocumentFragment();\r\n}\r\nexport function createnativeelement(type: string) {\r\n  return document.createElement(type);\r\n}\r\nexport function createElementNS(namespace: string, name: string) {\r\n  return document.createElementNS(namespace, name);\r\n}\r\nexport function createtextnode(data: string | number) {\r\n  return document.createTextNode(String(data));\r\n}\r\nexport const svgnamespace = \"http://www.w3.org/2000/svg\";\r\nexport function changetext(textnode: Text, value: string) {\r\n  textnode.nodeValue = String(value);\r\n}\r\nexport default document;\r\n\r\nexport const mathnamespace = \"http://www.w3.org/1998/Math/MathML\";\r\n\r\nexport function createmathelement() {\r\n  return createElementNS(mathnamespace, \"math\");\r\n}\r\nexport function createComment() {\r\n  return document.createComment(\"\");\r\n}\r\nexport function removeNode(node: Element) {\r\n  let parentNode = node.parentNode;\r\n  if (parentNode) {\r\n    parentNode.removeChild(node);\r\n  }\r\n}\r\nexport function replaceChild(newChild: Node, oldChild: Node) {\r\n  let parentNode = oldChild.parentNode;\r\n  if (parentNode) {\r\n    parentNode.replaceChild(newChild, oldChild);\r\n  }\r\n}\r\n\r\nexport function domaddlisten(\r\n  ele: Element | Node,\r\n  event: string,\r\n  call: EventListener\r\n) {\r\n  ele.addEventListener(event, call);\r\n}\r\n\r\nexport function domremovelisten(\r\n  ele: Element | Node,\r\n  event: string,\r\n  call: EventListener\r\n) {\r\n  ele.removeEventListener(event, call);\r\n}\r\nexport function getdomchildren(ele: Element | Node) {\r\n  return Array.from(ele.childNodes);\r\n}\r\nexport function getAttribute(ele: Element, name: string) {\r\n  return HTMLElementprototype.getAttribute.call(ele, name);\r\n}\r\nexport function setAttribute(ele: Element, name: string, value: any) {\r\n  HTMLElementprototype.setAttribute.call(ele, name, value);\r\n}\r\nexport function removeAttribute(ele: Element, name: string) {\r\n  HTMLElementprototype.removeAttribute.call(ele, name);\r\n}\r\nconst HTMLElementprototype = HTMLElement.prototype;\r\n\r\nexport function insertfirst(\r\n  container: HTMLElement | Element,\r\n  ele: HTMLElement\r\n) {\r\n  container.insertBefore(ele, container.firstChild);\r\n}\r\nexport function createanotherhtmldocument() {\r\n  return document.implementation.createHTMLDocument(\"\");\r\n}\r\nexport function getparentNode(ele: Node) {\r\n  return ele.parentNode;\r\n}\r\n","import { getparentNode } from \"./dom\";\r\n\r\nexport function isconnected(element: Node) {\r\n  return document.documentElement === getancestornode(element);\r\n}\r\nfunction getancestornode(node: Node) {\r\n  while (getparentNode(node) && getparentNode(node) !== document) {\r\n    node = node.parentNode;\r\n  }\r\n  return node;\r\n}\r\n","export const requestAnimationFrame = window.requestAnimationFrame;\r\nimport { seteletext, setelehtml } from \"./dom\";\r\n\r\nimport { watch } from \"./watch\";\r\nimport ReactiveState, { isReactiveState } from './reactivestate';\r\nimport { isconnected } from \"./isconnected\";\r\nimport { isobject } from \"./util\";\r\nexport default {\r\n  ref(ele: Element, ref: { value: any }) {\r\n    if (isobject(ref)) {\r\n      ref.value = ele;\r\n    } else {\r\n      throw TypeError(\"invalid ref\");\r\n    }\r\n  },\r\n  html(ele: Element, html: string | ReactiveState) {\r\n    createhtmlandtextdirective(setelehtml, \"html\")(ele, html);\r\n\r\n    // ele.innerHTML = html;\r\n    // console.log(ele.outerHTML);\r\n    /*  if (typeof html == \"string\") {\r\n      requestAnimationFrame(() => {\r\n        setelehtml(ele, html);\r\n\r\n        /* ele.innerHTML = html;*/\r\n    //   console.log(ele.outerHTML);\r\n    /*     });\r\n    } else if (html instanceof ReactiveState) {\r\n      //   const ReactiveState = html;\r\n      watch(html, (state: { value: any }) => {\r\n        /*ele.innerHTML = String(state);*/\r\n    /*\r\n        setelehtml(ele, String(state));\r\n      });\r\n      //   ReactiveState[subscribesymbol]((state: { value: any }) => {\r\n      //     ele.innerHTML = String(state.value);\r\n      //   });\r\n      requestAnimationFrame(() => {\r\n        // console.log(\"html\");\r\n        /*  ele.innerHTML = String(html);*/\r\n    /*\r\n        setelehtml(ele, String(html));\r\n      });\r\n    } else {\r\n      throw TypeError(\"invalid html\");\r\n    }\r\n\r\n*/\r\n  },\r\n  text(ele: Element, text: string | ReactiveState) {\r\n    createhtmlandtextdirective(seteletext, \"text\")(ele, text);\r\n\r\n    /*\r\n\r\n  // ele.textContent = text;\r\n    // console.log(ele.outerHTML);\r\n    if (typeof text == \"string\") {\r\n      requestAnimationFrame(() => {\r\n        seteletext(ele, text);\r\n        /*    ele.textContent = text;*/\r\n    /*      //   console.log(ele.outerHTML);\r\n      });\r\n    } else if (text instanceof ReactiveState) {\r\n      //   const ReactiveState = text;\r\n      watch(text, (state: { value: any }) => {\r\n        seteletext(ele, String(state));\r\n\r\n        /* ele.textContent = String(state);*/\r\n    /*   });\r\n      //   ReactiveState[subscribesymbol]((state: { value: any }) => {\r\n      //     ele.textContent = String(state.value);\r\n      //   });\r\n      requestAnimationFrame(() => {\r\n        // console.log(\"text\");\r\n        seteletext(ele, String(text));\r\n\r\n        /*  ele.textContent = String(text);*/\r\n    /*    });\r\n    } else {\r\n      throw TypeError(\"invalid text\");\r\n    }\r\n\r\n*/\r\n  }\r\n};\r\nfunction createhtmlandtextdirective(seteletext: Function, errorname: string) {\r\n  return function(ele: Element, text: string | ReactiveState) {\r\n    const element = ele;\r\n    if (typeof text == \"string\") {\r\n      requestAnimationFrame(() => {\r\n        seteletext(ele, text);\r\n        /*    ele.textContent = text;*/\r\n        //   console.log(ele.outerHTML);\r\n      });\r\n    } else if (\r\n      isReactiveState(text)\r\n      //  text instanceof ReactiveState\r\n    ) {\r\n      //   const ReactiveState = text;\r\n      watch(text, (state: { value: any }) => {\r\n        if (isconnected(element)) {\r\n          seteletext(ele, String(state));\r\n        }\r\n        /* ele.textContent = String(state);*/\r\n      });\r\n      //   ReactiveState[subscribesymbol]((state: { value: any }) => {\r\n      //     ele.textContent = String(state.value);\r\n      //   });\r\n      requestAnimationFrame(() => {\r\n        // console.log(\"text\");\r\n        seteletext(ele, String(text));\r\n\r\n        /*  ele.textContent = String(text);*/\r\n      });\r\n    } else {\r\n      throw TypeError(\"invalid \" + errorname);\r\n    }\r\n  };\r\n}\r\n","import { isFunction } from \"./util\";\r\nimport ReactiveState from './reactivestate';\r\nexport const invalid_Function = \"invalid Function\";\r\nconst errormessage =\r\n  \"invalid useMounted or useUnMounted out of createComponent\";\r\nlet ctxopen = false;\r\nlet MountedSet: Set<Function> = new Set();\r\nlet UnMountedSet: Set<Function> = new Set();\r\nlet StateSet: Set<ReactiveState> = new Set();\r\n/* 收集组件内部创建的 ReactiveState*/\r\nexport function getstates() {\r\n  return [...StateSet];\r\n}\r\nexport function usestste(state: ReactiveState) {\r\n  if (ctxopen) {\r\n    StateSet.add(state);\r\n  }\r\n}\r\nexport function getMounted() {\r\n  return [...MountedSet];\r\n}\r\nexport function getUnMounted() {\r\n  return [...UnMountedSet];\r\n}\r\nexport function useMounted(fun: Function) {\r\n  if (isFunction(fun)) {\r\n    if (ctxopen) {\r\n      MountedSet.add(fun);\r\n    } else {\r\n      throw Error(errormessage);\r\n    }\r\n  } else {\r\n    throw TypeError(invalid_Function);\r\n  }\r\n}\r\n\r\nexport function useUnMounted(fun: Function) {\r\n  if (isFunction(fun)) {\r\n    if (ctxopen) {\r\n      UnMountedSet.add(fun);\r\n    } else {\r\n      throw Error(errormessage);\r\n    }\r\n  } else {\r\n    throw TypeError(invalid_Function);\r\n  }\r\n}\r\nexport function clearMounted() {\r\n  MountedSet = new Set();\r\n}\r\n\r\nfunction clearstate() {\r\n  StateSet = new Set();\r\n}\r\nexport function clearUnMounted() {\r\n  UnMountedSet = new Set();\r\n}\r\nexport function openctx() {\r\n  ctxopen = true;\r\n  clearall();\r\n}\r\nexport function closectx() {\r\n  ctxopen = false;\r\n  clearall();\r\n}\r\nfunction clearall() {\r\n  clearMounted();\r\n  clearUnMounted();\r\n  clearstate();\r\n}\r\n","import { requestAnimationFrame } from \"./directives\";\r\nimport { isFunction } from \"./util\";\r\nimport ReactiveState, {\r\n  isReactiveState,\r\n  subscribesymbol,\r\n  removeallistenerssymbol,\r\n  addallistenerssymbol\r\n} from './reactivestate';\r\nimport { invalid_ReactiveState } from \"./conditon\";\r\nimport { invalid_Function } from \"./context-mounted-unmounted-\";\r\nexport function watch(\r\n  state: ReactiveState,\r\n  callback: Function,\r\n  statekey?: string\r\n): void {\r\n  if (\r\n    !(\r\n      isReactiveState(state) &&\r\n      // state instanceof ReactiveState\r\n      isFunction(callback)\r\n    )\r\n  ) {\r\n    console.error(state);\r\n    console.error(callback);\r\n    throw TypeError(invalid_ReactiveState + invalid_Function);\r\n  }\r\n\r\n  if (statekey) {\r\n    state[subscribesymbol](callback, statekey);\r\n  } else {\r\n    state[subscribesymbol](callback);\r\n  }\r\n\r\n  requestAnimationFrame(() => {\r\n    state[addallistenerssymbol]();\r\n  });\r\n}\r\nexport function unwatch(state: ReactiveState): void {\r\n  state[removeallistenerssymbol]();\r\n}\r\n\r\nexport function rewatch(state: ReactiveState): void {\r\n  state[addallistenerssymbol]();\r\n}\r\n","import { isArray } from \"./util\";\r\n/* export function toArray<T not Array>(a: T): Array<T>;\r\nexport function toArray<T>(a: Array<T>): Array<T>; */\r\n// export function toArray<T>(a: Array<T>): Array<T>;\r\nexport function toArray(a: any): any[] {\r\n  return (isArray(a) ? a : [a]).flat();\r\n}\r\n","import { toArray } from \"./toArray\";\r\nimport { invalid_Function } from \"./context-mounted-unmounted-\";\r\nimport { domaddlisten, domremovelisten } from \"./dom\";\r\nexport const eventlistenerssymbol = Symbol(\"eventlisteners\");\r\nimport { /* isArray, */ isfunction } from \"./util\";\r\nexport default function(\r\n  element: Element | Node,\r\n  eventname: string,\r\n  callback: EventListener | Array<EventListener>\r\n) {\r\n  /* if (!element[eventlistenerssymbol]) {\r\n    element[eventlistenerssymbol] = [];\r\n  }\r\n*/\r\n  firstaddlisteners(element, eventname, toArray(callback));\r\n  /*\r\n  if (isfunction(callback)) {\r\n    firstaddlisteners(element, eventname, [callback]);\r\n  } else if (isArray(callback)) {\r\n    firstaddlisteners(element, eventname, callback);\r\n  } else {\r\n    console.error(callback);\r\n    throw TypeError(invalid_Function);\r\n  }*/\r\n}\r\nexport function firstaddlisteners(\r\n  ele: Element | Node,\r\n  event: string,\r\n  callarray: Array<EventListener>\r\n) {\r\n  const element = ele;\r\n  callarray.forEach((call: EventListener) => {\r\n    if (!isfunction(call)) {\r\n      console.error(call);\r\n      throw TypeError(invalid_Function);\r\n    }\r\n\r\n    if (!element[eventlistenerssymbol]) {\r\n      element[eventlistenerssymbol] = [];\r\n    }\r\n\r\n    ele[eventlistenerssymbol].push([event, call]);\r\n    domaddlisten(ele, event, call);\r\n  });\r\n}\r\nexport function removelisteners(\r\n  ele: Element | Node\r\n  //   event: string,\r\n  //   callarray: Array<EventListener>\r\n) {\r\n  // const element = ele;\r\n  if (ele[eventlistenerssymbol]) {\r\n    ele[eventlistenerssymbol].forEach(([event, call]) => {\r\n      //   ele[eventlistenerssymbol].push([event, call]);\r\n      domremovelisten(ele, event, call);\r\n    });\r\n  }\r\n}\r\nexport function readdlisteners(\r\n  ele: Element | Node\r\n  //   event: string,\r\n  //   callarray: Array<EventListener>\r\n) {\r\n  if (ele[eventlistenerssymbol]) {\r\n    ele[eventlistenerssymbol].forEach(([event, call]) => {\r\n      //   ele[eventlistenerssymbol].push([event, call]);\r\n      domaddlisten(ele, event, call);\r\n    });\r\n  }\r\n}\r\n","export const invalid_custom_element_class = \"invalid custom element class !\";\r\nimport { isobject } from \"./util\";\r\nif (\r\n  //   typeof Proxy !== \"function\" ||\r\n  !isobject(window.customElements) //||\r\n  //   typeof customElements !== \"object\" ||\r\n\r\n  //||\r\n  //   typeof CustomElementRegistry !== \"function\"\r\n) {\r\n  throw new TypeError(\" customElements  not supported !\");\r\n}\r\nimport { isclassextendsHTMLElement } from \"./customelement\";\r\n\r\nfunction 使用value从表中查询key(表: object, 组件状态名: any) {\r\n  return Object.entries(表).find(v => {\r\n    return v[1] === 组件状态名;\r\n  })[0];\r\n}\r\n\r\nimport { get, getPrototypeOf, has } from \"./reflect\";\r\ninterface ElementDefinitionOptions {\r\n  extends?: string;\r\n}\r\nwindow.CustomElementRegistry = get(\r\n  getPrototypeOf(window.customElements),\r\n  \"constructor\"\r\n);\r\nconst { customElements, CustomElementRegistry } = window;\r\n\r\n// export default customElements;\r\nconst elementset = Symbol.for(\"elementset\");\r\nconst elementmap = Symbol.for(\"elementmap\");\r\nexport default (initclass: Function, extendsname?: string) =>\r\n  RandomDefineCustomElement(initclass, extendsname);\r\n\r\nfunction RandomDefineCustomElement(\r\n  initclass: Function,\r\n  extendsname?: string,\r\n  length = 1\r\n): string {\r\n  if (!isclassextendsHTMLElement(initclass)) {\r\n    throw TypeError(invalid_custom_element_class);\r\n  }\r\n\r\n  //如果未注册自定义组件，则用随机名称注册，如果名称重复则重新生成新的随机名\r\n\r\n  if (!customElements[elementset].has(initclass)) {\r\n    const elementname = getrandomstringandnumber(length);\r\n\r\n    if (customElements.get(elementname)) {\r\n      return RandomDefineCustomElement(initclass, extendsname, length + 1);\r\n    } else {\r\n      if (extendsname) {\r\n        customElements.define(elementname, initclass, { extends: extendsname });\r\n      } else {\r\n        customElements.define(elementname, initclass);\r\n      }\r\n    }\r\n\r\n    return elementname;\r\n  } else {\r\n    return 使用value从表中查询key(customElements[elementmap], initclass);\r\n  }\r\n\r\n  //如果已经注册自定义组件，则返回注册的名称\r\n}\r\nif (!customElements[elementset]) {\r\n  customElements[elementset] = new Set();\r\n}\r\nif (!customElements[elementmap]) {\r\n  customElements[elementmap] = {};\r\n}\r\n/* customElements.get = function name(name) {\r\n  return customElements[elementmap].get(name);\r\n};\r\n */\r\ncustomElements.define = function(\r\n  name: string,\r\n  constructor: Function,\r\n  options?: ElementDefinitionOptions\r\n): void {\r\n  if (!isclassextendsHTMLElement(constructor)) {\r\n    console.error(constructor);\r\n    throw TypeError(invalid_custom_element_class);\r\n  }\r\n  if (!customElements[elementset].has(constructor)) {\r\n    if (has(customElements[elementmap], name)) {\r\n      /* 防止定义重名 */\r\n      RandomDefineCustomElement(\r\n        constructor,\r\n        options ? options.extends : undefined\r\n      );\r\n    } else {\r\n      CustomElementRegistry.prototype.define.call(\r\n        customElements,\r\n        name,\r\n        constructor,\r\n        options\r\n      );\r\n      customElements[elementset].add(constructor);\r\n      customElements[elementmap][name] = constructor;\r\n    }\r\n  }\r\n};\r\n\r\ncustomElements[Symbol.iterator] = () => {\r\n  const entries = Object.entries(customElements[elementmap]);\r\n\r\n  return entries[Symbol.iterator].call(entries);\r\n};\r\nfunction getrandomcharactor() {\r\n  return get(\r\n    Array(26)\r\n      .fill(undefined)\r\n      .map((v, i) => 97 + i)\r\n      .map(n => String.fromCharCode(n)),\r\n    Math.floor(Math.random() * 26)\r\n  );\r\n\r\n  // [Math.floor(Math.random() * 26)];\r\n}\r\nfunction getrandomhexnumber() {\r\n  return get(\r\n    Array(16)\r\n      .fill(undefined)\r\n      .map((v, i) => i),\r\n    Math.floor(Math.random() * 16)\r\n  ).toString(16);\r\n\r\n  /*  Array(16)\r\n    .fill(undefined)\r\n    .map((v, i) => i)\r\n    [Math.floor(Math.random() * 16)].toString(16); */\r\n}\r\nfunction getrandomstringandnumber(length = 4) {\r\n  return (\r\n    Array(length)\r\n      .fill(undefined)\r\n      .map(() => getrandomcharactor())\r\n\r\n      .join(\"\") +\r\n    \"-\" +\r\n    Array(length)\r\n      .fill(undefined)\r\n      .map(() => getrandomhexnumber())\r\n      .join(\"\")\r\n  );\r\n}\r\n","import { invalid_custom_element_class } from \"./CustomElementRegistry\";\r\n\r\n//import setlikearray from \"./setlikearay\";\r\n\r\n// const customElementsarray = new Set;\r\nimport RandomDefineCustomElement from \"./CustomElementRegistry\";\r\n/* function getcustomelementname(initclass: any): string {\r\n  return customElements(initclass);\r\n} */\r\nimport { isfunction } from \"./util\";\r\nexport function isclassextendsHTMLElement(initclass: {\r\n  prototype: any;\r\n}): initclass is Class {\r\n  return !!(\r\n    isfunction(initclass) &&\r\n    initclass.prototype &&\r\n    initclass.prototype instanceof HTMLElement\r\n  );\r\n}\r\n\r\nimport { construct } from \"./reflect\";\r\nimport { Class } from \"./customclass\";\r\n// import Reflect from \"./reflect\";\r\n\r\n// import { Class } from \"./rendervdomtoreal\";\r\n\r\nexport function createcostumelemet(\r\n  initclass: Class | Function,\r\n  propsjson?: object,\r\n  children?: any[],\r\n  options?: any\r\n): HTMLElement {\r\n  if (isclassextendsHTMLElement(initclass)) {\r\n    // customElementsarray.push(initclass);\r\n    /*   const elementname =\r\n     getcustomelementname(initclass); */\r\n    /* if (customElements.get(elementname) === initclass) {\r\n    } else {\r\n      customElements.define(elementname, initclass);\r\n    } */\r\n    RandomDefineCustomElement(initclass);\r\n    return construct(initclass, [propsjson, children, options]); // (children);\r\n  } else {\r\n    console.error(initclass);\r\n\r\n    throw TypeError(invalid_custom_element_class);\r\n  }\r\n}\r\n","import { appendchild, /* setelehtml,  */ seteletext } from \"./dom\";\r\nimport { toArray } from \"./toArray\";\r\nexport default function(\r\n  ele:\r\n    | Node\r\n    | Array<\r\n        | HTMLElement\r\n        | Text\r\n        | SVGSVGElement\r\n        | DocumentFragment\r\n        | SVGElement\r\n        | Element\r\n        | Node\r\n      >\r\n    | SVGElement\r\n    | DocumentFragment\r\n    | HTMLElement\r\n    | Text\r\n    | SVGSVGElement\r\n    | Element,\r\n  container: HTMLElement | SVGSVGElement | SVGElement | Element | Node,\r\n  clear: boolean = true\r\n) {\r\n  if (clear) {\r\n    seteletext(container, \"\");\r\n  }\r\n  //   container.innerHTML = \"\";\r\n  /*  let eles: Array<any>;\r\n  if (Array.isArray(ele)) {\r\n    eles = ele;\r\n  } else {\r\n    // appendchild(container, ele);\r\n    eles = [ele];\r\n  } */\r\n  const eles = toArray(ele).flat(Infinity);\r\n  eles.forEach((e: Node | HTMLElement | Element | SVGElement) =>\r\n    appendchild(container, e)\r\n  );\r\n  return container;\r\n}\r\n","const String = window.String;\r\n\r\nconst Reflect = window.Reflect;\r\n\r\nconst {get: get, set: set} = Reflect;\r\n\r\nconst valuestring = \"value\";\r\n\r\nfunction isobject(a) {\r\n    return typeof a === \"object\" && a !== null;\r\n}\r\n\r\nfunction isstring(a) {\r\n    return typeof a === \"string\";\r\n}\r\n\r\nfunction isArray(a) {\r\n    return Array.isArray(a);\r\n}\r\n\r\nfunction isSet(a) {\r\n    return a instanceof Set;\r\n}\r\n\r\nfunction objtostylestring(o) {\r\n    return Object.entries(o).map(([key, value]) => key + \":\" + value).join(\";\");\r\n}\r\n\r\nfunction asserthtmlelement(ele) {\r\n    if (!(ele instanceof Element)) {\r\n        throw TypeError(\"invalid HTMLElement!\");\r\n    } else return true;\r\n}\r\n\r\nfunction createeleattragentreadwrite(ele) {\r\n    asserthtmlelement(ele);\r\n    const isinputtextortextareaflag = isinputtextortextarea(ele);\r\n    var temp = Object.create(null);\r\n    const outputattrs = new Proxy(temp, {\r\n        ownKeys() {\r\n            const keys = attributesownkeys(ele);\r\n            return isinputtextortextareaflag ? Array.from(new Set([ ...keys, valuestring ])) : keys;\r\n        },\r\n        get(target, key) {\r\n            if (isinputtextortextareaflag && key === valuestring) {\r\n                return get(ele, valuestring);\r\n            } else {\r\n                const v = getattribute(ele, String(key));\r\n                if (v === \"\") {\r\n                    return true;\r\n                }\r\n                if (v === null) {\r\n                    return;\r\n                }\r\n                if (isstring(v)) {\r\n                    try {\r\n                        return JSON.parse(String(v));\r\n                    } catch (error) {\r\n                        return v;\r\n                    }\r\n                } else return;\r\n            }\r\n        },\r\n        set(t, key, v) {\r\n            if (\"function\" === typeof v) {\r\n                console.error(v);\r\n                throw TypeError(\"Setting properties as functions is not allowed\");\r\n            }\r\n            if (geteletagname(ele) === \"input\" && key === \"checked\") {\r\n                set(ele, key, v);\r\n                return true;\r\n            }\r\n            if (isinputtextortextareaflag && key === valuestring) {\r\n                return set(ele, valuestring, v);\r\n            } else if (key === \"style\") {\r\n                setattribute(ele, String(key), isstring(v) ? v : isobject(v) ? objtostylestring(v) : String(v));\r\n                return true;\r\n            } else if (key === \"class\" && isobject(v)) {\r\n                if (isArray(v)) {\r\n                    setattribute(ele, String(key), v.join(\" \"));\r\n                } else if (isSet(v)) {\r\n                    setattribute(ele, String(key), [ ...v ].join(\" \"));\r\n                } else {\r\n                    setattribute(ele, String(key), JSON.stringify(v));\r\n                }\r\n            } else {\r\n                if (isSet(v)) {\r\n                    setattribute(ele, String(key), JSON.stringify([ ...v ]));\r\n                } else {\r\n                    if (v === true) {\r\n                        v = \"\";\r\n                    }\r\n                    setattribute(ele, String(key), isobject(v) ? JSON.stringify(v) : String(v));\r\n                    return true;\r\n                }\r\n            }\r\n            return true;\r\n        },\r\n        deleteProperty(t, k) {\r\n            removeAttribute(ele, String(k));\r\n            return true;\r\n        },\r\n        has(target, key) {\r\n            if (isinputtextortextareaflag && key === valuestring) {\r\n                return true;\r\n            } else {\r\n                return hasAttribute(ele, String(key));\r\n            }\r\n        },\r\n        defineProperty() {\r\n            return false;\r\n        },\r\n        getOwnPropertyDescriptor(target, key) {\r\n            const otherdescipter = {\r\n                enumerable: true,\r\n                configurable: true,\r\n                writable: true\r\n            };\r\n            const myvalue = get(outputattrs, key);\r\n            if (typeof myvalue !== \"undefined\") {\r\n                return {\r\n                    value: myvalue,\r\n                    ...otherdescipter\r\n                };\r\n            } else {\r\n                return;\r\n            }\r\n        },\r\n        setPrototypeOf() {\r\n            return false;\r\n        }\r\n    });\r\n    return outputattrs;\r\n}\r\n\r\nfunction attributesownkeys(ele) {\r\n    return ele.getAttributeNames();\r\n}\r\n\r\nfunction getattribute(ele, key) {\r\n    return ele.getAttribute(key);\r\n}\r\n\r\nfunction geteletagname(ele) {\r\n    return ele.tagName.toLowerCase();\r\n}\r\n\r\nfunction setattribute(ele, key, value) {\r\n    return ele.setAttribute(key, value);\r\n}\r\n\r\nfunction removeAttribute(ele, key) {\r\n    return ele.removeAttribute(key);\r\n}\r\n\r\nfunction hasAttribute(ele, key) {\r\n    return ele.hasAttribute(key);\r\n}\r\n\r\nfunction isinputtextortextarea(ele) {\r\n    const tagname = geteletagname(ele);\r\n    return tagname === \"input\" && get(ele, \"type\") === \"text\" || tagname === \"textarea\";\r\n}\r\n\r\nexport default createeleattragentreadwrite;\r\n//# sourceMappingURL=index.js.map\r\n","/* \r\n        \r\n        [[\"value\",[\"f\",\"f\"]],[\"value\",[\"f\",\"f\"]]]\r\n\r\n\r\n        [[\"value\",[\"f\",\"f\",\"f\",\"f\"]]]\r\n        \r\n        */\r\nexport function merge_entries(a: any[] /* Array<[any, Array<any>]> */): any[] {\r\n  const m: { [s: string]: Set<any> } = {};\r\n\r\n  a.forEach(([key, value]) => {\r\n    if (!m[key]) {\r\n      m[key] = new Set();\r\n    }\r\n    // m[key] && (m[key] = new Set());\r\n\r\n    value.forEach((v: any) => {\r\n      m[key].add(v);\r\n    });\r\n  });\r\n  return Object.entries(m).map(([k, v]) => [k, Array.from(v)]);\r\n}\r\n","export function isVirtualdom(a: any): a is Virtualdom {\r\n  return a instanceof Virtualdom;\r\n}\r\nimport ReactiveState, { isReactiveState } from \"./reactivestate\";\r\n// import { Class } from \"./rendervdomtoreal\";\r\nimport { merge_entries } from \"./merge-entries\";\r\nimport { Class } from \"./customclass\";\r\n\r\nexport default class Virtualdom {\r\n  /* get [Symbol.toStringTag]() {\r\n    return \"VirtualElement\";\r\n  } */\r\n  //   options: any |undefined\r\n  element: undefined | Element | Node;\r\n  type: string | Function | Class = \"\";\r\n  props: { [key: string]: string | object } = {};\r\n  children: Array<Virtualdom | string | ReactiveState | number> = [];\r\n  directives: object = {};\r\n  onevent: { [key: string]: Array<EventListener> } = {};\r\n  bindattr: { [key: string]: ReactiveState } = {};\r\n  constructor(\r\n    type: Function | string = \"\",\r\n    props: object = {},\r\n    children: Array<Virtualdom | string | ReactiveState | number> = []\r\n  ) {\r\n    const 字母大小写 = /[A-Za-z]/;\r\n    // console.log(type, props, children);\r\n    //添加支持on开头事件绑定写法\r\n    const propsentries = Object.entries(props);\r\n    /*\r\n.map(([key, value]) => [\r\nkey.startsWith(\"on\")?key.replace(\"on\",\"@\")：key\r\n,\r\nvalue\r\n\r\n]);\r\n*/\r\n    const propsentriesNOTevents = propsentries.filter(\r\n      ([key]) => !(key.startsWith(\"@\") || key.startsWith(\"on\"))\r\n    );\r\n    const 字母开头的entries = propsentriesNOTevents.filter(([key]) =>\r\n      字母大小写.test(key[0])\r\n    );\r\n\r\n    Object.assign(this, {\r\n      type,\r\n      bindattr: Object.fromEntries(\r\n        /*   propsentriesNOTevents\r\n          .filter(([key]) => 字母大小写.test(key[0])) */\r\n        字母开头的entries.filter(\r\n          e => isReactiveState(e[1])\r\n          // e[1] instanceof ReactiveState\r\n        )\r\n      ),\r\n      props: Object.fromEntries(\r\n        /*   propsentriesNOTevents\r\n          .filter(([key]) => 字母大小写.test(key[0])) */\r\n        字母开头的entries.filter(\r\n          e => !isReactiveState(e[1])\r\n          //    e[1] instanceof ReactiveState\r\n        )\r\n      ),\r\n      children: children.flat(),\r\n      onevent: Object.fromEntries(\r\n        /* 需要合并entries\r\n        [\r\n        ['value',[f,f]]\r\n        ,\r\n        ['value',[f,f]]\r\n      ]\r\n        合并成\r\n\r\n         [\r\n        ['value',[f,f,f,f]]\r\n         ]\r\n        */\r\n\r\n        /* \r\n        \r\n        [[\"value\",[\"f\",\"f\"]],[\"value\",[\"f\",\"f\"]]]\r\n\r\n\r\n        [[\"value\",[\"f\",\"f\",\"f\",\"f\"]]]\r\n        \r\n        */\r\n        merge_entries([\r\n          ...propsentries\r\n            .filter(([key]) => /\\@/.test(key[0]))\r\n            .map(([key, value]) => [\r\n              //事件名称变成小写\r\n              key\r\n                .slice(1)\r\n                .toLowerCase()\r\n                .trim(),\r\n              //把事件绑定变成事件数组\r\n              [value].flat()\r\n            ]),\r\n          ...propsentries\r\n            .filter(([key]) => key.startsWith(\"on\"))\r\n            .map(([key, value]) => [\r\n              //事件名称变成小写\r\n              key\r\n                .slice(2)\r\n                .toLowerCase()\r\n                .trim(),\r\n              //把事件绑定变成事件数组\r\n              [value].flat()\r\n            ])\r\n        ])\r\n      ),\r\n\r\n      //指令支持以\"*\"开头和\"_\"开头\r\n      directives: Object.fromEntries(\r\n        propsentriesNOTevents\r\n          .filter(([key]) => /\\*/.test(key[0]) || key[0].startsWith(\"_\"))\r\n          .map(([key, value]) => [\r\n            //指令也变成小写\r\n            key\r\n              .slice(1)\r\n              .toLowerCase()\r\n              .trim(),\r\n\r\n            value\r\n          ])\r\n      )\r\n    });\r\n    /* \r\n Object.defineProperty(this, Symbol.toStringTag, {\r\n      value: \"virtualdom\",\r\n      configurable: true\r\n    });\r\n*/\r\n  }\r\n}\r\nReflect.defineProperty(Virtualdom.prototype, Symbol.toStringTag, {\r\n  value: \"VirtualElement\"\r\n});\r\n","export const bindstatesymbol = Symbol(\"bindstate\");\r\n\r\nexport const reactivestatesymbol = Symbol(\"reactive\");\r\nimport { watch } from \"./watch\";\r\nimport ReactiveState /* textnodesymbol */ from \"./reactivestate\";\r\nexport const virtualdomsymbol = Symbol(\"virtualdom\");\r\nimport directives from \"./directives\";\r\nimport onevent /*  eventlistenerssymbol  */ from \"./onevent\";\r\nimport { createcostumelemet } from \"./customelement\";\r\nimport {\r\n  mathnamespace,\r\n  createmathelement,\r\n  svgnamespace,\r\n  createsvgelement,\r\n  //   createnonescript,\r\n  createnativeelement,\r\n  createElementNS,\r\n  createtextnode,\r\n  changetext,\r\n  createDocumentFragment\r\n} from \"./dom\";\r\nfunction throwinvalideletype(type) {\r\n  console.error(type);\r\n  throw TypeError(\"invalid element type!\");\r\n}\r\nimport mount from \"./mount\";\r\nimport createeleattr from \"dom-element-attribute-agent-proxy\";\r\nimport { isobject, isArray, isfunction, isstring, isnumber } from \"./util\";\r\nimport Virtualdom from \"./virtualdom\";\r\nexport default function render(\r\n  vdom: Array<Virtualdom | string | ReactiveState | number>,\r\n  namespace?: string\r\n): Array<Node>;\r\nexport default function render(\r\n  vdom: Virtualdom | string | ReactiveState | number,\r\n  namespace?: string\r\n): Node | any;\r\nexport default function render(\r\n  vdom:\r\n    | Virtualdom\r\n    | string\r\n    | number\r\n    | ReactiveState\r\n    | Array<Virtualdom | string | ReactiveState | number>,\r\n  namespace?: string\r\n) {\r\n  if (isnumber(vdom)) {\r\n    return createtextnode(vdom);\r\n  } else if (typeof vdom === \"string\") {\r\n    return createtextnode(vdom);\r\n  } else if (vdom instanceof ReactiveState) {\r\n    const reactive = vdom;\r\n    const textnode = createtextnode(String(reactive));\r\n    textnode[reactivestatesymbol] = reactive;\r\n    /*  try {\r\n      reactive[textnodesymbol] = textnode;\r\n    } catch (error) {\r\n      console.warn(error);\r\n    } */\r\n\r\n    watch(reactive, (state: { value: string }) => {\r\n      if (isconnected(element)) {\r\n        changetext(textnode, String(state));\r\n      }\r\n    });\r\n    const element = textnode;\r\n    element[bindstatesymbol] = new Set();\r\n    element[bindstatesymbol].add(reactive);\r\n    return textnode;\r\n  } else if (vdom instanceof Virtualdom && \"type\" in vdom) {\r\n    const { type } = vdom;\r\n    let element: Element | HTMLElement | SVGSVGElement | SVGElement;\r\n    if (typeof type === \"string\") {\r\n      if (type === \"script\") {\r\n        /* 禁止加载脚本 */\r\n\r\n        return createDocumentFragment();\r\n      } else if (type === \"svg\") {\r\n        /* 没想到svg的创建方式这么特别?否则显示不出svg */\r\n        element = createsvgelement();\r\n      } else if (type === \"math\") {\r\n        /* 没想到svg的创建方式这么特别?否则显示不出svg */\r\n        element = createmathelement();\r\n      } else if (\"\" === type || type === \"html\") {\r\n        //不要创建html元素\r\n        return render(vdom.children);\r\n        // element = createDocumentFragment();\r\n      } else {\r\n        element = namespace\r\n          ? createElementNS(namespace, type)\r\n          : createnativeelement(type);\r\n      }\r\n    } else if (typeof type == \"function\") {\r\n      //添加默认props\r\n\r\n      /*static defaultProps = {\r\n        name: 'Omi',\r\n        myAge: 18\r\n  }*/\r\n      if (isobject(type[\"defaultProps\"])) {\r\n        vdom.props = JSON.parse(\r\n          JSON.stringify({ ...type[\"defaultProps\"], ...vdom.props })\r\n        );\r\n      }\r\n\r\n      const propsjson = JSON.parse(\r\n        JSON.stringify({\r\n          ...vdom.props,\r\n          ...Object.fromEntries(\r\n            Object.entries(vdom.bindattr).map(([key, value]) => {\r\n              return [key, value.value];\r\n            })\r\n          )\r\n        })\r\n      );\r\n      element = createcostumelemet(\r\n        type,\r\n        propsjson,\r\n        vdom.children\r\n        // vdom.options\r\n      );\r\n    } else {\r\n      throwinvalideletype(vdom);\r\n      // throw TypeError(\"invalid element type!\");\r\n    }\r\n    handleprops(element, vdom);\r\n\r\n    /* 自定义组件不添加children,而是从构造函数传入 */\r\n    /* web components也可以设置 childnodes,比如说slot */\r\n    /* https://webkit.org/blog/4096/introducing-shadow-dom-api/ */\r\n    /*  */\r\n    /* https://developer.mozilla.org/zh-CN/docs/Web/API/Element/slot */\r\n    if (\r\n      type &&\r\n      (isfunction(type) || isstring(type))\r\n      // /\r\n      //   /\r\n\r\n      /* typeof type !== \"function\" */\r\n    ) {\r\n      /* 如果自己创造的组件就不加children, */\r\n      if (!type[componentsymbol]) {\r\n        mount(\r\n          vdom.children.map(e => {\r\n            if (type === \"svg\") {\r\n              /* 没想到svg的创建方式这么特别?否则显示不出svg */\r\n              //   element.innerHTML = element.innerHTML;\r\n              return render(e, svgnamespace);\r\n            } else if (type === \"math\") {\r\n              return render(e, mathnamespace);\r\n            } else if (namespace) {\r\n              return render(e, namespace);\r\n            } else {\r\n              return render(e);\r\n            }\r\n          }),\r\n\r\n          element\r\n        );\r\n      }\r\n    }\r\n    return element;\r\n  } else if (isArray(vdom)) {\r\n    return vdom.map(a => render(a)).flat();\r\n  } else {\r\n    throwinvalideletype(vdom);\r\n    // throw TypeError(\"invalid element type!\");\r\n  }\r\n}\r\n\r\nimport { isReactiveState } from \"./reactivestate\";\r\nimport { isconnected } from \"./isconnected\";\r\nimport { componentsymbol } from \"./iscomponent\";\r\nfunction handleprops(\r\n  element: HTMLElement | Element | SVGSVGElement | SVGElement,\r\n  vdom: Virtualdom\r\n) {\r\n  ((element, vdom) => {\r\n    Object.entries(vdom.directives).forEach(([name, value]) => {\r\n      if (name in directives && typeof directives[name] === \"function\") {\r\n        directives[name](element, value, vdom);\r\n      } else {\r\n        throw new Error(\"invalid directives \" + name);\r\n      }\r\n    });\r\n\r\n    const attribute1 = createeleattr(element);\r\n    Object.assign(\r\n      attribute1,\r\n\r\n      /* 把属性为false的先不设置 */\r\n      vdom.props\r\n      // Object.fromEntries(Object.entries(vdom.props).filter())\r\n    );\r\n    /* 添加常量的属性 */\r\n    element[virtualdomsymbol] = vdom;\r\n    vdom.element = element;\r\n    /* 添加绑定属性 */\r\n\r\n    Object.entries(vdom.bindattr).forEach(([key, primitivestate]) => {\r\n      attribute1[key] = primitivestate.value;\r\n      watch(primitivestate, (state: { value: any }) => {\r\n        if (isconnected(element)) {\r\n          attribute1[key] = state.value;\r\n        }\r\n      });\r\n      /*     primitivestate[subscribesymbol]();\r\n      requestAnimationFrame(() => {\r\n        primitivestate[addallistenerssymbol]();\r\n      }); */\r\n    });\r\n\r\n    /* 添加事件绑定和指令执行 */\r\n\r\n    /*  if (!element[eventlistenerssymbol]) {\r\n      element[eventlistenerssymbol] = [];\r\n    }\r\n*/\r\n    Object.entries(vdom.onevent).forEach(([event, callbacks]) => {\r\n      onevent(element, event, callbacks);\r\n    });\r\n  })(element, vdom);\r\n  /*  if (!element[bindstatesymbol]) {\r\n    element[bindstatesymbol] = new Set();\r\n  }\r\n*/\r\n  [...Object.values(vdom.bindattr), ...Object.values(vdom.directives)]\r\n    .flat()\r\n    .filter(\r\n      e => isReactiveState(e)\r\n      // e instanceof ReactiveState\r\n    )\r\n\r\n    .forEach(e => {\r\n      if (!element[bindstatesymbol]) {\r\n        element[bindstatesymbol] = new Set();\r\n      }\r\n      element[bindstatesymbol].add(e);\r\n    });\r\n}\r\n","import { getAttribute, setAttribute, removeAttribute } from \"./dom\";\r\nconst attributeChangedCallback = \"attributeChangedCallback\";\r\nimport { isFunction } from \"./util\";\r\nexport class AttrChange extends HTMLElement {\r\n  /* disconnectedCallback() {\r\n  console.log('Custom square element removed from page.');\r\n} */\r\n  /* connectedCallback() {\r\n  console.log('Custom square element added to page.');\r\n  updateStyle(this);\r\n} */\r\n  //\r\n  //   connectedCallback(){}\r\n  /* attributeChangedCallback(name, oldValue, newValue) {\r\n  console.log('Custom square element attributes changed.');\r\n  updateStyle(this);\r\n} */\r\n  setAttribute(qualifiedName: string, value: string) {\r\n    const oldValue = getAttribute(this, qualifiedName);\r\n    // super.getAttribute(qualifiedName);\r\n\r\n    if (oldValue !== value) {\r\n      setAttribute(this, qualifiedName, value);\r\n      //   super.setAttribute(qualifiedName, value);\r\n      if (isFunction(this[attributeChangedCallback])) {\r\n        this[attributeChangedCallback](qualifiedName, oldValue, value);\r\n      }\r\n    }\r\n  }\r\n  removeAttribute(qualifiedName: string) {\r\n    const oldValue = getAttribute(this, qualifiedName);\r\n\r\n    if (null !== oldValue) {\r\n      //   super.removeAttribute(qualifiedName);\r\n      removeAttribute(this, qualifiedName);\r\n      if (isFunction(this[attributeChangedCallback])) {\r\n        this[attributeChangedCallback](qualifiedName, oldValue, undefined);\r\n      }\r\n    }\r\n  }\r\n}\r\n","export function setimmediate(fun: Function) {\r\n  return Promise.resolve().then(() => fun());\r\n}\r\n","export default function<T extends object>(target: T): T {\r\n  return new Proxy(target, {\r\n    set() {\r\n      return false;\r\n    },\r\n    defineProperty() {\r\n      return false;\r\n    },\r\n    deleteProperty() {\r\n      return false;\r\n    },\r\n    setPrototypeOf() {\r\n      return false;\r\n    }\r\n  });\r\n}\r\n","function isArray(a) {\r\n    return Array.isArray(a);\r\n}\r\nconst Reflect = window.Reflect;\r\nconst { ownKeys, deleteProperty, apply, construct, defineProperty, get, getOwnPropertyDescriptor, getPrototypeOf, has, set, setPrototypeOf } = Reflect;\r\nfunction isobject(a) {\r\n    return typeof a === \"object\" && a !== null;\r\n}\r\nfunction isfunction(a) {\r\n    return typeof a === \"function\";\r\n}\r\nfunction deepobserveaddpath(target, callback, patharray = [], ancestor = target) {\r\n    if (typeof callback !== \"function\") {\r\n        throw Error(\"observe callback invalid !\");\r\n    }\r\n    if (isfunction(target) || isobject(target)) {\r\n        let fakeobj;\r\n        if (isArray(target)) {\r\n            fakeobj = [];\r\n        }\r\n        else if (isfunction(target)) {\r\n            fakeobj = () => { };\r\n        }\r\n        else {\r\n            fakeobj = {};\r\n        }\r\n        setPrototypeOf(fakeobj, null);\r\n        return (fakeobj => {\r\n            return new Proxy(fakeobj, {\r\n                defineProperty(t, p, a) {\r\n                    return defineProperty(target, p, a);\r\n                },\r\n                deleteProperty(t, p) {\r\n                    callback(ancestor, [...patharray, p], undefined, get(target, p));\r\n                    return deleteProperty(target, p);\r\n                },\r\n                ownKeys() {\r\n                    return ownKeys(target);\r\n                },\r\n                has(t, p) {\r\n                    return has(target, p);\r\n                },\r\n                getPrototypeOf() {\r\n                    return getPrototypeOf(target);\r\n                },\r\n                setPrototypeOf(t, v) {\r\n                    return setPrototypeOf(target, v);\r\n                },\r\n                construct(t, argumentslist) {\r\n                    if (typeof target === \"function\") {\r\n                        return construct(target, argumentslist);\r\n                    }\r\n                },\r\n                apply(t, thisarg, argarray) {\r\n                    if (typeof target === \"function\") {\r\n                        return apply(target, thisarg, argarray);\r\n                    }\r\n                },\r\n                getOwnPropertyDescriptor(t, k) {\r\n                    var descripter = getOwnPropertyDescriptor(target, k);\r\n                    if (isArray(target) && k === \"length\") {\r\n                        return descripter;\r\n                    }\r\n                    else {\r\n                        if (descripter) {\r\n                            descripter.configurable = true;\r\n                            return descripter;\r\n                        }\r\n                        else {\r\n                            return;\r\n                        }\r\n                    }\r\n                },\r\n                set(t, k, v) {\r\n                    if (typeof callback === \"function\") {\r\n                        callback(ancestor, [...patharray, k], v, get(target, k));\r\n                    }\r\n                    return set(target, k, v);\r\n                },\r\n                get(t, k) {\r\n                    var value = get(target, k);\r\n                    if (isfunction(value) || isobject(value)) {\r\n                        return deepobserveaddpath(value, callback, [...patharray, k], target);\r\n                    }\r\n                    else {\r\n                        return value;\r\n                    }\r\n                }\r\n            });\r\n        })(fakeobj);\r\n    }\r\n    else {\r\n        return target;\r\n    }\r\n}\r\nfunction observedeepagent(target, callback) {\r\n    if (typeof callback !== \"function\") {\r\n        throw Error(\"observe callback  invalid function \");\r\n    }\r\n    if (typeof Proxy !== \"function\") {\r\n        throw Error(\"Proxy unsupported!\");\r\n    }\r\n    if (isfunction(target) || isobject(target)) {\r\n        return deepobserveaddpath(target, callback, [], target);\r\n    }\r\n    else {\r\n        return target;\r\n    }\r\n}\r\n\r\nexport default observedeepagent;\r\n//# sourceMappingURL=index.js.map\r\n","import { getproperyreadproxy } from \"./computed\";\r\n\r\nimport { invalid_primitive_or_object_state } from './reactivestate';\r\n\r\nimport {\r\n  deleteProperty,\r\n  get,\r\n  getOwnPropertyDescriptor,\r\n  has,\r\n  ownKeys,\r\n  set\r\n} from \"./reflect\";\r\nimport deepobserve from \"deep-observe-agent-proxy\";\r\nimport { isobject, isSet, gettagtype } from \"./util\";\r\nimport isprimitive from \"./isprimitive\";\r\nimport ReactiveState, {\r\n  dispatchsymbol,\r\n  // textnodesymbol,\r\n  isReactiveState\r\n} from './reactivestate';\r\nimport { usestste } from \"./context-mounted-unmounted-\";\r\nexport default (init: any) => {\r\n  /* 收集组件内部创建的 ReactiveState*/\r\n  const state = createstate(init);\r\n  usestste(state);\r\n  return state;\r\n};\r\n\r\nfunction createstate(\r\n  init: string | number | boolean | undefined | ReactiveState | object\r\n): ReactiveState {\r\n  if (isprimitive(init)) {\r\n    return getproperyreadproxy(\r\n      new Proxy(new ReactiveState(init), {\r\n        defineProperty() {\r\n          return false;\r\n        },\r\n        deleteProperty() {\r\n          return false;\r\n        },\r\n        set(target, key, value) {\r\n          /*  if (key === textnodesymbol) {\r\n          return set(target, key, value);\r\n        } */\r\n          if (key === \"value\" && isprimitive(value)) {\r\n            // if (target[key] !== value) {\r\n            set(target, key, value);\r\n            target[dispatchsymbol]();\r\n            // }\r\n            return true;\r\n          } else {\r\n            return false;\r\n          }\r\n        },\r\n        setPrototypeOf() {\r\n          return false;\r\n        }\r\n      })\r\n    );\r\n  } else if (\r\n    isReactiveState(init)\r\n    // init instanceof ReactiveState\r\n  ) {\r\n    // 如果init是个 ReactiveState，则对其解包，并生成新的 ReactiveState\r\n    return createstate(init.value);\r\n  } else if (isobject(init)) {\r\n    return new Proxy(new ReactiveState(init), {\r\n      defineProperty() {\r\n        return false;\r\n      },\r\n      getOwnPropertyDescriptor(target, key) {\r\n        const myvalue = get(target, \"value\");\r\n\r\n        const descripter =\r\n          getOwnPropertyDescriptor(target, key) ||\r\n          getOwnPropertyDescriptor(myvalue, key);\r\n        if (descripter) {\r\n          descripter.configurable = true;\r\n        }\r\n\r\n        return descripter;\r\n      },\r\n      deleteProperty(target, key) {\r\n        const myvalue = get(target, \"value\");\r\n        if (has(myvalue, key)) {\r\n          deleteProperty(myvalue, key);\r\n          target[dispatchsymbol](String(key));\r\n          return true;\r\n        } else {\r\n          return true;\r\n        }\r\n      },\r\n      has(target, key) {\r\n        const myvalue = get(target, \"value\");\r\n        return has(target, key) || has(myvalue, key);\r\n      },\r\n      get(target, key) {\r\n        const value = get(target, \"value\");\r\n\r\n        if (\r\n          key === \"value\" &&\r\n          (gettagtype(value) === \"array\" || gettagtype(value) === \"object\")\r\n        ) {\r\n          return deepobserve(get(target, key), (_target, patharray) => {\r\n            target[dispatchsymbol](patharray[0]);\r\n          });\r\n        } else if (has(target, key)) {\r\n          return get(target, key);\r\n        } else if (has(value, key)) {\r\n          if (isSet(value) && (key === \"add\" || key === \"delete\")) {\r\n            const myvalue = value;\r\n            if (key === \"add\") {\r\n              return (add: any) => {\r\n                if (!Set.prototype.has.call(myvalue, add)) {\r\n                  const returnvalue = Set.prototype[key].call(myvalue, add);\r\n                  target[dispatchsymbol]();\r\n                  return returnvalue;\r\n                }\r\n              };\r\n            } else if (key === \"delete\") {\r\n              return (dele: any) => {\r\n                if (Set.prototype.has.call(myvalue, dele)) {\r\n                  const returnvalue = Set.prototype[key].call(myvalue, dele);\r\n                  target[dispatchsymbol]();\r\n                  return returnvalue;\r\n                }\r\n              };\r\n            }\r\n          } else {\r\n            return deepobserve(get(value, key), () => {\r\n              target[dispatchsymbol](String(key));\r\n            });\r\n          }\r\n\r\n          /*  */\r\n        }\r\n      },\r\n      ownKeys(target) {\r\n        return Array.from(\r\n          new Set([...ownKeys(target), ...ownKeys(get(target, \"value\"))])\r\n        );\r\n      },\r\n      set(target, key, value) {\r\n        /*   if (key === textnodesymbol) {\r\n          return set(target, key, value);\r\n        } */\r\n        const myvalue = get(target, \"value\");\r\n        if (key === \"value\" && isobject(value)) {\r\n          // if (target[key] !== value) {\r\n          set(target, key, value);\r\n          target[dispatchsymbol]();\r\n\r\n          // }\r\n          return true;\r\n        } else if (!has(target, key)) {\r\n          set(myvalue, key, value);\r\n          target[dispatchsymbol](String(key));\r\n\r\n          //\r\n        } else if (key === \"length\") {\r\n          set(myvalue, key, value);\r\n          target[dispatchsymbol](key);\r\n        } else {\r\n          return false;\r\n        }\r\n        return true;\r\n      },\r\n      setPrototypeOf() {\r\n        return false;\r\n      }\r\n    });\r\n  } else {\r\n    console.error(init);\r\n    throw TypeError(invalid_primitive_or_object_state);\r\n\r\n    //throw TypeError(\"invalid State\");\r\n  }\r\n}\r\n","var n=function(t,r,u,e){for(var p=1;p<r.length;p++){var s=r[p],h=\"number\"==typeof s?u[s]:s,a=r[++p];1===a?e[0]=h:3===a?e[1]=Object.assign(e[1]||{},h):5===a?(e[1]=e[1]||{})[r[++p]]=h:6===a?e[1][r[++p]]+=h+\"\":e.push(a?t.apply(null,n(t,h,u,[\"\",null])):h)}return e},t=function(n){for(var t,r,u=1,e=\"\",p=\"\",s=[0],h=function(n){1===u&&(n||(e=e.replace(/^\\s*\\n\\s*|\\s*\\n\\s*$/g,\"\")))?s.push(n||e,0):3===u&&(n||e)?(s.push(n||e,1),u=2):2===u&&\"...\"===e&&n?s.push(n,3):2===u&&e&&!n?s.push(!0,5,e):u>=5&&((e||!n&&5===u)&&(s.push(e,u,r),u=6),n&&(s.push(n,u,r),u=6)),e=\"\"},a=0;a<n.length;a++){a&&(1===u&&h(),h(a));for(var f=0;f<n[a].length;f++)t=n[a][f],1===u?\"<\"===t?(h(),s=[s],u=3):e+=t:4===u?\"--\"===e&&\">\"===t?(u=1,e=\"\"):e=t+e[0]:p?t===p?p=\"\":e+=t:'\"'===t||\"'\"===t?p=t:\">\"===t?(h(),u=1):u&&(\"=\"===t?(u=5,r=e,e=\"\"):\"/\"===t&&(u<5||\">\"===n[a][f+1])?(h(),3===u&&(s=s[0]),u=s,(s=s[0]).push(u,2),u=0):\" \"===t||\"\\t\"===t||\"\\n\"===t||\"\\r\"===t?(h(),u=2):e+=t),3===u&&\"!--\"===e&&(u=4,s=s[0])}return h(),s},r=\"function\"==typeof Map,u=r?new Map:{},e=r?function(n){var r=u.get(n);return r||u.set(n,r=t(n)),r}:function(n){for(var r=\"\",e=0;e<n.length;e++)r+=n[e].length+\"-\"+n[e];return u[r]||(u[r]=t(n))};export default function(t){var r=n(this,e(t),arguments,[]);return r.length>1?r:r[0]}\n","import ReactiveState from './reactivestate';\r\nimport { isstring, isobject, isfunction } from \"./util\";\r\nimport Virtualdom from \"./virtualdom\";\r\nexport default function createElement(\r\n  type: Function | string,\r\n  props?: any,\r\n  ...children: any[]\r\n): Virtualdom;\r\nexport default function createElement(\r\n  type: Function | string = \"\",\r\n  props: any = {},\r\n  ...children: Array<Virtualdom | string |number| ReactiveState>\r\n): Virtualdom | Array<Virtualdom | string | number|ReactiveState> {\r\n  // | Array<Virtualdom | string>\r\n  // if(isarray()){}\r\n  /* add fragment element */\r\n  //   console.log(type, props, children);\r\n  let typenormalized = isstring(type) || isfunction(type) ? type : \"\";\r\n  const propsnormalized = isobject(props) ? props : {};\r\n  const childrennormalized = children.flat(Infinity).map(a=>a===0?\"0\":a).filter(a=>!!a);\r\n  if (\r\n    isstring(typenormalized)\r\n    //   typeof typenormalized === \"string\"\r\n  ) {\r\n    typenormalized = typenormalized.trim().toLowerCase();\r\n  }\r\n\r\n  if (\r\n    //typeof typenormalized === \"string\" &&\r\n\r\n    \"\" === typenormalized\r\n  ) {\r\n    return childrennormalized;\r\n  }\r\n  /* propsnormalized = Object.fromEntries(\r\n    Object.entries(propsnormalized).map(([key, value]) => [\r\n      key.trim().toLowerCase(),\r\n      value\r\n    ])\r\n  ); */\r\n  return new Virtualdom(typenormalized, propsnormalized, childrennormalized);\r\n}\r\n","export const invalid_Virtualdom = \"invalid Virtualdom \";\r\nimport ReactiveState from './reactivestate';\r\nimport document from \"./dom\";\r\nimport { isvalidvdom } from \"./html\";\r\nimport Virtualdom from \"./virtualdom\";\r\nimport render from \"./rendervdomtoreal\";\r\nimport mount from \"./mount\";\r\nimport { isArray } from \"./util\";\r\nimport { toArray } from \"./toArray\";\r\nexport default function createApp(\r\n  vdom:\r\n    | Node\r\n    | Virtualdom\r\n    | string\r\n    | number\r\n    | Array<Virtualdom | string | ReactiveState | Node | number>\r\n    | ReactiveState,\r\n  container: HTMLElement | Element\r\n): HTMLElement | Element {\r\n  if (isArray(vdom)) {\r\n    vdom = vdom.flat(Infinity);\r\n  }\r\n  const el = container;\r\n  if (!(el instanceof HTMLElement)) {\r\n    console.error(el);\r\n    throw TypeError(\"invalid container HTMLElement!\");\r\n  }\r\n\r\n  if (\r\n    el === document.body ||\r\n    el === document.documentElement ||\r\n    el === document.head\r\n  ) {\r\n    throw Error(\"Do not mount  to <html> or <body> <head>.\");\r\n  }\r\n  /*   if (\r\n    !(\r\n      isvalidvdom(vdom) ||\r\n      vdom instanceof Node ||\r\n      (isArray(vdom) && isNodeArray(vdom))\r\n    )\r\n  ) {\r\n    console.error(vdom);\r\n    throw TypeError(invalid_Virtualdom);\r\n  } */\r\n\r\n  /*   let elesarray: Array<any>;\r\n  if (Array.isArray(vdom)) {\r\n    elesarray = vdom;\r\n  } else {\r\n    elesarray = [vdom];\r\n  } */\r\n  const elesarray = toArray(vdom);\r\n  if (isvalidvdom(vdom)) {\r\n    // mount(elesarray.map(e => render(e)), container);\r\n    mount(render(elesarray), container);\r\n  } else if (vdom instanceof Node || isNodeArray(vdom)) {\r\n    mount(elesarray, container);\r\n  } else {\r\n    console.error(vdom);\r\n    throw TypeError(invalid_Virtualdom);\r\n  }\r\n\r\n  //\r\n  return container;\r\n}\r\nfunction isNodeArray(array: any[]): array is Node[] {\r\n  return isArray(array) && !array.map(e => e instanceof Node).includes(false);\r\n}\r\n","import Virtualdom from \"./virtualdom\";\r\nimport ReactiveState from './reactivestate';\r\nimport { isReactiveState } from './reactivestate';\r\nimport { isstring, isArray, isnumber } from \"./util\";\r\nimport { isVirtualdom } from \"./virtualdom\";\r\nimport htm from \"htm/dist/htm.module.js\";\r\nimport h from \"./createelement\";\r\nimport { invalid_Virtualdom } from \"./createApp\";\r\n\r\n// const html = htm.bind(h);\r\nfunction html(...inargs) {\r\n  return htm.call(h, ...inargs);\r\n}\r\n\r\n/* 如果出现未闭合标签会产生错误的vdom */\r\nexport function isvalidvdom(\r\n  v: any\r\n): v is\r\n  | string\r\n  | Virtualdom\r\n  | ReactiveState\r\n  | number\r\n  | (string | Virtualdom | ReactiveState | number)[] {\r\n  if (isnumber(v)) {\r\n    return true;\r\n  }\r\n  let flag = false;\r\n  if (isArray(v)) {\r\n    flag = v\r\n      .map((ele: any) => {\r\n        return isvalidvdom(ele);\r\n        //isstring(ele) || ele instanceof Virtualdom;\r\n      })\r\n      .includes(false)\r\n      ? false\r\n      : true;\r\n    return flag;\r\n  } else if (\r\n    isVirtualdom(v)\r\n    // v instanceof Virtualdom\r\n  ) {\r\n    if (isvalidvdom(v.children)) {\r\n      return true;\r\n    }\r\n  } else if (\r\n    isReactiveState(v)\r\n    //  v instanceof ReactiveState\r\n  ) {\r\n    return true;\r\n  } else {\r\n    if (isstring(v)) {\r\n      return true;\r\n    }\r\n  }\r\n  return flag;\r\n}\r\nfunction assertvalidvirtualdom(...args: any[]) {\r\n  const vdom = html(...args);\r\n  if (isvalidvdom(vdom)) {\r\n    return vdom;\r\n  } else {\r\n    console.error(vdom);\r\n    throw new TypeError(invalid_Virtualdom);\r\n  }\r\n}\r\nexport default assertvalidvirtualdom;\r\n","export { createcssBlob };\r\nfunction createcssBlob(source: string) {\r\n  return URL.createObjectURL(new Blob([source], { type: \"text/css\" }));\r\n}\r\n","import render from \"./rendervdomtoreal\";\r\nimport createElement from \"./createelement\";\r\nimport { gettagtype } from \"./util\";\r\nimport { createcssBlob } from \"./cssurlblob\";\r\n// import { RegExp } from \"core-js\";\r\nimport {\r\n  appendchild,\r\n  createanotherhtmldocument /* , insertfirst */\r\n} from \"./dom\";\r\nexport function isCSSMediaRule(a: any): a is CSSMediaRule {\r\n  return gettagtype(a) === \"cssmediarule\";\r\n}\r\nexport function isCSSImportRule(a: any): a is CSSImportRule {\r\n  return gettagtype(a) === \"cssimportrule\";\r\n}\r\n\r\nexport function parsecsstext(text: string): Array<CSSRule> {\r\n  const styleelement = render(createElement(\"style\", undefined, text));\r\n  //   console.dir(styleelement);\r\n  /* 只有添加到document之后才会有sheet */\r\n  //const otherdocument = document.implementation.createHTMLDocument(\"\");\r\n  const otherdocument = createanotherhtmldocument();\r\n  appendchild(otherdocument.firstElementChild, styleelement);\r\n  //otherdocument.firstElementChild.appendChild(styleelement);\r\n  return Array.from(styleelement.sheet.cssRules);\r\n}\r\n\r\nexport function isCSSStyleRule(a: any): a is CSSStyleRule {\r\n  return gettagtype(a) === \"cssstylerule\";\r\n}\r\n\r\nexport function selectoraddprefix(cssstylerule: CSSStyleRule, prefix: string) {\r\n  //css 选择器可能有多个\r\n  //h1,p,h3,div\r\n  const selectorText = cssstylerule.selectorText;\r\n\r\n  const selectorarray = selectorText.split(\",\");\r\n  cssstylerule.selectorText = selectorarray\r\n    .map(selectorText => {\r\n      let prefixselector = prefix + \" \" + selectorText;\r\n\r\n      if (selectorText.startsWith(\"*\")) {\r\n        prefixselector =\r\n          prefixselector + \",\" + selectorText.replace(\"*\", prefix);\r\n      }\r\n      return prefixselector;\r\n    })\r\n    .join(\",\");\r\n  /*\r\n  const prefixselector = prefix + \" \" + selectorText;\r\n  if (selectorText.startsWith(\"*\")) {\r\n    cssstylerule.selectorText =\r\n      selectorText.replace(\"*\", prefix) + \",\" + prefixselector;\r\n    /* 对于'* '的处理,变成两个selectorrule*/\r\n\r\n  /* \r\n    *{font-size:80px !important;}\r\np{color:blue !important;} \r\n*/\r\n  /* \r\n    \r\n    q-9, q-9 * { font-size: 80px !important; }\r\nq-9 p { color: blue !important; }\r\n\r\n    */\r\n  /* } else {\r\n    cssstylerule.selectorText = prefixselector;\r\n  }\r\n*/\r\n  return cssstylerule;\r\n}\r\n\r\nexport function prefixcssrules(\r\n  cssRulesarray: Array<CSSRule>,\r\n  prefix: string\r\n): Array<CSSRule> {\r\n  return cssRulesarray\r\n    .map((cssrule: CSSRule) => {\r\n      if (isCSSStyleRule(cssrule)) {\r\n        return selectoraddprefix(cssrule, prefix);\r\n      } else if (isCSSMediaRule(cssrule)) {\r\n        prefixcssrules(Array.from(cssrule.cssRules), prefix);\r\n        return cssrule;\r\n      } else if (isCSSImportRule(cssrule)) {\r\n        //把url放入\r\n        savestyleblob(prefix, undefined, cssrule.href);\r\n        return;\r\n      } else {\r\n        return cssrule;\r\n      }\r\n    })\r\n    .filter(Boolean);\r\n}\r\n\r\nconst componentsstylesheet: { [key: string]: Set<string> } = {};\r\nexport { componentsstylesheet };\r\nexport function savestyleblob(\r\n  tagname: string,\r\n  csstext?: string,\r\n  urltext?: string\r\n) {\r\n  tagname = tagname.toLowerCase();\r\n  if (!componentsstylesheet[tagname]) {\r\n    componentsstylesheet[tagname] = new Set();\r\n  }\r\n  if (csstext) {\r\n    componentsstylesheet[tagname].add(createcssBlob(csstext));\r\n  } else if (urltext) {\r\n    componentsstylesheet[tagname].add(urltext);\r\n  }\r\n}\r\nexport function cssrulestocsstext(cssrules: Array<CSSRule>): string {\r\n  return cssrules.map(c => c.cssText).join(\"\\n\");\r\n  // .replace(/\\n/g, \"\");\r\n}\r\nexport function createlinkstylesheet(url: string): HTMLElement {\r\n  return render(createElement(\"link\", { href: url, rel: \"stylesheet\" }));\r\n}\r\nexport function transformcsstext(text: string, prefix: string): string {\r\n  const css = text;\r\n  const cssomold = parsecsstext(css);\r\n  const cssomnew = prefixcssrules(cssomold, prefix).filter(Boolean);\r\n  //   console.log([css, prefix, cssomold, cssomnew]);\r\n  const cssnewtext = cssrulestocsstext(cssomnew);\r\n  //   console.log([text, cssomold, cssomnew, cssnewtext]);\r\n  return cssnewtext;\r\n}\r\nexport function registercssprefix(text: string, prefix: string) {\r\n  const css = text;\r\n  const cssnewtext = transformcsstext(css, prefix);\r\n  //   cssnewtext.forEach(url => {\r\n  /* 把css文字转成url放入 */\r\n  savestyleblob(prefix, cssnewtext);\r\n  //   });\r\n}\r\nexport function loadlinkstyle(\r\n  stylelinkelement: HTMLElement,\r\n  container: HTMLElement | Element | SVGSVGElement | SVGElement\r\n) {\r\n  return new Promise(rs => {\r\n    const loaderrorfun = () => {\r\n      stylelinkelement.onload = stylelinkelement.onerror = undefined;\r\n      rs();\r\n      //   console.log(stylelinkelement.href);\r\n    };\r\n    stylelinkelement.onload = loaderrorfun;\r\n    stylelinkelement.onerror = loaderrorfun;\r\n    appendchild(container, stylelinkelement);\r\n  });\r\n}\r\n\r\nexport function waitloadallstyle(\r\n  prefix: string,\r\n  _this: Element | HTMLElement | SVGSVGElement | SVGElement\r\n) {\r\n  return Promise.all(\r\n    [...componentsstylesheet[prefix]].map(styleurl =>\r\n      loadlinkstyle(createlinkstylesheet(styleurl), _this)\r\n    )\r\n  );\r\n}\r\n","export const innerstatesymbol = Symbol(\"innerstate\");\r\nimport { setimmediate } from \"./setimmediate\";\r\nimport { readysymbol } from \"./readysymbol\";\r\nimport render from \"./rendervdomtoreal\";\r\nimport readonlyproxy from \"./readonlyproxy\";\r\nimport ReactiveState /* , { dispatchsymbol } */ from \"./reactivestate\";\r\nimport createstate from \"./createstate\";\r\nconst attributessymbol = Symbol(\"attributes\");\r\nconst elementsymbol = Symbol(\"innerelement\");\r\nconst vdomsymbol = Symbol(\"innervdom\");\r\nconst mountedsymbol = Symbol(\"mounted\");\r\nconst unmountedsymbol = Symbol(\"unmounted\");\r\n\r\nimport { AttrChange } from \"./attrchange\";\r\nimport {\r\n  openctx,\r\n  closectx,\r\n  getMounted,\r\n  getUnMounted,\r\n  invalid_Function,\r\n  getstates\r\n} from \"./context-mounted-unmounted-\";\r\n\r\n// import { Class } from \"./rendervdomtoreal\";\r\n\r\nimport Virtualdom from \"./virtualdom\";\r\nimport createeleattragentreadwrite from \"dom-element-attribute-agent-proxy\";\r\nimport { isobject, isArray, isfunction, isstring } from \"./util\";\r\nimport { onunmounted, onmounted } from \"./elementonmountandunmount\";\r\nimport { isvalidvdom } from \"./html\";\r\nimport { /* createApp, */ invalid_Virtualdom } from \"./createApp\";\r\nimport { toArray } from \"./toArray\";\r\nimport { Custom, Class } from \"./customclass\";\r\nimport {\r\n  waitloadallstyle,\r\n  /* parsecsstext,\r\n  prefixcssrules,\r\n  cssrulestocsstext, */\r\n  //   savestyleblob,\r\n  componentsstylesheet,\r\n  //   createlinkstylesheet,\r\n  //   transformcsstext,\r\n  registercssprefix\r\n  /*  loadlinkstyle,\r\n  createlinkstylesheet */\r\n  //   savestyleblob\r\n} from \"./parsecss\";\r\n// import { insertfirst } from \"./dom\";\r\nimport mount from \"./mount\";\r\nimport { seteletext } from \"./dom\";\r\n// import { Promise } from \"q\";\r\n// import { inflate } from \"zlib\";\r\nimport { componentsymbol } from \"./iscomponent\";\r\nimport { get } from \"./reflect\";\r\nexport function createComponent(custfun: Custom): Class {\r\n  if (isfunction(custfun)) {\r\n    const defaultProps = get(custfun, \"defaultProps\"); //custfun[\"defaultProps\"];\r\n    const css = get(custfun, \"css\");\r\n    return class Component extends AttrChange {\r\n      [innerstatesymbol]: Array<ReactiveState>;\r\n      static [componentsymbol] = true;\r\n      static css = isstring(css) && css ? css : undefined;\r\n      [readysymbol] = false;\r\n      [mountedsymbol]: Array<Function>;\r\n      [unmountedsymbol]: Array<Function>;\r\n      static defaultProps = isobject(defaultProps)\r\n        ? JSON.parse(JSON.stringify(defaultProps))\r\n        : undefined;\r\n      [attributessymbol]: { [s: string]: ReactiveState } | object = {};\r\n      [elementsymbol]: Array<Node>;\r\n      [vdomsymbol]: Array<Virtualdom | ReactiveState | string>;\r\n      constructor(\r\n        propsjson: object = {},\r\n        children: any[] = [] /* , options?: any */\r\n      ) {\r\n        super();\r\n\r\n        const css = get(this.constructor, \"css\");\r\n\r\n        if (css) {\r\n          const prefix = this.tagName.toLowerCase();\r\n          if (!componentsstylesheet[prefix]) {\r\n            registercssprefix(css, prefix);\r\n            /* 把css文本先解析成cssom ,然后添加前缀,然后转成字符串,生成blob,再生成link-stylesheet,添加*/\r\n            /* const cssomold = parsecsstext(css);\r\n            const cssomnew = prefixcssrules(cssomold, prefix);\r\n            //   console.log([css, prefix, cssomold, cssomnew]);\r\n            const cssnewtext = cssrulestocsstext(cssomnew); */\r\n            // const cssnewtext = transformcsstext(css, prefix);\r\n            // savestyleblob(prefix, cssnewtext);\r\n            // console.log(cssnewtext, componentsstylesheet);\r\n          }\r\n        }\r\n        const defaultProps = get(this.constructor, \"defaultProps\");\r\n        // this.constructor[\"defaultProps\"];\r\n        const attrs = createeleattragentreadwrite(this);\r\n        //   const props = {};\r\n        if (isobject(defaultProps)) {\r\n          Object.assign(attrs, defaultProps);\r\n          // Object.assign(props, this.constructor[\"defaultProps\"]);\r\n        }\r\n        if (isobject(propsjson)) {\r\n          Object.assign(attrs, propsjson);\r\n          // Object.assign(props, propsjson);\r\n        }\r\n        //   this[attributessymbol] = createeleattragentreadwrite(this);\r\n        // const props = createeleattragentreadwrite(this);/\r\n        openctx();\r\n        const props = attrs;\r\n        const thisattributess = Object.fromEntries(\r\n          Object.entries(props).map(([key, value]) => [key, createstate(value)])\r\n        );\r\n        this[attributessymbol] = readonlyproxy(thisattributess);\r\n\r\n        /* 把attributes的reactivestates也放进innerstates中 */\r\n        const readonlyprop = readonlyproxy(\r\n          Object.fromEntries(\r\n            Object.entries(thisattributess).map(([key, value]) => [\r\n              key,\r\n              readonlyproxy(value)\r\n            ])\r\n          )\r\n        );\r\n\r\n        let possiblyvirtualdom:\r\n          | string\r\n          | Virtualdom\r\n          | ReactiveState\r\n          | (string | Virtualdom | ReactiveState)[]\r\n          | any;\r\n        try {\r\n          possiblyvirtualdom = custfun.call(\r\n            undefined,\r\n            //让组件里面无法修改props的reactivestate的value\r\n            // readonlyproxy(thisattributess),\r\n            readonlyprop,\r\n            children\r\n          );\r\n        } catch (error) {\r\n          closectx();\r\n          throw error;\r\n        }\r\n\r\n        if (isArray(possiblyvirtualdom)) {\r\n          possiblyvirtualdom = possiblyvirtualdom\r\n            .flat(Infinity)\r\n            .filter(Boolean);\r\n        }\r\n        if (isvalidvdom(possiblyvirtualdom)) {\r\n          const thisvdomsymbol /* isArray(possiblyvirtualdom)\r\n            ? possiblyvirtualdom\r\n            : [possiblyvirtualdom]; */ = toArray(\r\n            possiblyvirtualdom\r\n          );\r\n          //\r\n          this[vdomsymbol] = thisvdomsymbol.flat(Infinity).filter(Boolean);\r\n          this[mountedsymbol] = getMounted();\r\n          this[unmountedsymbol] = getUnMounted();\r\n          this[innerstatesymbol] = getstates();\r\n          closectx();\r\n        } else {\r\n          closectx();\r\n          console.error(possiblyvirtualdom);\r\n          throw Error(invalid_Virtualdom);\r\n        }\r\n\r\n        //   this[mountedsymbol] = getMounted();\r\n        //   this[unmountedsymbol] = getUnMounted();\r\n      }\r\n\r\n      connectedCallback() {\r\n        if (!this[elementsymbol]) {\r\n          this[elementsymbol] = render(this[vdomsymbol]).flat(Infinity);\r\n        }\r\n        if (!this[readysymbol]) {\r\n          this[readysymbol] = true;\r\n          /* 这段代码只在初始化时执行一次 */\r\n          //   mount(this[elementsymbol], this, false);\r\n\r\n          const css = get(this.constructor, \"css\");\r\n          const prefix = this.tagName.toLowerCase();\r\n          if (css && componentsstylesheet[prefix]) {\r\n            /* 先清空当前组件 的children */\r\n\r\n            seteletext(this, \"\");\r\n            /* 应该要等待css加载完成之后再渲染出来,否则会有页面跳动 */\r\n            /* 是css里面的@import导致的 */\r\n            /* 挂载样式到组件最前面 */\r\n            //   console.log(componentsstylesheet[prefix]);\r\n            // if (componentsstylesheet[prefix]) {\r\n            /* const stylelinkelement = createlinkstylesheet(\r\n              componentsstylesheet[prefix]\r\n            ); */\r\n            /*   stylelinkelement.onload = () => {\r\n              mount(this[elementsymbol], this, false);\r\n            };\r\n            stylelinkelement.onerror = () => {\r\n              mount(this[elementsymbol], this, false);\r\n            }; */\r\n            // insertfirst(this, stylelinkelement);\r\n            // }\r\n            /*  Promise.all(\r\n              [...componentsstylesheet[prefix]].map(styleurl =>\r\n                loadlinkstyle(createlinkstylesheet(styleurl), this)\r\n              )\r\n            )\r\n*/\r\n            waitloadallstyle(prefix, this).then(() => {\r\n              //   console.log(\"style load all\");\r\n              //   console.log(\"mount1\");\r\n              mount(this[elementsymbol], this, false);\r\n            });\r\n          } else {\r\n            // console.log(\"mount2\");\r\n            mount(this[elementsymbol], this);\r\n          }\r\n        }\r\n        //把mounted callback 异步执行\r\n        this[mountedsymbol].forEach(f => {\r\n          setimmediate(f);\r\n        });\r\n        onmounted(this);\r\n      }\r\n      disconnectedCallback() {\r\n        this[unmountedsymbol].forEach(f => {\r\n          setimmediate(f);\r\n        });\r\n        onunmounted(this);\r\n      }\r\n      attributeChangedCallback(\r\n        name: string /* , oldValue: any, newValue: any */\r\n      ) {\r\n        // console.log(this[attributessymbol]);\r\n        if (this[attributessymbol][name]) {\r\n          /* 当属性改变时要跟ReactiveState同步状态 */\r\n          this[attributessymbol][name].value = createeleattragentreadwrite(\r\n            this\r\n          )[name];\r\n          //   this[attributessymbol][name][dispatchsymbol]();\r\n        }\r\n      }\r\n    };\r\n  } else {\r\n    console.error(custfun);\r\n    throw TypeError(invalid_Function);\r\n  }\r\n}\r\n","import ReactiveState from './reactivestate';\r\nimport {\r\n  eventlistenerssymbol,\r\n  removelisteners,\r\n  readdlisteners\r\n} from \"./onevent\";\r\nimport { bindstatesymbol } from \"./rendervdomtoreal\";\r\nimport { rewatch /* , unwatch */, unwatch } from \"./watch\";\r\nimport { isArray } from \"./util\";\r\nimport { getdomchildren } from \"./dom\";\r\nimport { innerstatesymbol } from \"./createComponent\";\r\n\r\nexport function onmounted(ele: Element | Node | Array<Node>) {\r\n  if (isArray(ele)) {\r\n    ele.forEach(e => {\r\n      onmounted(e);\r\n    });\r\n  } else if (ele instanceof Node) {\r\n    if (ele[eventlistenerssymbol]) {\r\n      readdlisteners(ele);\r\n    }\r\n    //全局共享状态\r\n    if (ele[bindstatesymbol]) {\r\n      ele[bindstatesymbol].forEach((state: ReactiveState) => {\r\n        rewatch(state);\r\n      });\r\n\r\n      if (ele[innerstatesymbol]) {\r\n        ele[innerstatesymbol].forEach((state: ReactiveState) => {\r\n          rewatch(state);\r\n        });\r\n      }\r\n      // readdlisteners(ele);\r\n    }\r\n    onmounted(getdomchildren(ele));\r\n  }\r\n\r\n  //\r\n}\r\nexport function onunmounted(ele: Element | Node | Array<Node>) {\r\n  if (isArray(ele)) {\r\n    ele.forEach(e => {\r\n      onunmounted(e);\r\n    });\r\n  } else if (ele instanceof Node) {\r\n    if (ele[eventlistenerssymbol]) {\r\n      removelisteners(ele);\r\n    }\r\n    /*   if (ele[bindstatesymbol]) {\r\n      ele[bindstatesymbol].forEach((state: ReactiveState) => {\r\n        unwatch(state);\r\n      });\r\n */\r\n    // readdlisteners(ele);\r\n    // }\r\n    //\r\n    /* 组件卸载时unwatch组件内部的 ReactiveState*/\r\n    if (ele[innerstatesymbol]) {\r\n      ele[innerstatesymbol].forEach((state: ReactiveState) => {\r\n        unwatch(state);\r\n      });\r\n    }\r\n    onunmounted(getdomchildren(ele));\r\n  }\r\n}\r\n","import { componentsymbol } from \"./iscomponent\";\r\nimport { readysymbol } from \"./readysymbol\";\r\n// import { readysymbol } from \"./createComponent\";\r\nexport const invalid_ReactiveState = \"invalid ReactiveState\";\r\nimport { get } from \"./reflect\";\r\nimport render from \"./rendervdomtoreal\";\r\nimport createeleattr from \"dom-element-attribute-agent-proxy\";\r\nimport { AttrChange } from \"./attrchange\";\r\n// import createElement from \"./createelement\";\r\nimport Virtualdom from \"./virtualdom\";\r\nimport ReactiveState, { isReactiveState } from './reactivestate';\r\nconst truevdomsymbol = Symbol(\"truevdom\");\r\nconst falsevdomsymbol = Symbol(\"falsevdom\");\r\nconst trueelesymbol = Symbol(\"trueele\");\r\nconst falseelesymbol = Symbol(\"falseele\");\r\nconst handletrue = getsymbol(\"handletrue\");\r\nconst handlefalse = getsymbol(\"handlefalse\");\r\n// const readysymbol = Symbol(\"ready\");\r\nimport { onmounted, onunmounted } from \"./elementonmountandunmount\";\r\n// import mount from \"./mount\";\r\nimport { isarray, getsymbol, isundefined, isboolean } from \"./util\";\r\nimport createApp, { invalid_Virtualdom } from \"./createApp\";\r\nimport { setelehtml } from \"./dom\";\r\nimport { isvalidvdom } from \"./html\";\r\n\r\nexport default function(\r\n  conditon: ReactiveState | boolean,\r\n  iftrue?:\r\n    | Virtualdom\r\n    | string\r\n    | Array<Virtualdom | string | ReactiveState>\r\n    | ReactiveState,\r\n  iffalse?:\r\n    | Virtualdom\r\n    | string\r\n    | Array<Virtualdom | string | ReactiveState>\r\n    | ReactiveState\r\n): Virtualdom {\r\n  if (!(isReactiveState(conditon) || isboolean(conditon))) {\r\n    throw TypeError(invalid_ReactiveState);\r\n  }\r\n  [iftrue, iffalse].forEach(a => {\r\n    if (!(isundefined(a) || isvalidvdom(a))) {\r\n      throw new TypeError(invalid_Virtualdom);\r\n    }\r\n  });\r\n  const options = { true: iftrue, false: iffalse };\r\n  class Condition extends AttrChange {\r\n    static [componentsymbol] = true;\r\n    [readysymbol] = false;\r\n    constructor(/* propsjson?: object, children?: any[], options: object = {} */) {\r\n      super();\r\n      // if(){}\r\n      const optionstrue = get(options, \"true\");\r\n      const optionsfalse = get(options, \"false\");\r\n      this[truevdomsymbol] = isarray(optionstrue)\r\n        ? optionstrue.filter(Boolean)\r\n        : [optionstrue].filter(Boolean);\r\n      this[falsevdomsymbol] = isarray(optionsfalse)\r\n        ? optionsfalse.filter(Boolean)\r\n        : [optionsfalse].filter(Boolean);\r\n      // optionsfalse;\r\n    }\r\n    [falseelesymbol]: any[];\r\n    [trueelesymbol]: any[];\r\n    [truevdomsymbol]: any[];\r\n    [falsevdomsymbol]: any[];\r\n    //   [readysymbol] = false;\r\n    [handlefalse]() {\r\n      setelehtml(this, \"\");\r\n      if (this[falsevdomsymbol]) {\r\n        if (!this[falseelesymbol]) {\r\n          // } else {\r\n          this[falseelesymbol] = render(this[falsevdomsymbol]);\r\n          // this[falsevdomsymbol].map(e => render(e));\r\n        }\r\n        //   mount(this[falseelesymbol], this);\r\n        const elementtomount = this[falseelesymbol];\r\n        createApp(elementtomount, this);\r\n        elementtomount.forEach(e => onmounted(e));\r\n        if (this[trueelesymbol]) {\r\n          this[trueelesymbol].forEach(e => onunmounted(e));\r\n        }\r\n      }\r\n    }\r\n    [handletrue]() {\r\n      setelehtml(this, \"\");\r\n      if (this[truevdomsymbol]) {\r\n        if (!this[trueelesymbol]) {\r\n          this[trueelesymbol] = render(this[truevdomsymbol]);\r\n          // this[truevdomsymbol].map(e => render(e));\r\n        }\r\n        //\r\n        //   mount(this[trueelesymbol], this);\r\n        const elementtomount = this[trueelesymbol];\r\n        createApp(elementtomount, this);\r\n        elementtomount.forEach(e => onmounted(e));\r\n        if (this[falseelesymbol]) {\r\n          this[falseelesymbol].forEach(e => onunmounted(e));\r\n        }\r\n      }\r\n    }\r\n    connectedCallback() {\r\n      if (!this[readysymbol]) {\r\n        // createApp(this[elementsymbol], this);\r\n        this[readysymbol] = true;\r\n\r\n        const attrs = createeleattr(this);\r\n        // console.log(attrs);\r\n        if (true === attrs[\"value\"]) {\r\n          this[handletrue]();\r\n        }\r\n        if (false === attrs[\"value\"]) {\r\n          this[handlefalse]();\r\n          //\r\n        }\r\n      }\r\n      onmounted(this);\r\n      //\r\n    }\r\n    disconnectedCallback() {\r\n      onunmounted(this);\r\n    }\r\n\r\n    attributeChangedCallback(\r\n      name: string /* , oldValue: any, newValue: any */\r\n    ) {\r\n      if (this[readysymbol]) {\r\n        // console.log(name, oldValue, newValue);\r\n        if (name === \"value\") {\r\n          const attrs = createeleattr(this);\r\n          //   console.log(attrs);\r\n          if (true === attrs[\"value\"]) {\r\n            this[handletrue]();\r\n            //\r\n          }\r\n          if (false === attrs[\"value\"]) {\r\n            this[handlefalse]();\r\n            //\r\n          }\r\n        }\r\n\r\n        //\r\n      }\r\n    }\r\n  }\r\n  /* vdom.options = { true: iftrue, false: iffalse }; */\r\n  const vdom = new Virtualdom(Condition, { value: conditon });\r\n  return vdom;\r\n  /*  */\r\n}\r\n","import {\r\n  //   deleteProperty,\r\n  get,\r\n  //   getOwnPropertyDescriptor,\r\n  has,\r\n  ownKeys\r\n  //   getPrototypeOf\r\n  //   set\r\n} from \"./reflect\";\r\n\r\nimport ReactiveState, {\r\n  isReactiveState,\r\n  dispatchsymbol\r\n} from \"./reactivestate\";\r\nimport { isFunction, isArray, isobject } from \"./util\";\r\nimport { invalid_ReactiveState } from \"./conditon\";\r\nimport { invalid_Function, usestste } from \"./context-mounted-unmounted-\";\r\nimport readonlyproxy from \"./readonlyproxy\";\r\nimport { watch } from \"./watch\";\r\nimport { toArray } from \"./toArray\";\r\nconst { defineProperty } = Object;\r\nexport default (\r\n  state: ReactiveState | Array<ReactiveState>,\r\n  callback: Function\r\n) => {\r\n  if (\r\n    !(\r\n      (isArray(state) || isReactiveState(state)) &&\r\n      // state instanceof ReactiveState\r\n      isFunction(callback)\r\n    )\r\n  ) {\r\n    console.error(state);\r\n    console.error(callback);\r\n    throw TypeError(invalid_ReactiveState + invalid_Function);\r\n  }\r\n  let state1array: ReactiveState[];\r\n  //   if (isReactiveState(state)) {\r\n  state1array = toArray(state);\r\n  /*  state1 = Arraycomputed(\r\n      toArray(state),\r\n\r\n      callback\r\n    ); */\r\n  //   } else if (isArray(state)) {\r\n  //     state1array = state;\r\n  //     // state1 = Arraycomputed(state, callback);\r\n  //   } else {\r\n  //     state1array = Array.from(state);\r\n  //   }\r\n  const state1 = Arraycomputed(state1array, callback);\r\n  usestste(state1);\r\n  return state1;\r\n};\r\n/* interface Call{\r\n    (...[]:Array)\r\n} */\r\nfunction Arraycomputed(\r\n  state: ReactiveState[],\r\n  callback: Function\r\n): ReactiveState {\r\n  const reactivestate = new ReactiveState();\r\n  const getter = () => {\r\n    const value = callback.call(undefined, ...state.map(st => st.value));\r\n    return isReactiveState(value) ? value.value : value;\r\n  };\r\n  defineProperty(reactivestate, \"value\", {\r\n    get: getter,\r\n    configurable: true\r\n  });\r\n  let memorized = getter();\r\n  state.forEach(state => {\r\n    watch(state, () => {\r\n      let newvalue = getter();\r\n      if (newvalue !== memorized) {\r\n        reactivestate[dispatchsymbol]();\r\n\r\n        memorized = newvalue;\r\n      }\r\n      //\r\n    });\r\n  });\r\n\r\n  return getproperyreadproxy(readonlyproxy(reactivestate));\r\n}\r\nconst __proto__ = \"__proto__\";\r\nexport function getproperyreadproxy<T extends object>(a: T): T;\r\nexport function getproperyreadproxy(a: object) {\r\n  /* 把基本类型原型的属性 也加上*/\r\n  //   const target = isobject(a) ? a : getPrototypeOf(a);\r\n  const target = a;\r\n  return new Proxy(target, {\r\n    ownKeys(target) {\r\n      let myvalue = get(target, \"value\");\r\n      const myvalueobj = isobject(myvalue) ? myvalue : myvalue[__proto__];\r\n      //   return ownKeys(target);\r\n      return Array.from(new Set([...ownKeys(target), ...ownKeys(myvalueobj)]));\r\n\r\n      /* Array.from(\r\n        new Set([...ownKeys(target), ...ownKeys(get(target, \"value\"))])\r\n      ); */\r\n    },\r\n    has(target, key) {\r\n      const myvalue = get(target, \"value\");\r\n      const myvalueobj = isobject(myvalue) ? myvalue : myvalue[__proto__];\r\n      return has(target, key) || has(myvalueobj, key);\r\n    },\r\n    get(target, key) {\r\n      const myvalue = get(target, \"value\");\r\n      const myvalueobj = isobject(myvalue) ? myvalue : myvalue[__proto__];\r\n\r\n      if (has(target, key)) {\r\n        return get(target, key);\r\n      } else if (has(myvalueobj, key)) {\r\n        return get(myvalueobj, key);\r\n      }\r\n      //   return get(target, key);\r\n      /*  const myvalue = get(target, \"value\");\r\n\r\n      if (has(target, key)) {\r\n        return get(target, key);\r\n      } else if (has(myvalue, key)) {\r\n        return get(myvalue, key);\r\n      } */\r\n    }\r\n  });\r\n}\r\n","export default function createRef(init: any) {\r\n  return { value: init };\r\n}\r\n","import { invalid_Function } from \"./context-mounted-unmounted-\";\r\nimport Virtualdom from \"./virtualdom\";\r\ninterface Extendfun {\r\n  (element: Element, value: any, vdom: Virtualdom): void;\r\n}\r\nimport directives from \"./directives\";\r\nexport default function extenddirectives(options: {\r\n  [s: string]: Extendfun;\r\n}): void {\r\n  Object.entries(options).forEach(([key, value]) => {\r\n    if (typeof value !== \"function\") {\r\n      throw TypeError(invalid_Function);\r\n    } else {\r\n      directives[key] = value;\r\n    }\r\n  });\r\n}\r\n","import ReactiveState, {\r\n  // ReactiveState,\r\n  isReactiveState\r\n} from './reactivestate';\r\nimport directives from \"./extend-directive\";\r\nimport Virtualdom from \"./virtualdom\";\r\nimport { invalid_ReactiveState } from \"./conditon\";\r\nimport { invalid_Virtualdom } from \"./createApp\";\r\ndirectives({\r\n  value(element: any, value: ReactiveState, vdom: Virtualdom) {\r\n    if (\r\n      isReactiveState(value) &&\r\n      //   value instanceof ReactiveState\r\n\r\n      (vdom.type === \"input\" || vdom.type === \"textarea\")\r\n    ) {\r\n      vdom.bindattr[\"value\"] = value;\r\n      [\"change\", \"input\"].forEach(eventname => {\r\n        const origin = vdom.onevent[eventname];\r\n\r\n        const eventsarray = [origin].flat(Infinity);\r\n\r\n        // vdom.onevent[eventname] =\r\n        Reflect.set(\r\n          vdom.onevent,\r\n          eventname,\r\n         [... eventsarray,\r\n           // .concat([\r\n              (e: any) => {\r\n                return (value.value = e.target.value);\r\n              }\r\n           // ])\r\n]\r\n            .filter(Boolean)\r\n        );\r\n      });\r\n    } else {\r\n      console.error(value);\r\n      console.error(vdom);\r\n      throw TypeError(invalid_ReactiveState + invalid_Virtualdom);\r\n    }\r\n  }\r\n});\r\ndirectives({\r\n  checked(element: any, value: ReactiveState, vdom: Virtualdom) {\r\n    if (\r\n      isReactiveState(value) &&\r\n      //   value instanceof ReactiveState\r\n\r\n      (vdom.type === \"input\" )\r\n    ) {\r\n      vdom.bindattr[\"checked\"] = value;\r\n      [\"change\", \"input\"].forEach(eventname => {\r\n        const origin = vdom.onevent[eventname];\r\n\r\n        const eventsarray = [origin].flat(Infinity);\r\n\r\n        // vdom.onevent[eventname] =\r\n        Reflect.set(\r\n          vdom.onevent,\r\n          eventname,\r\n         [... eventsarray,\r\n           // .concat([\r\n              (e: any) => {\r\n                return (value.value = e.target.checked);\r\n              }\r\n           // ])\r\n]\r\n            .filter(Boolean)\r\n        );\r\n      });\r\n    } else {\r\n      console.error(value);\r\n      console.error(vdom);\r\n      throw TypeError(invalid_ReactiveState + invalid_Virtualdom);\r\n    }\r\n  }\r\n});\r\n","// import { isobject, isfunction } from \"./util\";\r\nimport \"./assetbrowser\";\r\nimport computed from \"./computed\";\r\nimport condition from \"./conditon\";\r\nimport { useMounted, useUnMounted } from \"./context-mounted-unmounted-\";\r\nimport createApp from \"./createApp\";\r\nimport { createComponent } from \"./createComponent\";\r\nimport createElement from \"./createelement\";\r\nimport createRef from \"./createref\";\r\nimport createState from \"./createstate\";\r\nimport \"./CustomElementRegistry\";\r\nimport directives from \"./extend-directive\";\r\nimport html from \"./html\";\r\n//请自行使用babel-preset-env和core-js 3\r\n//import \"./Object-fromEntries\";\r\n// import \"./setImmediate\";\r\n//import \"./array-prototype-flat\";\r\nimport \"./input-textarea-value-directive-Bidirectional-binding\";\r\nimport { watch } from \"./watch\";\r\nexport { computed };\r\nexport { useMounted, useUnMounted };\r\nexport { createComponent };\r\nexport { html };\r\nexport { createElement, createElement as h };\r\nexport { createApp };\r\nexport { createRef };\r\nexport { createState };\r\nexport { watch };\r\nexport { directives };\r\nexport { condition };\r\n\r\n//export { RandomDefine };\r\nexport const Fragment = \"\";\r\n/* function css(text: string) {\r\n  return text;\r\n}\r\nexport { css }; */\r\n"],"names":["Reflect","window","construct","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","has","ownKeys","set","a","isString","isnumber","isboolean","isundefined","isobject","isstring","isfunction","isarray","Array","isArray","gettagtype","getsymbol","Symbol","toString","call","replace","toLowerCase","trim","isSet","Set","HTMLElement","Proxy","customElements","CustomElementRegistry","TypeError","invalid_primitive_or_object_state","isReactiveState","ReactiveState","eventtargetsymbol","memlisteners","dispatchsymbol","subscribesymbol","removeallistenerssymbol","addallistenerssymbol","[object Object]","init","this","EventTarget","isprimitive","Object","defineProperty","value","configurable","writable","console","error","forEach","callback","addEventListener","String","JSON","stringify","eventname","name","dispatchEvent","CustomEvent","detail","push","event","undefined","removeEventListener","toPrimitive","prototype","toStringTag","componentsymbol","readysymbol","document","seteletext","e","v","textContent","setelehtml","innerHTML","appendchild","container","ele","appendChild","createsvgelement","createElementNS","svgnamespace","createDocumentFragment","createnativeelement","type","createElement","namespace","createtextnode","data","createTextNode","changetext","textnode","nodeValue","mathnamespace","createmathelement","domaddlisten","domremovelisten","getdomchildren","from","childNodes","getAttribute","HTMLElementprototype","setAttribute","removeAttribute","createanotherhtmldocument","implementation","createHTMLDocument","getparentNode","parentNode","isconnected","element","documentElement","getancestornode","node","requestAnimationFrame","ref","html","createhtmlandtextdirective","text","errorname","watch","state","invalid_Function","errormessage","ctxopen","MountedSet","UnMountedSet","StateSet","getstates","usestste","add","getMounted","getUnMounted","useMounted","fun","isFunction","Error","useUnMounted","clearMounted","clearstate","clearUnMounted","openctx","clearall","closectx","statekey","invalid_ReactiveState","unwatch","rewatch","toArray","flat","eventlistenerssymbol","firstaddlisteners","callarray","removelisteners","readdlisteners","invalid_custom_element_class","使用value从表中查询key","表","组件状态名","entries","find","elementset","for","elementmap","initclass","extendsname","RandomDefineCustomElement","length","isclassextendsHTMLElement","elementname","getrandomstringandnumber","define","extends","constructor","options","iterator","getrandomcharactor","fill","map","i","n","fromCharCode","Math","floor","random","getrandomhexnumber","join","createcostumelemet","propsjson","children","clear","eles","Infinity","valuestring","objtostylestring","o","key","asserthtmlelement","Element","createeleattragentreadwrite","isinputtextortextareaflag","isinputtextortextarea","temp","create","outputattrs","keys","attributesownkeys","target","getattribute","parse","t","geteletagname","setattribute","k","hasAttribute","otherdescipter","enumerable","myvalue","getAttributeNames","tagName","tagname","merge_entries","m","isVirtualdom","Virtualdom","props","字母大小写","propsentries","propsentriesNOTevents","filter","startsWith","字母开头的entries","test","assign","bindattr","fromEntries","onevent","slice","directives","bindstatesymbol","reactivestatesymbol","virtualdomsymbol","throwinvalideletype","render","vdom","reactive","handleprops","mount","attribute1","createeleattr","primitivestate","callbacks","values","attributeChangedCallback","AttrChange","qualifiedName","oldValue","setimmediate","Promise","resolve","then","apply","setPrototypeOf","deepobserveaddpath","patharray","ancestor","fakeobj","p","argumentslist","thisarg","argarray","descripter","observedeepagent","createstate","getproperyreadproxy","deepobserve","_target","returnvalue","dele","r","u","s","h","f","Map","arguments","typenormalized","propsnormalized","childrennormalized","invalid_Virtualdom","createApp","el","body","head","elesarray","isvalidvdom","Node","isNodeArray","array","includes","inargs","htm","flag","assertvalidvirtualdom","args","createcssBlob","source","URL","createObjectURL","Blob","isCSSMediaRule","isCSSImportRule","parsecsstext","styleelement","otherdocument","firstElementChild","sheet","cssRules","isCSSStyleRule","selectoraddprefix","cssstylerule","prefix","selectorText","selectorarray","split","prefixselector","prefixcssrules","cssRulesarray","cssrule","savestyleblob","href","Boolean","componentsstylesheet","csstext","urltext","cssrulestocsstext","cssrules","c","cssText","createlinkstylesheet","url","rel","transformcsstext","css","cssomold","cssomnew","cssnewtext","registercssprefix","loadlinkstyle","stylelinkelement","rs","loaderrorfun","onload","onerror","waitloadallstyle","_this","all","styleurl","innerstatesymbol","attributessymbol","elementsymbol","vdomsymbol","mountedsymbol","unmountedsymbol","createComponent","custfun","defaultProps","Component","super","attrs","thisattributess","readonlyproxy","readonlyprop","possiblyvirtualdom","thisvdomsymbol","onmounted","onunmounted","_d","truevdomsymbol","falsevdomsymbol","trueelesymbol","falseelesymbol","handletrue","handlefalse","conditon","iftrue","iffalse","true","false","Condition","optionstrue","optionsfalse","elementtomount","state1array","state1","Arraycomputed","reactivestate","getter","st","memorized","newvalue","__proto__","myvalueobj","createRef","extenddirectives","origin","eventsarray","checked","Fragment"],"mappings":"AAAA,MAAMA,YAAUC,OAAOD;;AACvB,OAEaE,WAEXA,WAASC,gBAETA,gBAAcC,KACdA,KAAGC,0BACHA,0BAAwBC,gBACxBA,gBAAcC,KACdA,KAAGC,SAGHA,SAAOC,KAEPA,OAEET;;qBCjBoBU;IACtB,OACEC,SAASD,MACTE,SAASF,MACTG,UAAUH,MACVI,YAAYJ,aACLA,MAAM;;;SCJDI,YAAYJ;IAC1B,cAAcA,MAAM;;;SAGNE,SAASF;IACvB,cAAcA,MAAM;;;SAENG,UAAUH;IACxB,cAAcA,MAAM;;;SAENK,SAASL;IACvB,cAAcA,MAAM,YAAYA,MAAM;;;SAIxBM,SAASN;IACvB,cAAcA,MAAM;;;SAENO,WAAWP;IACzB,cAAcA,MAAM;;;SAGNQ,QAAQR;IACtB,OAAOA,aAAaS,SAASA,MAAMC,QAAQV,MAAMW,WAAWX,OAAO;;;SAGrDY,UAAUZ;IACxB,OAAOa,OAAOb;;;SAEAW,WAAWX;IACzB,OAAO,GAAGc,SACPC,KAAKf,GACLgB,QAAQ,YAAY,IACpBA,QAAQ,KAAK,IACbC,cACAC;;;SAKWC,MAAMnB;IACpB,OAAOW,WAAWX,OAAO,SAASA,aAAaoB;;;AC3CjD,KACGb,WAAWhB,OAAO8B,iBAElBd,WAAWhB,OAAO+B,WAElBjB,SAASd,OAAOgC,oBAEhBhB,WAAWhB,OAAOiC,wBAGnB;IACA,MAAM,IAAIC,UAAU;;;;;ACZf,MAAMC,oCACX;;SACcC,gBAAgB3B;IAC9B,OAAOA,aAAa4B;;;AAQf,MAAMC,oBAAoBhB,OAAO;;AACjC,MAAMiB,eAAejB,OAAO;;AAC5B,MAAMkB,iBAAiBlB,OAAO;;AAC9B,MAAMmB,kBAAkBpB,UAAU;;AAClC,MAAMqB,0BAA0BrB,UAAU;;AAC1C,MAAMsB,uBAAuBtB,UAAU;;AAS9C,MAAqBgB;IAoBnBO,YAAYC;QAFZC,WAAsB,IAAIC;QAC1BD,WAAiD;QAG/C,IAAIE,YAAYH,SAAS/B,SAAS+B,OAAO;YACvCI,OAAOC,eAAeJ,MAAM,SAAS;gBACnCK,OAAON;gBACPO,cAAc;gBACdC,UAAU;;eAIP;YACLC,QAAQC,MAAMV;YACd,MAAMX,UAAUC;;;IAxBpBS,CAACD;QACCG,KAAKP,cAAciB,QAAQ,EAAEL,OAAOM;YAClCX,KAAKR,mBAAmBoB,iBAAiBP,OAAOM;;;IAmCpDb;QACE,OAAOE,KAAKK;;IAEdP;QACE,MAAMO,QAAQL,KAAKK;QACnB,OAAOH,YAAYG,SACfQ,OAAOR,SACPvB,MAAMuB,SACNS,KAAKC,UAAU,KAAIV,WACnBrC,SAASqC,SACTS,KAAKC,UAAUV,SACf;;IAENP,OAxCCN,wBACAC,cAuCAC,iBAAgBsB;QACf,MAAMC,OAAOD,YAAYH,OAAOG,aAAa;QAC7C,IAAIC,SAAS,SAAS;YACpBjB,KAAKR,mBAAmB0B,cACtB,IAAIC,YAAYF,MAAM;gBAAEG,QAAQH;;;QAIpCjB,KAAKR,mBAAmB0B,cACtB,IAAIC,YAAY,SAAS;YAAEC,QAAQH;;;IAGvCnB,CAACH,iBAAiBgB,UAAoBK;QAEpC,MAAMC,OAAOD,YAAYH,OAAOG,aAAa;QAC7ChB,KAAKP,cAAc4B,KAAK,EACtBJ,MACCK,SAAiBX,SAASjC,KAAK6C,WAAWvB,MAAM3C,IAAIiE,OAAO;;IAGhExB,CAACF;QACCI,KAAKP,cAAciB,QAAQ,EAAEL,OAAOM;YAClCX,KAAKR,mBAAmBgC,oBAAoBnB,OAAOM;;;IAGvDb,CAACtB,OAAOiD;QAEN,MAAMpB,QAAQL,KAAKK;QACnB,OAAOH,YAAYG,SACfA,QACArC,SAASqC,SACTS,KAAKC,UAAUV,cACV;;;;AAGbpD,QAAQmD,eAAeb,cAAcmC,WAAWlD,OAAOmD,aAAa;IAClEtB,OAAO;;;ACvHT,MAAMuB,kBAAkBpD,OAAO;;ACAxB,MAAMqD,cAAcrD,OAAO;;ACAlC,MAAMsD,aAAW5E,OAAO4E;;SAIRC,WAAWC,GAAmBC;IAC5CD,EAAEE,cAAcD;;;SAEFE,WAAWH,GAAYC;IACrCD,EAAEI,YAAYH;;;SAEAI,YACdC,WACAC;IAEAD,UAAUE,YAAYD;;;AAExB,SAAgBE;IACd,OAAOC,gBAAgBC,cAAc;;;AAEvC,SAGgBC;IACd,OAAOd,WAASc;;;SAEFC,oBAAoBC;IAClC,OAAOhB,WAASiB,cAAcD;;;SAEhBJ,gBAAgBM,WAAmB/B;IACjD,OAAOa,WAASY,gBAAgBM,WAAW/B;;;SAE7BgC,eAAeC;IAC7B,OAAOpB,WAASqB,eAAetC,OAAOqC;;;AAEjC,MAAMP,eAAe;;SACZS,WAAWC,UAAgBhD;IACzCgD,SAASC,YAAYzC,OAAOR;;;AAIvB,MAAMkD,gBAAgB;;AAE7B,SAAgBC;IACd,OAAOd,gBAAgBa,eAAe;;;AAExC,SAgBgBE,aACdlB,KACAjB,OACA5C;IAEA6D,IAAI3B,iBAAiBU,OAAO5C;;;AAG9B,SAAgBgF,gBACdnB,KACAjB,OACA5C;IAEA6D,IAAIf,oBAAoBF,OAAO5C;;;SAEjBiF,eAAepB;IAC7B,OAAOnE,MAAMwF,KAAKrB,IAAIsB;;;SAERC,aAAavB,KAActB;IACzC,OAAO8C,qBAAqBD,aAAapF,KAAK6D,KAAKtB;;;AAErD,SAAgB+C,aAAazB,KAActB,MAAcZ;IACvD0D,qBAAqBC,aAAatF,KAAK6D,KAAKtB,MAAMZ;;;SAEpC4D,gBAAgB1B,KAActB;IAC5C8C,qBAAqBE,gBAAgBvF,KAAK6D,KAAKtB;;;AAEjD,MAAM8C,uBAAuB/E,YAAY0C;;AAEzC,SAMgBwC;IACd,OAAOpC,WAASqC,eAAeC,mBAAmB;;;SAEpCC,cAAc9B;IAC5B,OAAOA,IAAI+B;;;SClGGC,YAAYC;IAC1B,OAAO1C,SAAS2C,oBAAoBC,gBAAgBF;;;AAEtD,SAASE,gBAAgBC;IACvB,OAAON,cAAcM,SAASN,cAAcM,UAAU7C,UAAU;QAC9D6C,OAAOA,KAAKL;;IAEd,OAAOK;;;ACTF,MAAMC,wBAAwB1H,OAAO0H;;AAO5C,iBAAe;IACb9E,IAAIyC,KAAcsC;QAChB,IAAI7G,SAAS6G,MAAM;YACjBA,IAAIxE,QAAQkC;eACP;YACL,MAAMnD,UAAU;;;IAGpBU,KAAKyC,KAAcuC;QACjBC,2BAA2B5C,YAAY,OAAvC4C,CAA+CxC,KAAKuC;;IAiCtDhF,KAAKyC,KAAcyC;QACjBD,2BAA2BhD,YAAY,OAAvCgD,CAA+CxC,KAAKyC;;;;AAmCxD,SAASD,2BAA2BhD,YAAsBkD;IACxD,OAAO,SAAS1C,KAAcyC;QAC5B,MAAMR,UAAUjC;QAChB,WAAWyC,QAAQ,UAAU;YAC3BJ,sBAAsB;gBACpB7C,WAAWQ,KAAKyC;;eAIb,IACL1F,gBAAgB0F,OAEhB;YAEAE,MAAMF,MAAOG;gBACX,IAAIZ,YAAYC,UAAU;oBACxBzC,WAAWQ,KAAK1B,OAAOsE;;;YAO3BP,sBAAsB;gBAEpB7C,WAAWQ,KAAK1B,OAAOmE;;eAIpB;YACL,MAAM5F,UAAU,aAAa6F;;;;;ACjH5B,MAAMG,mBAAmB;;AAChC,MAAMC,eACJ;;AACF,IAAIC,UAAU;;AACd,IAAIC,aAA4B,IAAIxG;;AACpC,IAAIyG,eAA8B,IAAIzG;;AACtC,IAAI0G,WAA+B,IAAI1G;;AAEvC,SAAgB2G;IACd,OAAO,KAAID;;;SAEGE,SAASR;IACvB,IAAIG,SAAS;QACXG,SAASG,IAAIT;;;;AAGjB,SAAgBU;IACd,OAAO,KAAIN;;;AAEb,SAAgBO;IACd,OAAO,KAAIN;;;SAEGO,WAAWC;IACzB,IAAIC,WAAWD,MAAM;QACnB,IAAIV,SAAS;YACXC,WAAWK,IAAII;eACV;YACL,MAAME,MAAMb;;WAET;QACL,MAAMjG,UAAUgG;;;;SAIJe,aAAaH;IAC3B,IAAIC,WAAWD,MAAM;QACnB,IAAIV,SAAS;YACXE,aAAaI,IAAII;eACZ;YACL,MAAME,MAAMb;;WAET;QACL,MAAMjG,UAAUgG;;;;AAGpB,SAAgBgB;IACdb,aAAa,IAAIxG;;;AAGnB,SAASsH;IACPZ,WAAW,IAAI1G;;;AAEjB,SAAgBuH;IACdd,eAAe,IAAIzG;;;AAErB,SAAgBwH;IACdjB,UAAU;IACVkB;;;AAEF,SAAgBC;IACdnB,UAAU;IACVkB;;;AAEF,SAASA;IACPJ;IACAE;IACAD;;;SC1DcnB,MACdC,OACAxE,UACA+F;IAEA,MAEIpH,gBAAgB6F,UAEhBc,WAAWtF,YAEb;QACAH,QAAQC,MAAM0E;QACd3E,QAAQC,MAAME;QACd,MAAMvB,UAAUuH,wBAAwBvB;;IAG1C,IAAIsB,UAAU;QACZvB,MAAMxF,iBAAiBgB,UAAU+F;WAC5B;QACLvB,MAAMxF,iBAAiBgB;;IAGzBiE,sBAAsB;QACpBO,MAAMtF;;;;SAGM+G,QAAQzB;IACtBA,MAAMvF;;;SAGQiH,QAAQ1B;IACtBA,MAAMtF;;;SCtCQiH,QAAQnJ;IACtB,QAAQU,QAAQV,KAAKA,IAAI,EAACA,KAAIoJ;;;ACFzB,MAAMC,uBAAuBxI,OAAO;;iBAGzCgG,SACAxD,WACAL;IAMAsG,kBAAkBzC,SAASxD,WAAW8F,QAAQnG;;;AAWhD,SAAgBsG,kBACd1E,KACAjB,OACA4F;IAEA,MAAM1C,UAAUjC;IAChB2E,UAAUxG,QAAShC;QACjB,KAAKR,WAAWQ,OAAO;YACrB8B,QAAQC,MAAM/B;YACd,MAAMU,UAAUgG;;QAGlB,KAAKZ,QAAQwC,uBAAuB;YAClCxC,QAAQwC,wBAAwB;;QAGlCzE,IAAIyE,sBAAsB3F,KAAK,EAACC,OAAO5C;QACvC+E,aAAalB,KAAKjB,OAAO5C;;;;SAGbyI,gBACd5E;IAKA,IAAIA,IAAIyE,uBAAuB;QAC7BzE,IAAIyE,sBAAsBtG,QAAQ,EAAEY,OAAO5C;YAEzCgF,gBAAgBnB,KAAKjB,OAAO5C;;;;;SAIlB0I,eACd7E;IAIA,IAAIA,IAAIyE,uBAAuB;QAC7BzE,IAAIyE,sBAAsBtG,QAAQ,EAAEY,OAAO5C;YAEzC+E,aAAalB,KAAKjB,OAAO5C;;;;;AClExB,MAAM2I,+BAA+B;;AAC5C,KAGGrJ,SAASd,OAAOgC,iBAKjB;IACA,MAAM,IAAIE,UAAU;;;AAItB,SAASkI,mDAAgBC,QAAWC;IAClC,OAAOrH,OAAOsH,QAAQF,QAAGG,KAAKzF;QAC5B,OAAOA,EAAE,OAAOuF;OACf;;;AAOLtK,OAAOiC,wBAAwB9B,IAC7BE,eAAeL,OAAOgC,iBACtB;;AAEF,OAAMA,gBAAEA,gBAAcC,uBAAEA,yBAA0BjC;;AAGlD,MAAMyK,aAAanJ,OAAOoJ,IAAI;;AAC9B,MAAMC,aAAarJ,OAAOoJ,IAAI;;AAC9B,gCAAe,CAACE,WAAqBC,gBACnCC,4BAA0BF,WAAWC;;AAEvC,SAASC,4BACPF,WACAC,aACAE,SAAS;IAET,KAAKC,0BAA0BJ,YAAY;QACzC,MAAM1I,UAAUiI;;IAKlB,KAAKnI,eAAeyI,YAAYnK,IAAIsK,YAAY;QAC9C,MAAMK,cAAcC,yBAAyBH;QAE7C,IAAI/I,eAAe7B,IAAI8K,cAAc;YACnC,OAAOH,4BAA0BF,WAAWC,aAAaE,SAAS;eAC7D;YACL,IAAIF,aAAa;gBACf7I,eAAemJ,OAAOF,aAAaL,WAAW;oBAAEQ,SAASP;;mBACpD;gBACL7I,eAAemJ,OAAOF,aAAaL;;;QAIvC,OAAOK;WACF;QACL,OAAOb,mDAAgBpI,eAAe2I,aAAaC;;;;AAKvD,KAAK5I,eAAeyI,aAAa;IAC/BzI,eAAeyI,cAAc,IAAI5I;;;AAEnC,KAAKG,eAAe2I,aAAa;IAC/B3I,eAAe2I,cAAc;;;AAM/B3I,eAAemJ,SAAS,SACtBpH,MACAsH,aACAC;IAEA,KAAKN,0BAA0BK,cAAc;QAC3C/H,QAAQC,MAAM8H;QACd,MAAMnJ,UAAUiI;;IAElB,KAAKnI,eAAeyI,YAAYnK,IAAI+K,cAAc;QAChD,IAAI/K,IAAI0B,eAAe2I,aAAa5G,OAAO;YAEzC+G,4BACEO,aACAC,UAAUA,QAAQF,UAAU/G;eAEzB;YACLpC,sBAAsBuC,UAAU2G,OAAO3J,KACrCQ,gBACA+B,MACAsH,aACAC;YAEFtJ,eAAeyI,YAAY/B,IAAI2C;YAC/BrJ,eAAe2I,YAAY5G,QAAQsH;;;;;AAKzCrJ,eAAeV,OAAOiK,YAAY;IAChC,MAAMhB,UAAUtH,OAAOsH,QAAQvI,eAAe2I;IAE9C,OAAOJ,QAAQjJ,OAAOiK,UAAU/J,KAAK+I;;;AAEvC,SAASiB;IACP,OAAOrL,IACLe,MAAM,IACHuK,KAAKpH,WACLqH,IAAI,CAAC3G,GAAG4G,MAAM,KAAKA,GACnBD,IAAIE,KAAKjI,OAAOkI,aAAaD,KAChCE,KAAKC,MAAMD,KAAKE,WAAW;;;AAK/B,SAASC;IACP,OAAO9L,IACLe,MAAM,IACHuK,KAAKpH,WACLqH,IAAI,CAAC3G,GAAG4G,MAAMA,IACjBG,KAAKC,MAAMD,KAAKE,WAAW,KAC3BzK,SAAS;;;AAOb,SAAS2J,yBAAyBH,SAAS;IACzC,OACE7J,MAAM6J,QACHU,KAAKpH,WACLqH,IAAI,MAAMF,sBAEVU,KAAK,MACR,MACAhL,MAAM6J,QACHU,KAAKpH,WACLqH,IAAI,MAAMO,sBACVC,KAAK;;;SCxIIlB,0BAA0BJ;IAGxC,UACE5J,WAAW4J,cACXA,UAAUpG,aACVoG,UAAUpG,qBAAqB1C;;;AAInC,SAMgBqK,mBACdvB,WACAwB,WACAC,UACAf;IAEA,IAAIN,0BAA0BJ,YAAY;QAQxCE,0BAA0BF;QAC1B,OAAO3K,UAAU2K,WAAW,EAACwB,WAAWC,UAAUf;WAC7C;QACLhI,QAAQC,MAAMqH;QAEd,MAAM1I,UAAUiI;;;;eC1ClB9E,KAiBAD,WACAkH,QAAiB;IAEjB,IAAIA,OAAO;QACTzH,WAAWO,WAAW;;IAUxB,MAAMmH,OAAO3C,QAAQvE,KAAKwE,KAAK2C;IAC/BD,KAAK/I,QAASsB,KACZK,YAAYC,WAAWN;IAEzB,OAAOM;;;ACtCT,MAAMzB,WAAS3D,OAAO2D;;AAEtB,MAAM5D,YAAUC,OAAOD;;AAEvB,OAAOI,KAAKA,OAAKK,KAAKA,SAAOT;;AAE7B,MAAM0M,cAAc;;AAEpB,SAAS3L,WAASL;IACd,cAAcA,MAAM,YAAYA,MAAM;;;AAG1C,SAASM,WAASN;IACd,cAAcA,MAAM;;;AAGxB,SAASU,QAAQV;IACb,OAAOS,MAAMC,QAAQV;;;AAGzB,SAASmB,QAAMnB;IACX,OAAOA,aAAaoB;;;AAGxB,SAAS6K,iBAAiBC;IACtB,OAAO1J,OAAOsH,QAAQoC,GAAGjB,IAAI,EAAEkB,KAAKzJ,WAAWyJ,MAAM,MAAMzJ,OAAO+I,KAAK;;;AAG3E,SAASW,kBAAkBxH;IACvB,MAAMA,eAAeyH,UAAU;QAC3B,MAAM5K,UAAU;WACb,OAAO;;;AAGlB,SAAS6K,4BAA4B1H;IACjCwH,kBAAkBxH;IAClB,MAAM2H,4BAA4BC,sBAAsB5H;IACxD,IAAI6H,OAAOjK,OAAOkK,OAAO;IACzB,MAAMC,cAAc,IAAIrL,MAAMmL,MAAM;QAChCtK;YACI,MAAMyK,OAAOC,kBAAkBjI;YAC/B,OAAO2H,4BAA4B9L,MAAMwF,KAAK,IAAI7E,IAAI,KAAKwL,MAAMZ,kBAAkBY;;QAEvFzK,IAAI2K,QAAQX;YACR,IAAII,6BAA6BJ,QAAQH,aAAa;gBAClD,OAAOtM,MAAIkF,KAAKoH;mBACb;gBACH,MAAM1H,IAAIyI,aAAanI,KAAK1B,SAAOiJ;gBACnC,IAAI7H,MAAM,IAAI;oBACV,OAAO;;gBAEX,IAAIA,MAAM,MAAM;oBACZ;;gBAEJ,IAAIhE,WAASgE,IAAI;oBACb;wBACI,OAAOnB,KAAK6J,MAAM9J,SAAOoB;sBAC3B,OAAOxB;wBACL,OAAOwB;;uBAER;;;QAGfnC,IAAI8K,GAAGd,KAAK7H;YACR,IAAI,sBAAsBA,GAAG;gBACzBzB,QAAQC,MAAMwB;gBACd,MAAM7C,UAAU;;YAEpB,IAAIyL,cAActI,SAAS,WAAWuH,QAAQ,WAAW;gBACrDpM,MAAI6E,KAAKuH,KAAK7H;gBACd,OAAO;;YAEX,IAAIiI,6BAA6BJ,QAAQH,aAAa;gBAClD,OAAOjM,MAAI6E,KAAKoH,aAAa1H;mBAC1B,IAAI6H,QAAQ,SAAS;gBACxBgB,aAAavI,KAAK1B,SAAOiJ,MAAM7L,WAASgE,KAAKA,IAAIjE,WAASiE,KAAK2H,iBAAiB3H,KAAKpB,SAAOoB;gBAC5F,OAAO;mBACJ,IAAI6H,QAAQ,WAAW9L,WAASiE,IAAI;gBACvC,IAAI5D,QAAQ4D,IAAI;oBACZ6I,aAAavI,KAAK1B,SAAOiJ,MAAM7H,EAAEmH,KAAK;uBACnC,IAAItK,QAAMmD,IAAI;oBACjB6I,aAAavI,KAAK1B,SAAOiJ,MAAM,KAAK7H,IAAImH,KAAK;uBAC1C;oBACH0B,aAAavI,KAAK1B,SAAOiJ,MAAMhJ,KAAKC,UAAUkB;;mBAE/C;gBACH,IAAInD,QAAMmD,IAAI;oBACV6I,aAAavI,KAAK1B,SAAOiJ,MAAMhJ,KAAKC,UAAU,KAAKkB;uBAChD;oBACH,IAAIA,MAAM,MAAM;wBACZA,IAAI;;oBAER6I,aAAavI,KAAK1B,SAAOiJ,MAAM9L,WAASiE,KAAKnB,KAAKC,UAAUkB,KAAKpB,SAAOoB;oBACxE,OAAO;;;YAGf,OAAO;;QAEXnC,eAAe8K,GAAGG;YACd9G,kBAAgB1B,KAAK1B,SAAOkK;YAC5B,OAAO;;QAEXjL,IAAI2K,QAAQX;YACR,IAAII,6BAA6BJ,QAAQH,aAAa;gBAClD,OAAO;mBACJ;gBACH,OAAOqB,aAAazI,KAAK1B,SAAOiJ;;;QAGxChK;YACI,OAAO;;QAEXA,yBAAyB2K,QAAQX;YAC7B,MAAMmB,iBAAiB;gBACnBC,YAAY;gBACZ5K,cAAc;gBACdC,UAAU;;YAEd,MAAM4K,UAAU9N,MAAIiN,aAAaR;YACjC,WAAWqB,YAAY,aAAa;gBAChC,OAAO;oBACH9K,OAAO8K;uBACJF;;mBAEJ;gBACH;;;QAGRnL;YACI,OAAO;;;IAGf,OAAOwK;;;AAGX,SAASE,kBAAkBjI;IACvB,OAAOA,IAAI6I;;;AAGf,SAASV,aAAanI,KAAKuH;IACvB,OAAOvH,IAAIuB,aAAagG;;;AAG5B,SAASe,cAActI;IACnB,OAAOA,IAAI8I,QAAQzM;;;AAGvB,SAASkM,aAAavI,KAAKuH,KAAKzJ;IAC5B,OAAOkC,IAAIyB,aAAa8F,KAAKzJ;;;AAGjC,SAAS4D,kBAAgB1B,KAAKuH;IAC1B,OAAOvH,IAAI0B,gBAAgB6F;;;AAG/B,SAASkB,aAAazI,KAAKuH;IACvB,OAAOvH,IAAIyI,aAAalB;;;AAG5B,SAASK,sBAAsB5H;IAC3B,MAAM+I,UAAUT,cAActI;IAC9B,OAAO+I,YAAY,WAAWjO,MAAIkF,KAAK,YAAY,UAAU+I,YAAY;;;SCzJ7DC,cAAc5N;IAC5B,MAAM6N,IAA+B;IAErC7N,EAAE+C,QAAQ,EAAEoJ,KAAKzJ;QACf,KAAKmL,EAAE1B,MAAM;YACX0B,EAAE1B,OAAO,IAAI/K;;QAIfsB,MAAMK,QAASuB;YACbuJ,EAAE1B,KAAKlE,IAAI3D;;;IAGf,OAAO9B,OAAOsH,QAAQ+D,GAAG5C,IAAI,EAAEmC,GAAG9I,OAAO,EAAC8I,GAAG3M,MAAMwF,KAAK3B;;;SCrB1CwJ,aAAa9N;IAC3B,OAAOA,aAAa+N;;;AAEtB,MAKqBA;IAYnB5L,YACEgD,OAA0B,IAC1B6I,QAAgB,IAChBpC,WAAgE;QATlEvJ,YAAkC;QAClCA,aAA4C;QAC5CA,gBAAgE;QAChEA,kBAAqB;QACrBA,eAAmD;QACnDA,gBAA6C;QAM3C,MAAM4L,iCAAQ;QAGd,MAAMC,eAAe1L,OAAOsH,QAAQkE;QASpC,MAAMG,wBAAwBD,aAAaE,OACzC,EAAEjC,WAAWA,IAAIkC,WAAW,QAAQlC,IAAIkC,WAAW;QAErD,MAAMC,wCAAeH,sBAAsBC,OAAO,EAAEjC,SAClD8B,+BAAMM,KAAKpC,IAAI;QAGjB3J,OAAOgM,OAAOnM,MAAM;YAClB8C,MAAAA;YACAsJ,UAAUjM,OAAOkM,YAGfJ,sCAAaF,OACX/J,KAAK1C,gBAAgB0C,EAAE;YAI3B2J,OAAOxL,OAAOkM,YAGZJ,sCAAaF,OACX/J,MAAM1C,gBAAgB0C,EAAE;YAI5BuH,UAAUA,SAASxC;YACnBuF,SAASnM,OAAOkM,YAsBdd,cAAc,KACTM,aACAE,OAAO,EAAEjC,SAAS,KAAKoC,KAAKpC,IAAI,KAChClB,IAAI,EAAEkB,KAAKzJ,WAAW,EAErByJ,IACGyC,MAAM,GACN3N,cACAC,QAEH,EAACwB,QAAO0G,cAET8E,aACAE,OAAO,EAAEjC,SAASA,IAAIkC,WAAW,OACjCpD,IAAI,EAAEkB,KAAKzJ,WAAW,EAErByJ,IACGyC,MAAM,GACN3N,cACAC,QAEH,EAACwB,QAAO0G;YAMhByF,YAAYrM,OAAOkM,YACjBP,sBACGC,OAAO,EAAEjC,SAAS,KAAKoC,KAAKpC,IAAI,OAAOA,IAAI,GAAGkC,WAAW,MACzDpD,IAAI,EAAEkB,KAAKzJ,WAAW,EAErByJ,IACGyC,MAAM,GACN3N,cACAC,QAEHwB;;;;;AAYZpD,QAAQmD,eAAesL,WAAWhK,WAAWlD,OAAOmD,aAAa;IAC/DtB,OAAO;;;ACvIF,MAAMoM,kBAAkBjO,OAAO;;AAE/B,MAAMkO,sBAAsBlO,OAAO;;AAGnC,MAAMmO,mBAAmBnO,OAAO;;AAgBvC,SAASoO,oBAAoB9J;IAC3BtC,QAAQC,MAAMqC;IACd,MAAM1D,UAAU;;;SAcMyN,OACtBC,MAMA9J;IAEA,IAAInF,SAASiP,OAAO;QAClB,OAAO7J,eAAe6J;WACjB,WAAWA,SAAS,UAAU;QACnC,OAAO7J,eAAe6J;WACjB,IAAIA,gBAAgBvN,eAAe;QACxC,MAAMwN,WAAWD;QACjB,MAAMzJ,WAAWJ,eAAepC,OAAOkM;QACvC1J,SAASqJ,uBAAuBK;QAOhC7H,MAAM6H,UAAW5H;YACf,IAAIZ,YAAYC,UAAU;gBACxBpB,WAAWC,UAAUxC,OAAOsE;;;QAGhC,MAAMX,UAAUnB;QAChBmB,QAAQiI,mBAAmB,IAAI1N;QAC/ByF,QAAQiI,iBAAiB7G,IAAImH;QAC7B,OAAO1J;WACF,IAAIyJ,gBAAgBpB,cAAc,UAAUoB,MAAM;QACvD,OAAMhK,MAAEA,QAASgK;QACjB,IAAItI;QACJ,WAAW1B,SAAS,UAAU;YAC5B,IAAIA,SAAS,UAAU;gBAGrB,OAAOF;mBACF,IAAIE,SAAS,OAAO;gBAEzB0B,UAAU/B;mBACL,IAAIK,SAAS,QAAQ;gBAE1B0B,UAAUhB;mBACL,IAAI,OAAOV,QAAQA,SAAS,QAAQ;gBAEzC,OAAO+J,OAAOC,KAAKvD;mBAEd;gBACL/E,UAAUxB,YACNN,gBAAgBM,WAAWF,QAC3BD,oBAAoBC;;eAErB,WAAWA,QAAQ,YAAY;YAOpC,IAAI9E,SAAS8E,KAAK,kBAAkB;gBAClCgK,KAAKnB,QAAQ7K,KAAK6J,MAChB7J,KAAKC,UAAU;uBAAK+B,KAAK;uBAAoBgK,KAAKnB;;;YAItD,MAAMrC,YAAYxI,KAAK6J,MACrB7J,KAAKC,UAAU;mBACV+L,KAAKnB;mBACLxL,OAAOkM,YACRlM,OAAOsH,QAAQqF,KAAKV,UAAUxD,IAAI,EAAEkB,KAAKzJ;oBACvC,OAAO,EAACyJ,KAAKzJ,MAAMA;;;YAK3BmE,UAAU6E,mBACRvG,MACAwG,WACAwD,KAAKvD;eAGF;YACLqD,oBAAoBE;;QAGtBE,YAAYxI,SAASsI;QAOrB,IACEhK,SACC5E,WAAW4E,SAAS7E,SAAS6E,QAK9B;YAEA,KAAKA,KAAKlB,kBAAkB;gBAC1BqL,MACEH,KAAKvD,SAASX,IAAI5G;oBAChB,IAAIc,SAAS,OAAO;wBAGlB,OAAO+J,OAAO7K,GAAGW;2BACZ,IAAIG,SAAS,QAAQ;wBAC1B,OAAO+J,OAAO7K,GAAGuB;2BACZ,IAAIP,WAAW;wBACpB,OAAO6J,OAAO7K,GAAGgB;2BACZ;wBACL,OAAO6J,OAAO7K;;oBAIlBwC;;;QAIN,OAAOA;WACF,IAAInG,QAAQyO,OAAO;QACxB,OAAOA,KAAKlE,IAAIjL,KAAKkP,OAAOlP,IAAIoJ;WAC3B;QACL6F,oBAAoBE;;;;AAQxB,SAASE,YACPxI,SACAsI;IAEA,EAAEtI,SAASsI;QACT3M,OAAOsH,QAAQqF,KAAKN,YAAY9L,QAAQ,EAAEO,MAAMZ;YAC9C,IAAIY,QAAQuL,qBAAqBA,WAAWvL,UAAU,YAAY;gBAChEuL,WAAWvL,MAAMuD,SAASnE,OAAOyM;mBAC5B;gBACL,MAAM,IAAI5G,MAAM,wBAAwBjF;;;QAI5C,MAAMiM,aAAaC,4BAAc3I;QACjCrE,OAAOgM,OACLe,YAGAJ,KAAKnB;QAIPnH,QAAQmI,oBAAoBG;QAC5BA,KAAKtI,UAAUA;QAGfrE,OAAOsH,QAAQqF,KAAKV,UAAU1L,QAAQ,EAAEoJ,KAAKsD;YAC3CF,WAAWpD,OAAOsD,eAAe/M;YACjC6E,MAAMkI,gBAAiBjI;gBACrB,IAAIZ,YAAYC,UAAU;oBACxB0I,WAAWpD,OAAO3E,MAAM9E;;;;QAe9BF,OAAOsH,QAAQqF,KAAKR,SAAS5L,QAAQ,EAAEY,OAAO+L;YAC5Cf,QAAQ9H,SAASlD,OAAO+L;;MA1C5B,CA4CG7I,SAASsI;IAKZ,KAAI3M,OAAOmN,OAAOR,KAAKV,cAAcjM,OAAOmN,OAAOR,KAAKN,cACrDzF,OACAgF,OACC/J,KAAK1C,gBAAgB0C,IAItBtB,QAAQsB;QACP,KAAKwC,QAAQiI,kBAAkB;YAC7BjI,QAAQiI,mBAAmB,IAAI1N;;QAEjCyF,QAAQiI,iBAAiB7G,IAAI5D;;;;AC5OnC,MAAMuL,2BAA2B;;MAEpBC,mBAAmBxO;IAc9Bc,aAAa2N,eAAuBpN;QAClC,MAAMqN,WAAW5J,aAAa9D,MAAMyN;QAGpC,IAAIC,aAAarN,OAAO;YACtB2D,aAAahE,MAAMyN,eAAepN;YAElC,IAAI4F,WAAWjG,KAAKuN,4BAA4B;gBAC9CvN,KAAKuN,0BAA0BE,eAAeC,UAAUrN;;;;IAI9DP,gBAAgB2N;QACd,MAAMC,WAAW5J,aAAa9D,MAAMyN;QAEpC,IAAI,SAASC,UAAU;YAErBzJ,gBAAgBjE,MAAMyN;YACtB,IAAIxH,WAAWjG,KAAKuN,4BAA4B;gBAC9CvN,KAAKuN,0BAA0BE,eAAeC,UAAUnM;;;;;;SCpChDoM,aAAa3H;IAC3B,OAAO4H,QAAQC,UAAUC,KAAK,MAAM9H;;;uBCDIyE;IACxC,OAAO,IAAIxL,MAAMwL,QAAQ;QACvB3K;YACE,OAAO;;QAETA;YACE,OAAO;;QAETA;YACE,OAAO;;QAETA;YACE,OAAO;;;;;ACZb,SAASzB,UAAQV;IACb,OAAOS,MAAMC,QAAQV;;;AAEzB,MAAMV,YAAUC,OAAOD;;AACvB,gBAAQQ,2BAASL,kBAAc2Q,OAAEA,kBAAO5Q,aAASiD,gBAAEA,qBAAgB/C,iCAAKC,4CAA0BC,uBAAgBC,YAAKE,OAAGsQ,gBAAEA,kBAAmB/Q;;AAC/I,SAASe,WAASL;IACd,cAAcA,MAAM,YAAYA,MAAM;;;AAE1C,SAASO,aAAWP;IAChB,cAAcA,MAAM;;;AAExB,SAASsQ,mBAAmBxD,QAAQ9J,UAAUuN,YAAY,IAAIC,WAAW1D;IACrE,WAAW9J,aAAa,YAAY;QAChC,MAAMuF,MAAM;;IAEhB,IAAIhI,aAAWuM,WAAWzM,WAASyM,SAAS;QACxC,IAAI2D;QACJ,IAAI/P,UAAQoM,SAAS;YACjB2D,UAAU;eAET,IAAIlQ,aAAWuM,SAAS;YACzB2D,UAAU;eAET;YACDA,UAAU;;QAEdJ,eAAeI,SAAS;QACxB,OAAO,CAACA;YACJ,OAAO,IAAInP,MAAMmP,SAAS;gBACtBtO,eAAe8K,GAAGyD,GAAG1Q;oBACjB,OAAOyC,eAAeqK,QAAQ4D,GAAG1Q;;gBAErCmC,eAAe8K,GAAGyD;oBACd1N,SAASwN,UAAU,KAAID,WAAWG,KAAI9M,WAAWlE,MAAIoN,QAAQ4D;oBAC7D,OAAOjR,iBAAeqN,QAAQ4D;;gBAElCvO;oBACI,OAAOrC,UAAQgN;;gBAEnB3K,IAAI8K,GAAGyD;oBACH,OAAO7Q,MAAIiN,QAAQ4D;;gBAEvBvO;oBACI,OAAOvC,iBAAekN;;gBAE1B3K,eAAe8K,GAAG3I;oBACd,OAAO+L,eAAevD,QAAQxI;;gBAElCnC,UAAU8K,GAAG0D;oBACT,WAAW7D,WAAW,YAAY;wBAC9B,OAAOtN,YAAUsN,QAAQ6D;;;gBAGjCxO,MAAM8K,GAAG2D,SAASC;oBACd,WAAW/D,WAAW,YAAY;wBAC9B,OAAOsD,MAAMtD,QAAQ8D,SAASC;;;gBAGtC1O,yBAAyB8K,GAAGG;oBACxB,IAAI0D,aAAanR,2BAAyBmN,QAAQM;oBAClD,IAAI1M,UAAQoM,WAAWM,MAAM,UAAU;wBACnC,OAAO0D;2BAEN;wBACD,IAAIA,YAAY;4BACZA,WAAWnO,eAAe;4BAC1B,OAAOmO;+BAEN;4BACD;;;;gBAIZ3O,IAAI8K,GAAGG,GAAG9I;oBACN,WAAWtB,aAAa,YAAY;wBAChCA,SAASwN,UAAU,KAAID,WAAWnD,KAAI9I,GAAG5E,MAAIoN,QAAQM;;oBAEzD,OAAOrN,MAAI+M,QAAQM,GAAG9I;;gBAE1BnC,IAAI8K,GAAGG;oBACH,IAAI1K,QAAQhD,MAAIoN,QAAQM;oBACxB,IAAI7M,aAAWmC,UAAUrC,WAASqC,QAAQ;wBACtC,OAAO4N,mBAAmB5N,OAAOM,UAAU,KAAIuN,WAAWnD,KAAIN;2BAE7D;wBACD,OAAOpK;;;;UA1DhB,CA8DJ+N;WAEF;QACD,OAAO3D;;;;AAGf,SAASiE,iBAAiBjE,QAAQ9J;IAC9B,WAAWA,aAAa,YAAY;QAChC,MAAMuF,MAAM;;IAEhB,WAAWjH,UAAU,YAAY;QAC7B,MAAMiH,MAAM;;IAEhB,IAAIhI,aAAWuM,WAAWzM,WAASyM,SAAS;QACxC,OAAOwD,mBAAmBxD,QAAQ9J,UAAU,IAAI8J;WAE/C;QACD,OAAOA;;;;ACrFf,kBAAgB1K;IAEd,MAAMoF,QAAQwJ,cAAY5O;IAC1B4F,SAASR;IACT,OAAOA;;;AAGT,SAASwJ,cACP5O;IAEA,IAAIG,YAAYH,OAAO;QACrB,OAAO6O,oBACL,IAAI3P,MAAM,IAAIM,cAAcQ,OAAO;YACjCD;gBACE,OAAO;;YAETA;gBACE,OAAO;;YAETA,IAAI2K,QAAQX,KAAKzJ;gBAIf,IAAIyJ,QAAQ,WAAW5J,YAAYG,QAAQ;oBAEzC3C,IAAI+M,QAAQX,KAAKzJ;oBACjBoK,OAAO/K;oBAEP,OAAO;uBACF;oBACL,OAAO;;;YAGXI;gBACE,OAAO;;;WAIR,IACLR,gBAAgBS,OAEhB;QAEA,OAAO4O,cAAY5O,KAAKM;WACnB,IAAIrC,SAAS+B,OAAO;QACzB,OAAO,IAAId,MAAM,IAAIM,cAAcQ,OAAO;YACxCD;gBACE,OAAO;;YAETA,yBAAyB2K,QAAQX;gBAC/B,MAAMqB,UAAU9N,IAAIoN,QAAQ;gBAE5B,MAAMgE,aACJnR,yBAAyBmN,QAAQX,QACjCxM,yBAAyB6N,SAASrB;gBACpC,IAAI2E,YAAY;oBACdA,WAAWnO,eAAe;;gBAG5B,OAAOmO;;YAET3O,eAAe2K,QAAQX;gBACrB,MAAMqB,UAAU9N,IAAIoN,QAAQ;gBAC5B,IAAIjN,IAAI2N,SAASrB,MAAM;oBACrB1M,eAAe+N,SAASrB;oBACxBW,OAAO/K,gBAAgBmB,OAAOiJ;oBAC9B,OAAO;uBACF;oBACL,OAAO;;;YAGXhK,IAAI2K,QAAQX;gBACV,MAAMqB,UAAU9N,IAAIoN,QAAQ;gBAC5B,OAAOjN,IAAIiN,QAAQX,QAAQtM,IAAI2N,SAASrB;;YAE1ChK,IAAI2K,QAAQX;gBACV,MAAMzJ,QAAQhD,IAAIoN,QAAQ;gBAE1B,IACEX,QAAQ,YACPxL,WAAW+B,WAAW,WAAW/B,WAAW+B,WAAW,WACxD;oBACA,OAAOwO,iBAAYxR,IAAIoN,QAAQX,MAAM,CAACgF,SAASZ;wBAC7CzD,OAAO/K,gBAAgBwO,UAAU;;uBAE9B,IAAI1Q,IAAIiN,QAAQX,MAAM;oBAC3B,OAAOzM,IAAIoN,QAAQX;uBACd,IAAItM,IAAI6C,OAAOyJ,MAAM;oBAC1B,IAAIhL,MAAMuB,WAAWyJ,QAAQ,SAASA,QAAQ,WAAW;wBACvD,MAAMqB,UAAU9K;wBAChB,IAAIyJ,QAAQ,OAAO;4BACjB,OAAQlE;gCACN,KAAK7G,IAAI2C,UAAUlE,IAAIkB,KAAKyM,SAASvF,MAAM;oCACzC,MAAMmJ,cAAchQ,IAAI2C,UAAUoI,KAAKpL,KAAKyM,SAASvF;oCACrD6E,OAAO/K;oCACP,OAAOqP;;;+BAGN,IAAIjF,QAAQ,UAAU;4BAC3B,OAAQkF;gCACN,IAAIjQ,IAAI2C,UAAUlE,IAAIkB,KAAKyM,SAAS6D,OAAO;oCACzC,MAAMD,cAAchQ,IAAI2C,UAAUoI,KAAKpL,KAAKyM,SAAS6D;oCACrDvE,OAAO/K;oCACP,OAAOqP;;;;2BAIR;wBACL,OAAOF,iBAAYxR,IAAIgD,OAAOyJ,MAAM;4BAClCW,OAAO/K,gBAAgBmB,OAAOiJ;;;;;YAOtChK,QAAQ2K;gBACN,OAAOrM,MAAMwF,KACX,IAAI7E,IAAI,KAAItB,QAAQgN,YAAYhN,QAAQJ,IAAIoN,QAAQ;;YAGxD3K,IAAI2K,QAAQX,KAAKzJ;gBAIf,MAAM8K,UAAU9N,IAAIoN,QAAQ;gBAC5B,IAAIX,QAAQ,WAAW9L,SAASqC,QAAQ;oBAEtC3C,IAAI+M,QAAQX,KAAKzJ;oBACjBoK,OAAO/K;oBAGP,OAAO;uBACF,KAAKlC,IAAIiN,QAAQX,MAAM;oBAC5BpM,IAAIyN,SAASrB,KAAKzJ;oBAClBoK,OAAO/K,gBAAgBmB,OAAOiJ;uBAGzB,IAAIA,QAAQ,UAAU;oBAC3BpM,IAAIyN,SAASrB,KAAKzJ;oBAClBoK,OAAO/K,gBAAgBoK;uBAClB;oBACL,OAAO;;gBAET,OAAO;;YAEThK;gBACE,OAAO;;;WAGN;QACLU,QAAQC,MAAMV;QACd,MAAMX,UAAUC;;;;AC7KpB,IAAIyJ,IAAE,SAAS8B,GAAEqE,GAAEC,GAAElN;IAAG,KAAI,IAAIqM,IAAE,GAAEA,IAAEY,EAAEhH,QAAOoG,KAAI;QAAC,IAAIc,IAAEF,EAAEZ,IAAGe,IAAE,mBAAiBD,IAAED,EAAEC,KAAGA,GAAExR,IAAEsR,IAAIZ;QAAG,MAAI1Q,IAAEqE,EAAE,KAAGoN,IAAE,MAAIzR,IAAEqE,EAAE,KAAG7B,OAAOgM,OAAOnK,EAAE,MAAI,IAAGoN,KAAG,MAAIzR,KAAGqE,EAAE,KAAGA,EAAE,MAAI,IAAIiN,IAAIZ,MAAIe,IAAE,MAAIzR,IAAEqE,EAAE,GAAGiN,IAAIZ,OAAKe,IAAE,KAAGpN,EAAEX,KAAK1D,IAAEiN,EAAEmD,MAAM,MAAKjF,EAAE8B,GAAEwE,GAAEF,GAAE,EAAC,IAAG,WAAQE;;IAAG,OAAOpN;GAAG4I,IAAE,SAAS9B;IAAG,KAAI,IAAI8B,GAAEqE,GAAEC,IAAE,GAAElN,IAAE,IAAGqM,IAAE,IAAGc,IAAE,EAAC,KAAGC,IAAE,SAAStG;QAAG,MAAIoG,MAAIpG,MAAI9G,IAAEA,EAAErD,QAAQ,wBAAuB,QAAMwQ,EAAE9N,KAAKyH,KAAG9G,GAAE,KAAG,MAAIkN,MAAIpG,KAAG9G,MAAImN,EAAE9N,KAAKyH,KAAG9G,GAAE;QAAGkN,IAAE,KAAG,MAAIA,KAAG,UAAQlN,KAAG8G,IAAEqG,EAAE9N,KAAKyH,GAAE,KAAG,MAAIoG,KAAGlN,MAAI8G,IAAEqG,EAAE9N,MAAM,GAAE,GAAEW,KAAGkN,KAAG,OAAKlN,MAAI8G,KAAG,MAAIoG,OAAKC,EAAE9N,KAAKW,GAAEkN,GAAED;QAAGC,IAAE,IAAGpG,MAAIqG,EAAE9N,KAAKyH,GAAEoG,GAAED,IAAGC,IAAE,KAAIlN,IAAE;OAAIrE,IAAE,GAAEA,IAAEmL,EAAEb,QAAOtK,KAAI;QAACA,MAAI,MAAIuR,KAAGE,KAAIA,EAAEzR;QAAI,KAAI,IAAI0R,IAAE,GAAEA,IAAEvG,EAAEnL,GAAGsK,QAAOoH,KAAIzE,IAAE9B,EAAEnL,GAAG0R,IAAG,MAAIH,IAAE,QAAMtE,KAAGwE,KAAID,IAAE,EAACA;QAAGD,IAAE,KAAGlN,KAAG4I,IAAE,MAAIsE,IAAE,SAAOlN,KAAG,QAAM4I,KAAGsE,IAAE,GAAElN,IAAE,MAAIA,IAAE4I,IAAE5I,EAAE,KAAGqM,IAAEzD,MAAIyD,IAAEA,IAAE,KAAGrM,KAAG4I,IAAE,QAAMA,KAAG,QAAMA,IAAEyD,IAAEzD,IAAE,QAAMA,KAAGwE;QAAIF,IAAE,KAAGA,MAAI,QAAMtE,KAAGsE,IAAE,GAAED,IAAEjN,GAAEA,IAAE,MAAI,QAAM4I,MAAIsE,IAAE,KAAG,QAAMpG,EAAEnL,GAAG0R,IAAE,OAAKD;QAAI,MAAIF,MAAIC,IAAEA,EAAE,KAAID,IAAEC,IAAGA,IAAEA,EAAE,IAAI9N,KAAK6N,GAAE,IAAGA,IAAE,KAAG,QAAMtE,KAAG,SAAOA,KAAG,SAAOA,KAAG,SAAOA,KAAGwE;QAAIF,IAAE,KAAGlN,KAAG4I,IAAG,MAAIsE,KAAG,UAAQlN,MAAIkN,IAAE,GAAEC,IAAEA,EAAE;;IAAI,OAAOC,KAAID;GAAGF,IAAE,qBAAmBK,KAAIJ,IAAED,IAAE,IAAIK,MAAI,IAAGtN,IAAEiN,IAAE,SAASnG;IAAG,IAAImG,IAAEC,EAAE7R,IAAIyL;IAAG,OAAOmG,KAAGC,EAAExR,IAAIoL,GAAEmG,IAAErE,EAAE9B,KAAImG;IAAG,SAASnG;IAAG,KAAI,IAAImG,IAAE,IAAGjN,IAAE,GAAEA,IAAE8G,EAAEb,QAAOjG,KAAIiN,KAAGnG,EAAE9G,GAAGiG,SAAO,MAAIa,EAAE9G;IAAG,OAAOkN,EAAED,OAAKC,EAAED,KAAGrE,EAAE9B;;;AAAK,aAAwB8B;IAAG,IAAIqE,IAAEnG,EAAE9I,MAAKgC,EAAE4I,IAAG2E,WAAU;IAAI,OAAON,EAAEhH,SAAO,IAAEgH,IAAEA,EAAE;;;SCQjtClM,cACtBD,OAA0B,IAC1B6I,QAAa,OACVpC;IAMH,IAAIiG,iBAAiBvR,SAAS6E,SAAS5E,WAAW4E,QAAQA,OAAO;IACjE,MAAM2M,kBAAkBzR,SAAS2N,SAASA,QAAQ;IAClD,MAAM+D,qBAAqBnG,SAASxC,KAAK2C,UAAUd,IAAIjL,KAAGA,MAAI,IAAE,MAAIA,GAAGoO,OAAOpO,OAAKA;IACnF,IACEM,SAASuR,iBAET;QACAA,iBAAiBA,eAAe3Q,OAAOD;;IAGzC,IAGE,OAAO4Q,gBACP;QACA,OAAOE;;IAQT,OAAO,IAAIhE,WAAW8D,gBAAgBC,iBAAiBC;;;ACxClD,MAAMC,qBAAqB;;SASVC,UACtB9C,MAOAxK;IAEA,IAAIjE,QAAQyO,OAAO;QACjBA,OAAOA,KAAK/F,KAAK2C;;IAEnB,MAAMmG,KAAKvN;IACX,MAAMuN,cAAc7Q,cAAc;QAChCwB,QAAQC,MAAMoP;QACd,MAAMzQ,UAAU;;IAGlB,IACEyQ,OAAO/N,WAASgO,QAChBD,OAAO/N,WAAS2C,mBAChBoL,OAAO/N,WAASiO,MAChB;QACA,MAAM7J,MAAM;;IAmBd,MAAM8J,YAAYlJ,QAAQgG;IAC1B,IAAImD,YAAYnD,OAAO;QAErBG,MAAMJ,OAAOmD,YAAY1N;WACpB,IAAIwK,gBAAgBoD,QAAQC,YAAYrD,OAAO;QACpDG,MAAM+C,WAAW1N;WACZ;QACL9B,QAAQC,MAAMqM;QACd,MAAM1N,UAAUuQ;;IAIlB,OAAOrN;;;AAET,SAAS6N,YAAYC;IACnB,OAAO/R,QAAQ+R,WAAWA,MAAMxH,IAAI5G,KAAKA,aAAakO,MAAMG,SAAS;;;ACzDvE,SAASvL,QAAQwL;IACf,OAAOC,IAAI7R,KAAK0Q,kBAAMkB;;;SAIRL,YACdhO;IAOA,IAAIpE,SAASoE,IAAI;QACf,OAAO;;IAET,IAAIuO,OAAO;IACX,IAAInS,QAAQ4D,IAAI;QACduO,OAAOvO,EACJ2G,IAAKrG;YACJ,OAAO0N,YAAY1N;WAGpB8N,SAAS,SACR,QACA;QACJ,OAAOG;WACF,IACL/E,aAAaxJ,IAEb;QACA,IAAIgO,YAAYhO,EAAEsH,WAAW;YAC3B,OAAO;;WAEJ,IACLjK,gBAAgB2C,IAEhB;QACA,OAAO;WACF;QACL,IAAIhE,SAASgE,IAAI;YACf,OAAO;;;IAGX,OAAOuO;;;AAET,SAASC,yBAAyBC;IAChC,MAAM5D,OAAOhI,QAAQ4L;IACrB,IAAIT,YAAYnD,OAAO;QACrB,OAAOA;WACF;QACLtM,QAAQC,MAAMqM;QACd,MAAM,IAAI1N,UAAUuQ;;;;AC7DxB,SAASgB,cAAcC;IACrB,OAAOC,IAAIC,gBAAgB,IAAIC,KAAK,EAACH,UAAS;QAAE9N,MAAM;;;;SCOxCkO,eAAerT;IAC7B,OAAOW,WAAWX,OAAO;;;SAEXsT,gBAAgBtT;IAC9B,OAAOW,WAAWX,OAAO;;;SAGXuT,aAAalM;IAC3B,MAAMmM,eAAetE,OAAO9J,cAAc,SAASxB,WAAWyD;IAI9D,MAAMoM,gBAAgBlN;IACtB7B,YAAY+O,cAAcC,mBAAmBF;IAE7C,OAAO/S,MAAMwF,KAAKuN,aAAaG,MAAMC;;;SAGvBC,eAAe7T;IAC7B,OAAOW,WAAWX,OAAO;;;SAGX8T,kBAAkBC,cAA4BC;IAG5D,MAAMC,eAAeF,aAAaE;IAElC,MAAMC,gBAAgBD,aAAaE,MAAM;IACzCJ,aAAaE,eAAeC,cACzBjJ,IAAIgJ;QACH,IAAIG,iBAAiBJ,SAAS,MAAMC;QAEpC,IAAIA,aAAa5F,WAAW,MAAM;YAChC+F,iBACEA,iBAAiB,MAAMH,aAAajT,QAAQ,KAAKgT;;QAErD,OAAOI;OAER3I,KAAK;IAsBR,OAAOsI;;;SAGOM,eACdC,eACAN;IAEA,OAAOM,cACJrJ,IAAKsJ;QACJ,IAAIV,eAAeU,UAAU;YAC3B,OAAOT,kBAAkBS,SAASP;eAC7B,IAAIX,eAAekB,UAAU;YAClCF,eAAe5T,MAAMwF,KAAKsO,QAAQX,WAAWI;YAC7C,OAAOO;eACF,IAAIjB,gBAAgBiB,UAAU;YAEnCC,cAAcR,QAAQpQ,WAAW2Q,QAAQE;YACzC;eACK;YACL,OAAOF;;OAGVnG,OAAOsG;;;AAGZ,MAAMC,uBAAuD;;AAC7D,SACgBH,cACd7G,SACAiH,SACAC;IAEAlH,UAAUA,QAAQ1M;IAClB,KAAK0T,qBAAqBhH,UAAU;QAClCgH,qBAAqBhH,WAAW,IAAIvM;;IAEtC,IAAIwT,SAAS;QACXD,qBAAqBhH,SAAS1F,IAAI+K,cAAc4B;WAC3C,IAAIC,SAAS;QAClBF,qBAAqBhH,SAAS1F,IAAI4M;;;;SAGtBC,kBAAkBC;IAChC,OAAOA,SAAS9J,IAAI+J,KAAKA,EAAEC,SAASxJ,KAAK;;;SAG3ByJ,qBAAqBC;IACnC,OAAOjG,OAAO9J,cAAc,QAAQ;QAAEqP,MAAMU;QAAKC,KAAK;;;;SAExCC,iBAAiBhO,MAAc2M;IAC7C,MAAMsB,MAAMjO;IACZ,MAAMkO,WAAWhC,aAAa+B;IAC9B,MAAME,WAAWnB,eAAekB,UAAUvB,QAAQ5F,OAAOsG;IAEzD,MAAMe,aAAaX,kBAAkBU;IAErC,OAAOC;;;SAEOC,kBAAkBrO,MAAc2M;IAC9C,MAAMsB,MAAMjO;IACZ,MAAMoO,aAAaJ,iBAAiBC,KAAKtB;IAGzCQ,cAAcR,QAAQyB;;;SAGRE,cACdC,kBACAjR;IAEA,OAAO,IAAIsL,QAAQ4F;QACjB,MAAMC,eAAe;YACnBF,iBAAiBG,SAASH,iBAAiBI,UAAUpS;YACrDiS;;QAGFD,iBAAiBG,SAASD;QAC1BF,iBAAiBI,UAAUF;QAC3BpR,YAAYC,WAAWiR;;;;SAIXK,iBACdjC,QACAkC;IAEA,OAAOjG,QAAQkG,IACb,KAAIxB,qBAAqBX,UAAS/I,IAAImL,YACpCT,cAAcT,qBAAqBkB,WAAWF;;;AC7J7C,MAAMG,mBAAmBxV,OAAO;;AAOvC,MAAMyV,mBAAmBzV,OAAO;;AAChC,MAAM0V,gBAAgB1V,OAAO;;AAC7B,MAAM2V,aAAa3V,OAAO;;AAC1B,MAAM4V,gBAAgB5V,OAAO;;AAC7B,MAAM6V,kBAAkB7V,OAAO;;SA2Cf8V,gBAAgBC;;IAC9B,IAAIrW,WAAWqW,UAAU;QACvB,MAAMC,eAAenX,IAAIkX,SAAS;QAClC,MAAMtB,MAAM5V,IAAIkX,SAAS;QACzB,YAAO,MAAME,kBAAkBjH;YAa7B1N,YACEwJ,YAAoB,IACpBC,WAAkB;gBAElBmL;gBAbF1U,WAAgB;gBAMhBA,WAA8D;gBAS5D,MAAMiT,MAAM5V,IAAI2C,KAAKuI,aAAa;gBAElC,IAAI0K,KAAK;oBACP,MAAMtB,SAAS3R,KAAKqL,QAAQzM;oBAC5B,KAAK0T,qBAAqBX,SAAS;wBACjC0B,kBAAkBJ,KAAKtB;;;gBAW3B,MAAM6C,eAAenX,IAAI2C,KAAKuI,aAAa;gBAE3C,MAAMoM,QAAQ1K,4BAA4BjK;gBAE1C,IAAIhC,SAASwW,eAAe;oBAC1BrU,OAAOgM,OAAOwI,OAAOH;;gBAGvB,IAAIxW,SAASsL,YAAY;oBACvBnJ,OAAOgM,OAAOwI,OAAOrL;;gBAKvB/C;gBACA,MAAMoF,QAAQgJ;gBACd,MAAMC,kBAAkBzU,OAAOkM,YAC7BlM,OAAOsH,QAAQkE,OAAO/C,IAAI,EAAEkB,KAAKzJ,WAAW,EAACyJ,KAAK6E,YAAYtO;gBAEhEL,KAAKiU,oBAAoBY,cAAcD;gBAGvC,MAAME,eAAeD,cACnB1U,OAAOkM,YACLlM,OAAOsH,QAAQmN,iBAAiBhM,IAAI,EAAEkB,KAAKzJ,WAAW,EACpDyJ,KACA+K,cAAcxU;gBAKpB,IAAI0U;gBAMJ;oBACEA,qBAAqBR,QAAQ7V,KAC3B6C,WAGAuT,cACAvL;kBAEF,OAAO9I;oBACPgG;oBACA,MAAMhG;;gBAGR,IAAIpC,QAAQ0W,qBAAqB;oBAC/BA,qBAAqBA,mBAClBhO,KAAK2C,UACLqC,OAAOsG;;gBAEZ,IAAIpC,YAAY8E,qBAAqB;oBACnC,MAAMC,iBAEyBlO,QAC7BiO;oBAGF/U,KAAKmU,cAAca,eAAejO,KAAK2C,UAAUqC,OAAOsG;oBACxDrS,KAAKoU,iBAAiBvO;oBACtB7F,KAAKqU,mBAAmBvO;oBACxB9F,KAAKgU,oBAAoBtO;oBACzBe;uBACK;oBACLA;oBACAjG,QAAQC,MAAMsU;oBACd,MAAM7O,MAAMyJ;;;YAOhB7P;gBACE,KAAKE,KAAKkU,gBAAgB;oBACxBlU,KAAKkU,iBAAiBrH,OAAO7M,KAAKmU,aAAapN,KAAK2C;;gBAEtD,KAAK1J,KAAK6B,cAAc;oBACtB7B,KAAK6B,eAAe;oBAIpB,MAAMoR,MAAM5V,IAAI2C,KAAKuI,aAAa;oBAClC,MAAMoJ,SAAS3R,KAAKqL,QAAQzM;oBAC5B,IAAIqU,OAAOX,qBAAqBX,SAAS;wBAGvC5P,WAAW/B,MAAM;wBAuBjB4T,iBAAiBjC,QAAQ3R,MAAM8N,KAAK;4BAGlCb,MAAMjN,KAAKkU,gBAAgBlU,MAAM;;2BAE9B;wBAELiN,MAAMjN,KAAKkU,gBAAgBlU;;;gBAI/BA,KAAKoU,eAAe1T,QAAQ2O;oBAC1B1B,aAAa0B;;gBAEf4F,UAAUjV;;YAEZF;gBACEE,KAAKqU,iBAAiB3T,QAAQ2O;oBAC5B1B,aAAa0B;;gBAEf6F,YAAYlV;;YAEdF,yBACEmB;gBAGA,IAAIjB,KAAKiU,kBAAkBhT,OAAO;oBAEhCjB,KAAKiU,kBAAkBhT,MAAMZ,QAAQ4J,4BACnCjK,MACAiB;;;gBAjLEW,sBAEPC,kBAMAoS,kBARMkB,SAAoB;QACpBA,SAAMlX,SAASgV,QAAQA,MAAMA,MAAM1R,WAInC4T,kBAAenX,SAASwW,gBAC3B1T,KAAK6J,MAAM7J,KAAKC,UAAUyT,iBAC1BjT;;WA+KD;QACLf,QAAQC,MAAM8T;QACd,MAAMnV,UAAUgG;;;;SCxOJ6P,UAAU1S;IACxB,IAAIlE,QAAQkE,MAAM;QAChBA,IAAI7B,QAAQsB;YACViT,UAAUjT;;WAEP,IAAIO,eAAe2N,MAAM;QAC9B,IAAI3N,IAAIyE,uBAAuB;YAC7BI,eAAe7E;;QAGjB,IAAIA,IAAIkK,kBAAkB;YACxBlK,IAAIkK,iBAAiB/L,QAASyE;gBAC5B0B,QAAQ1B;;YAGV,IAAI5C,IAAIyR,mBAAmB;gBACzBzR,IAAIyR,kBAAkBtT,QAASyE;oBAC7B0B,QAAQ1B;;;;QAKd8P,UAAUtR,eAAepB;;;;SAKb2S,YAAY3S;IAC1B,IAAIlE,QAAQkE,MAAM;QAChBA,IAAI7B,QAAQsB;YACVkT,YAAYlT;;WAET,IAAIO,eAAe2N,MAAM;QAC9B,IAAI3N,IAAIyE,uBAAuB;YAC7BG,gBAAgB5E;;QAWlB,IAAIA,IAAIyR,mBAAmB;YACzBzR,IAAIyR,kBAAkBtT,QAASyE;gBAC7ByB,QAAQzB;;;QAGZ+P,YAAYvR,eAAepB;;;;AC3DxB,MAAMoE,wBAAwB;;AAQrC,MAAMyO,iBAAiB5W,OAAO;;AAC9B,MAAM6W,kBAAkB7W,OAAO;;AAC/B,MAAM8W,gBAAgB9W,OAAO;;AAC7B,MAAM+W,iBAAiB/W,OAAO;;AAC9B,MAAMgX,aAAajX,UAAU;;AAC7B,MAAMkX,cAAclX,UAAU;;kBAU5BmX,UACAC,QAKAC;;IAMA,MAAMtW,gBAAgBoW,aAAa5X,UAAU4X,YAAY;QACvD,MAAMtW,UAAUuH;;IAElB,EAACgP,QAAQC,UAASlV,QAAQ/C;QACxB,MAAMI,YAAYJ,MAAMsS,YAAYtS,KAAK;YACvC,MAAM,IAAIyB,UAAUuQ;;;IAGxB,MAAMnH,UAAU;QAAEqN,MAAMF;QAAQG,OAAOF;;IACvC,MAAMG,kBAAkBvI;QAGtB1N;YACE4U;YAFF1U,WAAgB;YAId,MAAMgW,cAAc3Y,IAAImL,SAAS;YACjC,MAAMyN,eAAe5Y,IAAImL,SAAS;YAClCxI,KAAKoV,kBAAkBjX,QAAQ6X,eAC3BA,YAAYjK,OAAOsG,WACnB,EAAC2D,cAAajK,OAAOsG;YACzBrS,KAAKqV,mBAAmBlX,QAAQ8X,gBAC5BA,aAAalK,OAAOsG,WACpB,EAAC4D,eAAclK,OAAOsG;;QAQ5BvS,OApBQ8B,sBACPC,aAmBA4T;YACCtT,WAAWnC,MAAM;YACjB,IAAIA,KAAKqV,kBAAkB;gBACzB,KAAKrV,KAAKuV,iBAAiB;oBAEzBvV,KAAKuV,kBAAkB1I,OAAO7M,KAAKqV;;gBAIrC,MAAMa,iBAAiBlW,KAAKuV;gBAC5B3F,UAAUsG,gBAAgBlW;gBAC1BkW,eAAexV,QAAQsB,KAAKiT,UAAUjT;gBACtC,IAAIhC,KAAKsV,gBAAgB;oBACvBtV,KAAKsV,eAAe5U,QAAQsB,KAAKkT,YAAYlT;;;;QAInDlC,CAAC0V;YACCrT,WAAWnC,MAAM;YACjB,IAAIA,KAAKoV,iBAAiB;gBACxB,KAAKpV,KAAKsV,gBAAgB;oBACxBtV,KAAKsV,iBAAiBzI,OAAO7M,KAAKoV;;gBAKpC,MAAMc,iBAAiBlW,KAAKsV;gBAC5B1F,UAAUsG,gBAAgBlW;gBAC1BkW,eAAexV,QAAQsB,KAAKiT,UAAUjT;gBACtC,IAAIhC,KAAKuV,iBAAiB;oBACxBvV,KAAKuV,gBAAgB7U,QAAQsB,KAAKkT,YAAYlT;;;;QAIpDlC;YACE,KAAKE,KAAK6B,cAAc;gBAEtB7B,KAAK6B,eAAe;gBAEpB,MAAM8S,QAAQxH,4BAAcnN;gBAE5B,IAAI,SAAS2U,MAAM,UAAU;oBAC3B3U,KAAKwV;;gBAEP,IAAI,UAAUb,MAAM,UAAU;oBAC5B3U,KAAKyV;;;YAITR,UAAUjV;;QAGZF;YACEoV,YAAYlV;;QAGdF,yBACEmB;YAEA,IAAIjB,KAAK6B,cAAc;gBAErB,IAAIZ,SAAS,SAAS;oBACpB,MAAM0T,QAAQxH,4BAAcnN;oBAE5B,IAAI,SAAS2U,MAAM,UAAU;wBAC3B3U,KAAKwV;;oBAGP,IAAI,UAAUb,MAAM,UAAU;wBAC5B3U,KAAKyV;;;;;;IAzFNM,gBAAoB;IAmG7B,MAAMjJ,OAAO,IAAIpB,WAAWqK,WAAW;QAAE1V,OAAOqV;;IAChD,OAAO5I;;;AChIT,uBAAQ1M,oBAAmBD;;AAC3B,eAAe,CACbgF,OACAxE;IAEA,OAEKtC,QAAQ8G,UAAU7F,gBAAgB6F,WAEnCc,WAAWtF,YAEb;QACAH,QAAQC,MAAM0E;QACd3E,QAAQC,MAAME;QACd,MAAMvB,UAAUuH,wBAAwBvB;;IAE1C,IAAI+Q;IAEJA,cAAcrP,QAAQ3B;IAYtB,MAAMiR,SAASC,cAAcF,aAAaxV;IAC1CgF,SAASyQ;IACT,OAAOA;;;AAKT,SAASC,cACPlR,OACAxE;IAEA,MAAM2V,gBAAgB,IAAI/W;IAC1B,MAAMgX,SAAS;QACb,MAAMlW,QAAQM,SAASjC,KAAK6C,cAAc4D,MAAMyD,IAAI4N,MAAMA,GAAGnW;QAC7D,OAAOf,gBAAgBe,SAASA,MAAMA,QAAQA;;IAEhDD,iBAAekW,eAAe,SAAS;QACrCjZ,KAAKkZ;QACLjW,cAAc;;IAEhB,IAAImW,YAAYF;IAChBpR,MAAMzE,QAAQyE;QACZD,MAAMC,OAAO;YACX,IAAIuR,WAAWH;YACf,IAAIG,aAAaD,WAAW;gBAC1BH,cAAc5W;gBAEd+W,YAAYC;;;;IAMlB,OAAO9H,oBAAoBiG,cAAcyB;;;AAE3C,MAAMK,YAAY;;SAEF/H,oBAAoBjR;IAGlC,MAAM8M,SAAS9M;IACf,OAAO,IAAIsB,MAAMwL,QAAQ;QACvB3K,QAAQ2K;YACN,IAAIU,UAAU9N,IAAIoN,QAAQ;YAC1B,MAAMmM,aAAa5Y,SAASmN,WAAWA,UAAUA,QAAQwL;YAEzD,OAAOvY,MAAMwF,KAAK,IAAI7E,IAAI,KAAItB,QAAQgN,YAAYhN,QAAQmZ;;QAM5D9W,IAAI2K,QAAQX;YACV,MAAMqB,UAAU9N,IAAIoN,QAAQ;YAC5B,MAAMmM,aAAa5Y,SAASmN,WAAWA,UAAUA,QAAQwL;YACzD,OAAOnZ,IAAIiN,QAAQX,QAAQtM,IAAIoZ,YAAY9M;;QAE7ChK,IAAI2K,QAAQX;YACV,MAAMqB,UAAU9N,IAAIoN,QAAQ;YAC5B,MAAMmM,aAAa5Y,SAASmN,WAAWA,UAAUA,QAAQwL;YAEzD,IAAInZ,IAAIiN,QAAQX,MAAM;gBACpB,OAAOzM,IAAIoN,QAAQX;mBACd,IAAItM,IAAIoZ,YAAY9M,MAAM;gBAC/B,OAAOzM,IAAIuZ,YAAY9M;;;;;;SClHP+M,UAAU9W;IAChC,OAAO;QAAEM,OAAON;;;;SCKM+W,iBAAiBtO;IAGvCrI,OAAOsH,QAAQe,SAAS9H,QAAQ,EAAEoJ,KAAKzJ;QACrC,WAAWA,UAAU,YAAY;YAC/B,MAAMjB,UAAUgG;eACX;YACLoH,WAAW1C,OAAOzJ;;;;;ACLxBmM,iBAAW;IACT1M,MAAM0E,SAAcnE,OAAsByM;QACxC,IACExN,gBAAgBe,WAGfyM,KAAKhK,SAAS,WAAWgK,KAAKhK,SAAS,aACxC;YACAgK,KAAKV,SAAS,WAAW/L;YACzB,EAAC,UAAU,UAASK,QAAQM;gBAC1B,MAAM+V,SAASjK,KAAKR,QAAQtL;gBAE5B,MAAMgW,cAAc,EAACD,SAAQhQ,KAAK2C;gBAGlCzM,QAAQS,IACNoP,KAAKR,SACLtL,WACD,KAAKgW,aAEChV;oBACC,OAAQ3B,MAAMA,QAAQ2B,EAAEyI,OAAOpK;oBAIlC0L,OAAOsG;;eAGT;YACL7R,QAAQC,MAAMJ;YACdG,QAAQC,MAAMqM;YACd,MAAM1N,UAAUuH,wBAAwBgJ;;;;;AAI9CnD,iBAAW;IACT1M,QAAQ0E,SAAcnE,OAAsByM;QAC1C,IACExN,gBAAgBe,UAGfyM,KAAKhK,SAAS,SACf;YACAgK,KAAKV,SAAS,aAAa/L;YAC3B,EAAC,UAAU,UAASK,QAAQM;gBAC1B,MAAM+V,SAASjK,KAAKR,QAAQtL;gBAE5B,MAAMgW,cAAc,EAACD,SAAQhQ,KAAK2C;gBAGlCzM,QAAQS,IACNoP,KAAKR,SACLtL,WACD,KAAKgW,aAEChV;oBACC,OAAQ3B,MAAMA,QAAQ2B,EAAEyI,OAAOwM;oBAIlClL,OAAOsG;;eAGT;YACL7R,QAAQC,MAAMJ;YACdG,QAAQC,MAAMqM;YACd,MAAM1N,UAAUuH,wBAAwBgJ;;;;;MC1CjCuH,WAAW;;"}