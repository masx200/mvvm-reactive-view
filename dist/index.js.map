{"version":3,"file":"index.js","sources":["../src/reflect.ts","../src/util.ts","../src/context-mounted-unmounted-.ts","../src/readysymbol.ts","../src/dom.ts","../src/isprimitive.ts","../src/primitivestate.ts","../src/directives.ts","../node_modules/dom-element-attribute-agent-proxy/dist/index.js","../src/attrchange.ts","../src/virtualdom.ts","../src/onevent.ts","../src/elementonmountandunmount.ts","../node_modules/htm/dist/htm.module.js","../src/createelement.ts","../src/html.ts","../src/mount.ts","../src/createApp.ts","../src/conditon.ts","../src/watch.ts","../src/CustomElementRegistry.ts","../src/customelement.ts","../src/rendervdomtoreal.ts","../src/readonlyproxy.ts","../node_modules/deep-observe-agent-proxy/dist/index.js","../src/createstate.ts","../src/createComponent.ts","../src/assetbrowser.ts","../src/extend-directive.ts","../src/input-textarea-value-directive-Bidirectional-binding.ts","../src/createref.ts","../src/index.ts"],"sourcesContent":["const Reflect = window.Reflect;\r\nexport default Reflect;\r\n\r\nexport const {\r\n  //   apply,\r\n  construct,\r\n  //   defineProperty,\r\n  deleteProperty,\r\n  get,\r\n  getOwnPropertyDescriptor,\r\n  getPrototypeOf,\r\n  has,\r\n\r\n  //   isExtensible,\r\n  ownKeys,\r\n  //   preventExtensions,\r\n  set\r\n  //   setPrototypeOf\r\n} = Reflect;\r\nexport {};\r\n/*\r\napply()\r\n对一个函数进行调用操作，同时可以传入一个数组作为调用参数。和 Function.prototype.apply() 功能类似。\r\nconstruct()\r\n对构造函数进行 new 操作，相当于执行 new target(...args)。\r\ndefineProperty()\r\n和 Object.defineProperty() 类似。\r\ndeleteProperty()\r\n作为函数的delete操作符，相当于执行 delete target[name]。\r\n//Reflect.enumerate()\r\n该方法会返回一个包含有目标对象身上所有可枚举的自身字符串属性以及继承字符串属性的迭代器，for...in 操作遍历到的正是这些属性。\r\nget()\r\n获取对象身上某个属性的值，类似于 target[name]。\r\ngetOwnPropertyDescriptor()\r\n类似于 Object.getOwnPropertyDescriptor()。\r\ngetPrototypeOf()\r\n类似于 Object.getPrototypeOf()。\r\nhas()\r\n判断一个对象是否存在某个属性，和 in 运算符 的功能完全相同。\r\nisExtensible()\r\n类似于 Object.isExtensible().\r\nownKeys()\r\n返回一个包含所有自身属性（不包含继承属性）的数组。(类似于 Object.keys(), 但不会受enumerable影响).\r\npreventExtensions()\r\n类似于 Object.preventExtensions()。返回一个Boolean。\r\nset()\r\n将值分配给属性的函数。返回一个Boolean，如果更新成功，则返回true。\r\nsetPrototypeOf()\r\n类似于 Object.setPrototypeOf()。\r\n*/\r\n","import { has, get } from \"./reflect\";\r\nimport { isFunction } from \"./util\";\r\n/* eslint-disable @typescript-eslint/explicit-function-return-type */\r\nexport function isundefined(a: any) {\r\n  return typeof a === \"undefined\";\r\n}\r\n\r\nexport function isnumber(a: any) {\r\n  return typeof a === \"number\";\r\n}\r\nexport function isboolean(a: any) {\r\n  return typeof a === \"boolean\";\r\n}\r\nexport function isobject(a: any): a is object {\r\n  return typeof a === \"object\" && a !== null;\r\n}\r\n// export function isstring(a: string): true;\r\n// export function isstring(a): boolean;\r\nexport function isstring(a: any): a is string {\r\n  return typeof a === \"string\";\r\n}\r\nexport function isfunction(a: any): a is Function {\r\n  return typeof a === \"function\";\r\n}\r\n\r\nexport function isarray(a: any): a is Array<any> {\r\n  return a instanceof Array && Array.isArray(a) && gettagtype(a) === \"array\";\r\n}\r\nexport { isfunction as isFunction, isarray as isArray, isstring as isString };\r\nexport function getsymbol(a: string) {\r\n  return Symbol(a);\r\n}\r\nexport function gettagtype(a: any): string {\r\n  return {}.toString\r\n    .call(a)\r\n    .replace(\"[object \", \"\")\r\n    .replace(\"]\", \"\")\r\n    .toLowerCase();\r\n}\r\nexport function ispromise(a: any): a is Promise<any> {\r\n  return (\r\n    gettagtype(a) === \"promise\" && isFunction(get(a, \"then\")) && has(a, \"catch\")\r\n  );\r\n}\r\nexport function isSet(a: any): a is Set<any> {\r\n  return gettagtype(a) === \"set\" && a instanceof Set;\r\n}\r\n","import { isFunction } from \"./util\";\r\nexport const invalid_Function = \"invalid Function\";\r\nconst message = \"invalid useMounted or useUnMounted out of createComponent\";\r\nlet ctxopen = false;\r\nlet Mounted = [];\r\nlet UnMounted = [];\r\nexport function getMounted() {\r\n  return [...Mounted];\r\n}\r\nexport function getUnMounted() {\r\n  return [...UnMounted];\r\n}\r\nexport function useMounted(fun: Function) {\r\n  if (isFunction(fun)) {\r\n    if (ctxopen) {\r\n      Mounted.push(fun);\r\n    } else {\r\n      throw Error(message);\r\n    }\r\n  } else {\r\n    throw TypeError(invalid_Function);\r\n  }\r\n}\r\n\r\nexport function useUnMounted(fun: Function) {\r\n  if (isFunction(fun)) {\r\n    if (ctxopen) {\r\n      UnMounted.push(fun);\r\n    } else {\r\n      throw Error(message);\r\n    }\r\n  } else {\r\n    throw TypeError(invalid_Function);\r\n  }\r\n}\r\nexport function clearMounted() {\r\n  Mounted = [];\r\n}\r\nexport function clearUnMounted() {\r\n  UnMounted = [];\r\n}\r\nexport function openctx() {\r\n  ctxopen = true;\r\n  clearMounted();\r\n  clearUnMounted();\r\n}\r\nexport function closectx() {\r\n  ctxopen = false;\r\n  clearMounted();\r\n  clearUnMounted();\r\n}\r\n","export const readysymbol = Symbol(\"ready\");\r\n","const document = window.document;\r\n//import { seteletext, setelehtml } from \"./directives\";\r\n//export { seteletext, setelehtml };\r\n\r\nexport function seteletext(e: Element, v: string) {\r\n  e.textContent = v;\r\n}\r\nexport function setelehtml(e: Element, v: string) {\r\n  e.innerHTML = v;\r\n}\r\nexport function appendchild(\r\n  container: HTMLElement | SVGSVGElement | SVGElement | Element,\r\n  ele: HTMLElement | SVGElement | Element\r\n) {\r\n  container.appendChild(ele);\r\n}\r\nexport function createsvgelement() {\r\n  return createElementNS(svgnamespace, \"svg\");\r\n}\r\nexport function createnonescript() {\r\n  return document.createDocumentFragment();\r\n}\r\nexport function createnativeelement(type: string) {\r\n  return document.createElement(type);\r\n}\r\nexport function createElementNS(namespace: string, name: string) {\r\n  return document.createElementNS(namespace, name);\r\n}\r\nexport function createtextnode(data: string) {\r\n  return document.createTextNode(data);\r\n}\r\nexport const svgnamespace = \"http://www.w3.org/2000/svg\";\r\nexport function changetext(textnode: Text, value: string) {\r\n  textnode.nodeValue = String(value);\r\n}\r\nexport default document;\r\n\r\nexport const mathnamespace = \"http://www.w3.org/1998/Math/MathML\";\r\n\r\nexport function createmathelement() {\r\n  return createElementNS(mathnamespace, \"math\");\r\n}\r\nexport function createComment() {\r\n  return document.createComment(\"\");\r\n}\r\nexport function removeNode(node: Element) {\r\n  let parentNode = node.parentNode;\r\n  if (parentNode) {\r\n    parentNode.removeChild(node);\r\n  }\r\n}\r\nexport function replaceChild(newChild: Node, oldChild: Node) {\r\n  let parentNode = oldChild.parentNode;\r\n  if (parentNode) {\r\n    parentNode.replaceChild(newChild, oldChild);\r\n  }\r\n}\r\n\r\nexport function domaddlisten(\r\n  ele: Element | Node,\r\n  event: string,\r\n  call: EventListener\r\n) {\r\n  ele.addEventListener(event, call);\r\n}\r\n\r\nexport function domremovelisten(\r\n  ele: Element | Node,\r\n  event: string,\r\n  call: EventListener\r\n) {\r\n  ele.removeEventListener(event, call);\r\n}\r\nexport function getdomchildren(ele: Element | Node) {\r\n  return Array.from(ele.childNodes);\r\n}\r\nexport function getAttribute(ele: Element, name: string) {\r\n  return HTMLElementprototype.getAttribute.call(ele, name);\r\n}\r\nexport function setAttribute(ele: Element, name: string, value: any) {\r\n  HTMLElementprototype.setAttribute.call(ele, name, value);\r\n}\r\nexport function removeAttribute(ele: Element, name: string) {\r\n  HTMLElementprototype.removeAttribute.call(ele, name);\r\n}\r\nconst HTMLElementprototype = HTMLElement.prototype;\r\n","import { isString, isnumber, isboolean, isundefined } from \"./util\";\r\nexport default function(a: any) {\r\n  return isString(a) || isnumber(a) || isboolean(a) || isundefined(a);\r\n}\r\n","export function isReactiveState(a: any): a is ReactiveState {\r\n  return a instanceof ReactiveState;\r\n}\r\n// import Reflect from \"./reflect\";\r\nimport { getsymbol, isobject, isSet } from \"./util\";\r\nexport const textnodesymbol = Symbol(\"textnode\");\r\nexport const changetextnodesymbol = Symbol(\"changetextnode\");\r\nimport isprimitive from \"./isprimitive\";\r\nexport const eventtargetsymbol = Symbol(\"eventtatget\");\r\nexport const memlisteners = Symbol(\"memlisteners\");\r\nexport const dispatchsymbol = getsymbol(\"dispatch\");\r\nexport const subscribesymbol = getsymbol(\"subscribe\");\r\nexport const removeallistenerssymbol = getsymbol(\"removeallisteners\");\r\nexport const addallistenerssymbol = getsymbol(\"addallisteners\");\r\n/* const forkarryaprototype = {};\r\nownKeys(Array.prototype).forEach(key => {\r\n  forkarryaprototype[key] = Array.prototype[key];\r\n}); */\r\n/* class forkarray {}\r\nObject.assign(forkarray.prototype, forkarryaprototype);\r\nforkarray.prototype.constructor = forkarray;\r\ndeleteProperty(forkarray.prototype, \"length\"); */\r\nexport default class ReactiveState /* extends forkarray  */ {\r\n  [addallistenerssymbol]() {\r\n    this[memlisteners].forEach(([value, callback]) => {\r\n      this[eventtargetsymbol].addEventListener(value, callback);\r\n    });\r\n  }\r\n  /*  [changetextnodesymbol](textnode: Text) {\r\n    this[textnodesymbol] = textnode;\r\n  } */\r\n  [textnodesymbol]: Text | undefined = undefined;\r\n  value: string | number | boolean | undefined | object;\r\n  [eventtargetsymbol] = new EventTarget();\r\n  [memlisteners] = [];\r\n  constructor(init: string | number | boolean | object | undefined) {\r\n    //super();\r\n    if (isprimitive(init) || isobject(init)) {\r\n      Object.defineProperty(this, \"value\", {\r\n        value: init,\r\n        configurable: true,\r\n        writable: true\r\n      });\r\n\r\n      // this.value = init;\r\n    } else {\r\n      throw TypeError(\"invalid State\");\r\n    }\r\n    // this[eventtargetsymbol] = new EventTarget();\r\n\r\n    Object.defineProperty(this, Symbol.toStringTag, {\r\n      value: \"ReactiveState\",\r\n      configurable: true\r\n    });\r\n  }\r\n\r\n  valueOf() {\r\n    return this.value;\r\n  }\r\n  toString() {\r\n    const value = this.value;\r\n    return isprimitive(value)\r\n      ? String(value)\r\n      : isSet(value)\r\n      ? JSON.stringify([...value])\r\n      : isobject(value)\r\n      ? JSON.stringify(value)\r\n      : \"\";\r\n  }\r\n  [dispatchsymbol](eventname?: string) {\r\n    const name = eventname ? String(eventname) : \"value\";\r\n    if (name !== \"value\") {\r\n      this[eventtargetsymbol].dispatchEvent(\r\n        new CustomEvent(name, { detail: name })\r\n      );\r\n    }\r\n\r\n    this[eventtargetsymbol].dispatchEvent(\r\n      new CustomEvent(\"value\", { detail: name })\r\n    );\r\n  }\r\n  [subscribesymbol](callback: Function, eventname?: string) {\r\n    // this[eventtargetsymbol].addEventListener(\"value\", callback);\r\n    const name = eventname ? String(eventname) : \"value\";\r\n    this[memlisteners].push([\r\n      name,\r\n      (event: { detail: any }) => callback(this, event.detail)\r\n    ]);\r\n  }\r\n  [removeallistenerssymbol]() {\r\n    this[memlisteners].forEach(([value, callback]) => {\r\n      this[eventtargetsymbol].removeEventListener(value, callback);\r\n    });\r\n  }\r\n  [Symbol.toPrimitive]() {\r\n    //return this.value;\r\n    const value = this.value;\r\n    return isprimitive(value)\r\n      ? value\r\n      : isobject(value)\r\n      ? JSON.stringify(value)\r\n      : void 0;\r\n  }\r\n}\r\n","export const requestAnimationFrame = window.requestAnimationFrame;\r\nimport { seteletext, setelehtml } from \"./dom\";\r\n\r\nimport { watch } from \"./watch\";\r\nimport ReactiveState, { isReactiveState } from \"./primitivestate\";\r\nexport default {\r\n  ref(ele: Element, ref: { value: any }) {\r\n    if (typeof ref == \"object\") {\r\n      ref.value = ele;\r\n    } else {\r\n      throw TypeError(\"invalid ref\");\r\n    }\r\n  },\r\n  html(ele: Element, html: string | ReactiveState) {\r\n    createhtmlandtextdirective(setelehtml, \"html\")(ele, html);\r\n\r\n    // ele.innerHTML = html;\r\n    // console.log(ele.outerHTML);\r\n    /*  if (typeof html == \"string\") {\r\n      requestAnimationFrame(() => {\r\n        setelehtml(ele, html);\r\n\r\n        /* ele.innerHTML = html;*/\r\n    //   console.log(ele.outerHTML);\r\n    /*     });\r\n    } else if (html instanceof ReactiveState) {\r\n      //   const ReactiveState = html;\r\n      watch(html, (state: { value: any }) => {\r\n        /*ele.innerHTML = String(state);*/\r\n    /*\r\n        setelehtml(ele, String(state));\r\n      });\r\n      //   ReactiveState[subscribesymbol]((state: { value: any }) => {\r\n      //     ele.innerHTML = String(state.value);\r\n      //   });\r\n      requestAnimationFrame(() => {\r\n        // console.log(\"html\");\r\n        /*  ele.innerHTML = String(html);*/\r\n    /*\r\n        setelehtml(ele, String(html));\r\n      });\r\n    } else {\r\n      throw TypeError(\"invalid html\");\r\n    }\r\n\r\n*/\r\n  },\r\n  text(ele: Element, text: string | ReactiveState) {\r\n    createhtmlandtextdirective(seteletext, \"text\")(ele, text);\r\n\r\n    /*\r\n\r\n  // ele.textContent = text;\r\n    // console.log(ele.outerHTML);\r\n    if (typeof text == \"string\") {\r\n      requestAnimationFrame(() => {\r\n        seteletext(ele, text);\r\n        /*    ele.textContent = text;*/\r\n    /*      //   console.log(ele.outerHTML);\r\n      });\r\n    } else if (text instanceof ReactiveState) {\r\n      //   const ReactiveState = text;\r\n      watch(text, (state: { value: any }) => {\r\n        seteletext(ele, String(state));\r\n\r\n        /* ele.textContent = String(state);*/\r\n    /*   });\r\n      //   ReactiveState[subscribesymbol]((state: { value: any }) => {\r\n      //     ele.textContent = String(state.value);\r\n      //   });\r\n      requestAnimationFrame(() => {\r\n        // console.log(\"text\");\r\n        seteletext(ele, String(text));\r\n\r\n        /*  ele.textContent = String(text);*/\r\n    /*    });\r\n    } else {\r\n      throw TypeError(\"invalid text\");\r\n    }\r\n\r\n*/\r\n  }\r\n};\r\nfunction createhtmlandtextdirective(seteletext: Function, errorname: string) {\r\n  return function(ele: Element, text: string | ReactiveState) {\r\n    if (typeof text == \"string\") {\r\n      requestAnimationFrame(() => {\r\n        seteletext(ele, text);\r\n        /*    ele.textContent = text;*/\r\n        //   console.log(ele.outerHTML);\r\n      });\r\n    } else if (\r\n      isReactiveState(text)\r\n      //  text instanceof ReactiveState\r\n    ) {\r\n      //   const ReactiveState = text;\r\n      watch(text, (state: { value: any }) => {\r\n        seteletext(ele, String(state));\r\n\r\n        /* ele.textContent = String(state);*/\r\n      });\r\n      //   ReactiveState[subscribesymbol]((state: { value: any }) => {\r\n      //     ele.textContent = String(state.value);\r\n      //   });\r\n      requestAnimationFrame(() => {\r\n        // console.log(\"text\");\r\n        seteletext(ele, String(text));\r\n\r\n        /*  ele.textContent = String(text);*/\r\n      });\r\n    } else {\r\n      throw TypeError(\"invalid \" + errorname);\r\n    }\r\n  };\r\n}\r\n","const Reflect = window.Reflect;\r\n\r\nconst {get: get, set: set} = Reflect;\r\n\r\nconst valuestring = \"value\";\r\n\r\nfunction isobject(a) {\r\n    return typeof a === \"object\" && a !== null;\r\n}\r\n\r\nfunction isstring(a) {\r\n    return typeof a === \"string\";\r\n}\r\n\r\nfunction isArray(a) {\r\n    return Array.isArray(a);\r\n}\r\n\r\nfunction isSet(a) {\r\n    return a instanceof Set;\r\n}\r\n\r\nfunction objtostylestring(o) {\r\n    return Object.entries(o).map(([key, value]) => key + \":\" + value).join(\";\");\r\n}\r\n\r\nfunction asserthtmlelement(ele) {\r\n    if (!(ele instanceof Element)) {\r\n        throw TypeError(\"invalid HTMLElement!\");\r\n    } else return true;\r\n}\r\n\r\nfunction createeleattragentreadwrite(ele) {\r\n    asserthtmlelement(ele);\r\n    const isinputtextortextareaflag = isinputtextortextarea(ele);\r\n    var temp = Object.create(null);\r\n    const outputattrs = new Proxy(temp, {\r\n        ownKeys() {\r\n            const keys = attributesownkeys(ele);\r\n            return isinputtextortextareaflag ? Array.from(new Set([ ...keys, valuestring ])) : keys;\r\n        },\r\n        get(target, key) {\r\n            if (isinputtextortextareaflag && key === valuestring) {\r\n                return get(ele, valuestring);\r\n            } else {\r\n                const v = getattribute(ele, String(key));\r\n                if (v === \"\") {\r\n                    return true;\r\n                }\r\n                if (v === null) {\r\n                    return;\r\n                }\r\n                if (isstring(v)) {\r\n                    try {\r\n                        return JSON.parse(String(v));\r\n                    } catch (error) {\r\n                        return v;\r\n                    }\r\n                } else return;\r\n            }\r\n        },\r\n        set(t, key, v) {\r\n            if (isinputtextortextareaflag && key === valuestring) {\r\n                return set(ele, valuestring, v);\r\n            } else if (key === \"style\") {\r\n                setattribute(ele, String(key), isstring(v) ? v : isobject(v) ? objtostylestring(v) : String(v));\r\n                return true;\r\n            } else if (key === \"class\" && isobject(v)) {\r\n                if (isArray(v)) {\r\n                    setattribute(ele, String(key), v.join(\" \"));\r\n                } else if (isSet(v)) {\r\n                    setattribute(ele, String(key), [ ...v ].join(\" \"));\r\n                } else {\r\n                    setattribute(ele, String(key), JSON.stringify(v));\r\n                }\r\n            } else {\r\n                if (isSet(v)) {\r\n                    setattribute(ele, String(key), JSON.stringify([ ...v ]));\r\n                } else {\r\n                    if (v === true) {\r\n                        v = \"\";\r\n                    }\r\n                    setattribute(ele, String(key), isobject(v) ? JSON.stringify(v) : String(v));\r\n                    return true;\r\n                }\r\n            }\r\n            return true;\r\n        },\r\n        deleteProperty(t, k) {\r\n            removeAttribute(ele, String(k));\r\n            return true;\r\n        },\r\n        has(target, key) {\r\n            if (isinputtextortextareaflag && key === valuestring) {\r\n                return true;\r\n            } else {\r\n                return hasAttribute(ele, String(key));\r\n            }\r\n        },\r\n        defineProperty() {\r\n            return false;\r\n        },\r\n        getOwnPropertyDescriptor(target, key) {\r\n            const otherdescipter = {\r\n                enumerable: true,\r\n                configurable: true,\r\n                writable: true\r\n            };\r\n            const myvalue = get(outputattrs, key);\r\n            if (typeof myvalue !== \"undefined\") {\r\n                return {\r\n                    value: myvalue,\r\n                    ...otherdescipter\r\n                };\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n    });\r\n    return outputattrs;\r\n}\r\n\r\nfunction attributesownkeys(ele) {\r\n    return ele.getAttributeNames();\r\n}\r\n\r\nfunction getattribute(ele, key) {\r\n    return ele.getAttribute(key);\r\n}\r\n\r\nfunction geteletagname(ele) {\r\n    return ele.tagName.toLowerCase();\r\n}\r\n\r\nfunction setattribute(ele, key, value) {\r\n    return ele.setAttribute(key, value);\r\n}\r\n\r\nfunction removeAttribute(ele, key) {\r\n    return ele.removeAttribute(key);\r\n}\r\n\r\nfunction hasAttribute(ele, key) {\r\n    return ele.hasAttribute(key);\r\n}\r\n\r\nfunction isinputtextortextarea(ele) {\r\n    const tagname = geteletagname(ele);\r\n    return tagname === \"input\" && get(ele, \"type\") === \"text\" || tagname === \"textarea\";\r\n}\r\n\r\nexport default createeleattragentreadwrite;\r\n//# sourceMappingURL=index.js.map\r\n","import { getAttribute, setAttribute, removeAttribute } from \"./dom\";\r\nconst attributeChangedCallback = \"attributeChangedCallback\";\r\nimport { isFunction } from \"./util\";\r\nexport class AttrChange extends HTMLElement {\r\n  /* disconnectedCallback() {\r\n  console.log('Custom square element removed from page.');\r\n} */\r\n  /* connectedCallback() {\r\n  console.log('Custom square element added to page.');\r\n  updateStyle(this);\r\n} */\r\n  //\r\n  //   connectedCallback(){}\r\n  /* attributeChangedCallback(name, oldValue, newValue) {\r\n  console.log('Custom square element attributes changed.');\r\n  updateStyle(this);\r\n} */\r\n  setAttribute(qualifiedName: string, value: string) {\r\n    const oldValue = getAttribute(this, qualifiedName);\r\n    // super.getAttribute(qualifiedName);\r\n\r\n    if (oldValue !== value) {\r\n      setAttribute(this, qualifiedName, value);\r\n      //   super.setAttribute(qualifiedName, value);\r\n      if (isFunction(this[attributeChangedCallback])) {\r\n        this[attributeChangedCallback](qualifiedName, oldValue, value);\r\n      }\r\n    }\r\n  }\r\n  removeAttribute(qualifiedName: string) {\r\n    const oldValue = getAttribute(this, qualifiedName);\r\n\r\n    if (null !== oldValue) {\r\n      //   super.removeAttribute(qualifiedName);\r\n      removeAttribute(this, qualifiedName);\r\n      if (isFunction(this[attributeChangedCallback])) {\r\n        this[attributeChangedCallback](qualifiedName, oldValue, undefined);\r\n      }\r\n    }\r\n  }\r\n}\r\n","export function isVirtualdom(a: any): a is Virtualdom {\r\n  return a instanceof Virtualdom;\r\n}\r\nimport ReactiveState, { isReactiveState } from \"./primitivestate\";\r\nimport { Class } from \"./rendervdomtoreal\";\r\n\r\nexport default class Virtualdom {\r\n  options: any = undefined;\r\n  element: undefined | Element = undefined;\r\n  type: string | Function | Class;\r\n  props: { [key: string]: string | object } = {};\r\n  children: Array<Virtualdom | string | ReactiveState> = [];\r\n  directives: object = {};\r\n  onevent: object = {};\r\n  bindattr: { [key: string]: ReactiveState } = {};\r\n  constructor(\r\n    type: Function | string = \"\",\r\n    props: object = {},\r\n    children: Array<Virtualdom | string | ReactiveState> = []\r\n  ) {\r\n    // console.log(type, props, children);\r\n    const propsentries = Object.entries(props);\r\n    Object.assign(this, {\r\n      type,\r\n      bindattr: Object.fromEntries(\r\n        propsentries\r\n          .filter(([key]) => /[A-Za-z]/.test(key[0]))\r\n          .filter(\r\n            e => isReactiveState(e[1])\r\n            // e[1] instanceof ReactiveState\r\n          )\r\n      ),\r\n      props: Object.fromEntries(\r\n        propsentries\r\n          .filter(([key]) => /[A-Za-z]/.test(key[0]))\r\n          .filter(\r\n            e => !isReactiveState(e[1])\r\n            //    e[1] instanceof ReactiveState\r\n          )\r\n      ),\r\n      children: children.flat(),\r\n      onevent: Object.fromEntries(\r\n        propsentries\r\n          .filter(([key]) => /\\@/.test(key[0]))\r\n          .map(([key, value]) => [\r\n            key.slice(1),\r\n            //把事件绑定变成事件数组\r\n            [value].flat()\r\n          ])\r\n      ),\r\n      directives: Object.fromEntries(\r\n        propsentries\r\n          .filter(([key]) => /\\*/.test(key[0]))\r\n          .map(([key, value]) => [key.slice(1), value])\r\n      )\r\n    });\r\n    Object.defineProperty(this, Symbol.toStringTag, {\r\n      value: \"virtualdom\",\r\n      configurable: true\r\n    });\r\n  }\r\n}\r\n","import { invalid_Function } from \"./context-mounted-unmounted-\";\r\nimport { domaddlisten, domremovelisten } from \"./dom\";\r\nexport const eventlistenerssymbol = Symbol(\"eventlisteners\");\r\nimport { isArray, isfunction } from \"./util\";\r\nexport default function(\r\n  element: Element,\r\n  eventname: string,\r\n  callback: EventListener | Array<EventListener>\r\n) {\r\n  if (!element[eventlistenerssymbol]) {\r\n    element[eventlistenerssymbol] = [];\r\n  }\r\n  if (isfunction(callback)) {\r\n    firstaddlisteners(element, eventname, [callback]);\r\n  } else if (isArray(callback)) {\r\n    firstaddlisteners(element, eventname, callback);\r\n  } else {\r\n    console.error(callback);\r\n    throw TypeError(invalid_Function);\r\n  }\r\n}\r\nexport function firstaddlisteners(\r\n  ele: Element,\r\n  event: string,\r\n  callarray: Array<EventListener>\r\n) {\r\n  callarray.forEach((call: EventListener) => {\r\n    ele[eventlistenerssymbol].push([event, call]);\r\n    domaddlisten(ele, event, call);\r\n  });\r\n}\r\nexport function removelisteners(\r\n  ele: Element | Node\r\n  //   event: string,\r\n  //   callarray: Array<EventListener>\r\n) {\r\n  if (ele[eventlistenerssymbol]) {\r\n    ele[eventlistenerssymbol].forEach(([event, call]) => {\r\n      //   ele[eventlistenerssymbol].push([event, call]);\r\n      domremovelisten(ele, event, call);\r\n    });\r\n  }\r\n}\r\nexport function readdlisteners(\r\n  ele: Element | Node\r\n  //   event: string,\r\n  //   callarray: Array<EventListener>\r\n) {\r\n  if (ele[eventlistenerssymbol]) {\r\n    ele[eventlistenerssymbol].forEach(([event, call]) => {\r\n      //   ele[eventlistenerssymbol].push([event, call]);\r\n      domaddlisten(ele, event, call);\r\n    });\r\n  }\r\n}\r\n","import ReactiveState from \"./primitivestate\";\r\nimport {\r\n  eventlistenerssymbol,\r\n  removelisteners,\r\n  readdlisteners\r\n} from \"./onevent\";\r\nimport { bindstatesymbol } from \"./rendervdomtoreal\";\r\nimport { rewatch, unwatch } from \"./watch\";\r\nimport { isArray } from \"./util\";\r\nimport { getdomchildren } from \"./dom\";\r\n\r\nexport function onmounted(ele: Element | Node | Array<Node>) {\r\n  if (isArray(ele)) {\r\n    ele.forEach(e => {\r\n      onmounted(e);\r\n    });\r\n  } else if (ele instanceof Node) {\r\n    if (ele[eventlistenerssymbol]) {\r\n      readdlisteners(ele);\r\n    }\r\n    if (ele[bindstatesymbol]) {\r\n      ele[bindstatesymbol].forEach((state: ReactiveState) => {\r\n        rewatch(state);\r\n      });\r\n\r\n      // readdlisteners(ele);\r\n    }\r\n    onmounted(getdomchildren(ele));\r\n  }\r\n\r\n  //\r\n}\r\nexport function onunmounted(ele: Element | Node | Array<Node>) {\r\n  if (isArray(ele)) {\r\n    ele.forEach(e => {\r\n      onunmounted(e);\r\n    });\r\n  } else if (ele instanceof Node) {\r\n    if (ele[eventlistenerssymbol]) {\r\n      removelisteners(ele);\r\n    }\r\n    if (ele[bindstatesymbol]) {\r\n      ele[bindstatesymbol].forEach((state: ReactiveState) => {\r\n        unwatch(state);\r\n      });\r\n\r\n      // readdlisteners(ele);\r\n    }\r\n    //\r\n    onunmounted(getdomchildren(ele));\r\n  }\r\n}\r\n","var n=function(t,r,u,e){for(var p=1;p<r.length;p++){var s=r[p],h=\"number\"==typeof s?u[s]:s,a=r[++p];1===a?e[0]=h:3===a?e[1]=Object.assign(e[1]||{},h):5===a?(e[1]=e[1]||{})[r[++p]]=h:6===a?e[1][r[++p]]+=h+\"\":e.push(a?t.apply(null,n(t,h,u,[\"\",null])):h)}return e},t=function(n){for(var t,r,u=1,e=\"\",p=\"\",s=[0],h=function(n){1===u&&(n||(e=e.replace(/^\\s*\\n\\s*|\\s*\\n\\s*$/g,\"\")))?s.push(n||e,0):3===u&&(n||e)?(s.push(n||e,1),u=2):2===u&&\"...\"===e&&n?s.push(n,3):2===u&&e&&!n?s.push(!0,5,e):u>=5&&((e||!n&&5===u)&&(s.push(e,u,r),u=6),n&&(s.push(n,u,r),u=6)),e=\"\"},a=0;a<n.length;a++){a&&(1===u&&h(),h(a));for(var f=0;f<n[a].length;f++)t=n[a][f],1===u?\"<\"===t?(h(),s=[s],u=3):e+=t:4===u?\"--\"===e&&\">\"===t?(u=1,e=\"\"):e=t+e[0]:p?t===p?p=\"\":e+=t:'\"'===t||\"'\"===t?p=t:\">\"===t?(h(),u=1):u&&(\"=\"===t?(u=5,r=e,e=\"\"):\"/\"===t&&(u<5||\">\"===n[a][f+1])?(h(),3===u&&(s=s[0]),u=s,(s=s[0]).push(u,2),u=0):\" \"===t||\"\\t\"===t||\"\\n\"===t||\"\\r\"===t?(h(),u=2):e+=t),3===u&&\"!--\"===e&&(u=4,s=s[0])}return h(),s},r=\"function\"==typeof Map,u=r?new Map:{},e=r?function(n){var r=u.get(n);return r||u.set(n,r=t(n)),r}:function(n){for(var r=\"\",e=0;e<n.length;e++)r+=n[e].length+\"-\"+n[e];return u[r]||(u[r]=t(n))};export default function(t){var r=n(this,e(t),arguments,[]);return r.length>1?r:r[0]}\n","import ReactiveState from \"./primitivestate\";\r\nimport { isstring, isobject, isfunction } from \"./util\";\r\nimport Virtualdom from \"./virtualdom\";\r\nexport default function createElement(\r\n  type: Function,\r\n  props: any,\r\n  ...children: any[]\r\n): Virtualdom;\r\nexport default function createElement(\r\n  type: Function | string = \"\",\r\n  props: any = {},\r\n  ...children: Array<Virtualdom | string | ReactiveState>\r\n): Virtualdom | Array<Virtualdom | string | ReactiveState> {\r\n  // | Array<Virtualdom | string>\r\n  // if(isarray()){}\r\n  /* add fragment element */\r\n  //   console.log(type, props, children);\r\n  let typenormalized = isstring(type) || isfunction(type) ? type : \"\";\r\n  const propsnormalized = isobject(props) ? props : {};\r\n  const childrennormalized = children.flat(Infinity);\r\n  if (\r\n    isstring(typenormalized)\r\n    //   typeof typenormalized === \"string\"\r\n  ) {\r\n    typenormalized = typenormalized.trim().toLowerCase();\r\n  }\r\n\r\n  if (\r\n    //typeof typenormalized === \"string\" &&\r\n\r\n    \"\" === typenormalized\r\n  ) {\r\n    return childrennormalized;\r\n  }\r\n  /* propsnormalized = Object.fromEntries(\r\n    Object.entries(propsnormalized).map(([key, value]) => [\r\n      key.trim().toLowerCase(),\r\n      value\r\n    ])\r\n  ); */\r\n  return new Virtualdom(typenormalized, propsnormalized, childrennormalized);\r\n}\r\n","import Virtualdom from \"./virtualdom\";\r\nimport ReactiveState from \"./primitivestate\";\r\nimport { isReactiveState } from \"./primitivestate\";\r\nimport { isstring, isArray } from \"./util\";\r\nimport { isVirtualdom } from \"./virtualdom\";\r\nimport htm from \"htm/dist/htm.module.js\";\r\nimport h from \"./createelement\";\r\nimport { invalid_Virtualdom } from \"./createApp\";\r\n\r\n// const html = htm.bind(h);\r\nfunction html(...inargs) {\r\n  return htm.call(h, ...inargs);\r\n}\r\n\r\n/* 如果出现未闭合标签会产生错误的vdom */\r\nexport function isvalidvdom(\r\n  v: any\r\n): v is\r\n  | string\r\n  | Virtualdom\r\n  | ReactiveState\r\n  | (string | Virtualdom | ReactiveState)[] {\r\n  let flag = false;\r\n  if (isArray(v)) {\r\n    flag = v\r\n      .map((ele: any) => {\r\n        return isvalidvdom(ele);\r\n        //isstring(ele) || ele instanceof Virtualdom;\r\n      })\r\n      .includes(false)\r\n      ? false\r\n      : true;\r\n    return flag;\r\n  } else if (\r\n    isVirtualdom(v)\r\n    // v instanceof Virtualdom\r\n  ) {\r\n    if (isvalidvdom(v.children)) {\r\n      return true;\r\n    }\r\n  } else if (\r\n    isReactiveState(v)\r\n    //  v instanceof ReactiveState\r\n  ) {\r\n    return true;\r\n  } else {\r\n    if (isstring(v)) {\r\n      return true;\r\n    }\r\n  }\r\n  return flag;\r\n}\r\nfunction assertvalidvirtualdom(...args: any[]) {\r\n  const vdom = html(...args);\r\n  if (isvalidvdom(vdom)) {\r\n    return vdom;\r\n  } else {\r\n    console.error(vdom);\r\n    throw new TypeError(invalid_Virtualdom);\r\n  }\r\n}\r\nexport default assertvalidvirtualdom;\r\n","import { appendchild, setelehtml } from \"./dom\";\r\nexport default function(\r\n  ele:\r\n    | Node\r\n    | Array<\r\n        | HTMLElement\r\n        | Text\r\n        | SVGSVGElement\r\n        | DocumentFragment\r\n        | SVGElement\r\n        | Element\r\n        | Node\r\n        | any\r\n      >\r\n    | SVGElement\r\n    | DocumentFragment\r\n    | HTMLElement\r\n    | Text\r\n    | SVGSVGElement\r\n    | Element,\r\n  container: HTMLElement | SVGSVGElement | SVGElement | Element\r\n) {\r\n  setelehtml(container, \"\");\r\n  //   container.innerHTML = \"\";\r\n  let eles: Array<any>;\r\n  if (Array.isArray(ele)) {\r\n    eles = ele;\r\n  } else {\r\n    // appendchild(container, ele);\r\n    eles = [ele];\r\n  }\r\n  eles.forEach(e => appendchild(container, e));\r\n  return container;\r\n}\r\n","export const invalid_Virtualdom = \"invalid Virtualdom \";\r\nimport ReactiveState from \"./primitivestate\";\r\nimport document from \"./dom\";\r\nimport { isvalidvdom } from \"./html\";\r\nimport Virtualdom from \"./virtualdom\";\r\nimport render from \"./rendervdomtoreal\";\r\nimport mount from \"./mount\";\r\nimport { isArray } from \"./util\";\r\nexport default function createApp(\r\n  vdom:\r\n    | Node\r\n    | Virtualdom\r\n    | string\r\n    | Array<Virtualdom | string | ReactiveState | Node>\r\n    | ReactiveState,\r\n  container: HTMLElement | Element\r\n): HTMLElement | Element {\r\n  if (isArray(vdom)) {\r\n    vdom = vdom.flat(Infinity);\r\n  }\r\n  const el = container;\r\n  if (\r\n    !(\r\n      isvalidvdom(vdom) ||\r\n      vdom instanceof Node ||\r\n      (isArray(vdom) && isNodeArray(vdom))\r\n    )\r\n  ) {\r\n    console.error(vdom);\r\n    throw TypeError(invalid_Virtualdom);\r\n  }\r\n  if (!(el instanceof HTMLElement)) {\r\n    throw TypeError(\"invalid container HTMLElement!\");\r\n  }\r\n\r\n  if (\r\n    el === document.body ||\r\n    el === document.documentElement ||\r\n    el === document.head\r\n  ) {\r\n    throw Error(\"Do not mount  to <html> or <body> <head>.\");\r\n  }\r\n  let elesarray: Array<any>;\r\n  if (Array.isArray(vdom)) {\r\n    elesarray = vdom;\r\n  } else {\r\n    elesarray = [vdom];\r\n  }\r\n  if (isvalidvdom(vdom)) {\r\n    mount(elesarray.map(e => render(e)), container);\r\n  } else if (vdom instanceof Node || isNodeArray(vdom)) {\r\n    mount(elesarray, container);\r\n  }\r\n\r\n  //\r\n  return container;\r\n}\r\nfunction isNodeArray(array: any[]): array is Node[] {\r\n  return isArray(array) && !array.map(e => e instanceof Node).includes(false);\r\n}\r\n","import { readysymbol } from \"./readysymbol\";\r\n// import { readysymbol } from \"./createComponent\";\r\nexport const invalid_ReactiveState = \"invalid ReactiveState\";\r\nimport { get } from \"./reflect\";\r\nimport render from \"./rendervdomtoreal\";\r\nimport createeleattr from \"dom-element-attribute-agent-proxy\";\r\nimport { AttrChange } from \"./attrchange\";\r\n// import createElement from \"./createelement\";\r\nimport Virtualdom from \"./virtualdom\";\r\nimport ReactiveState, { isReactiveState } from \"./primitivestate\";\r\nconst truevdomsymbol = Symbol(\"truevdom\");\r\nconst falsevdomsymbol = Symbol(\"falsevdom\");\r\nconst trueelesymbol = Symbol(\"trueele\");\r\nconst falseelesymbol = Symbol(\"falseele\");\r\nconst handletrue = getsymbol(\"handletrue\");\r\nconst handlefalse = getsymbol(\"handlefalse\");\r\n// const readysymbol = Symbol(\"ready\");\r\nimport { onmounted, onunmounted } from \"./elementonmountandunmount\";\r\n// import mount from \"./mount\";\r\nimport { isarray, getsymbol, isundefined, isboolean } from \"./util\";\r\nimport createApp, { invalid_Virtualdom } from \"./createApp\";\r\nimport { setelehtml } from \"./dom\";\r\nimport { isvalidvdom } from \"./html\";\r\nclass Condition extends AttrChange {\r\n  [readysymbol] = false;\r\n  constructor(propsjson?: object, children?: any[], options: object = {}) {\r\n    super();\r\n    // if(){}\r\n    const optionstrue = get(options, \"true\");\r\n    const optionsfalse = get(options, \"false\");\r\n    this[truevdomsymbol] = isarray(optionstrue)\r\n      ? optionstrue.filter(Boolean)\r\n      : [optionstrue].filter(Boolean);\r\n    this[falsevdomsymbol] = isarray(optionsfalse)\r\n      ? optionsfalse.filter(Boolean)\r\n      : [optionsfalse].filter(Boolean);\r\n    // optionsfalse;\r\n  }\r\n  [falseelesymbol]: any[];\r\n  [trueelesymbol]: any[];\r\n  [truevdomsymbol]: any[];\r\n  [falsevdomsymbol]: any[];\r\n  //   [readysymbol] = false;\r\n  [handlefalse]() {\r\n    setelehtml(this, \"\");\r\n    if (this[falsevdomsymbol]) {\r\n      if (!this[falseelesymbol]) {\r\n        // } else {\r\n        this[falseelesymbol] = render(this[falsevdomsymbol]);\r\n        // this[falsevdomsymbol].map(e => render(e));\r\n      }\r\n      //   mount(this[falseelesymbol], this);\r\n      const elementtomount = this[falseelesymbol];\r\n      createApp(elementtomount, this);\r\n      elementtomount.forEach(e => onmounted(e));\r\n      if (this[trueelesymbol]) {\r\n        this[trueelesymbol].forEach(e => onunmounted(e));\r\n      }\r\n    }\r\n  }\r\n  [handletrue]() {\r\n    setelehtml(this, \"\");\r\n    if (this[truevdomsymbol]) {\r\n      if (!this[trueelesymbol]) {\r\n        this[trueelesymbol] = render(this[truevdomsymbol]);\r\n        // this[truevdomsymbol].map(e => render(e));\r\n      }\r\n      //\r\n      //   mount(this[trueelesymbol], this);\r\n      const elementtomount = this[trueelesymbol];\r\n      createApp(elementtomount, this);\r\n      elementtomount.forEach(e => onmounted(e));\r\n      if (this[falseelesymbol]) {\r\n        this[falseelesymbol].forEach(e => onunmounted(e));\r\n      }\r\n    }\r\n  }\r\n  connectedCallback() {\r\n    if (!this[readysymbol]) {\r\n      // createApp(this[elementsymbol], this);\r\n      this[readysymbol] = true;\r\n\r\n      const attrs = createeleattr(this);\r\n      // console.log(attrs);\r\n      if (true === attrs[\"value\"]) {\r\n        this[handletrue]();\r\n      }\r\n      if (false === attrs[\"value\"]) {\r\n        this[handlefalse]();\r\n        //\r\n      }\r\n    }\r\n    onmounted(this);\r\n    //\r\n  }\r\n  disconnectedCallback() {\r\n    onunmounted(this);\r\n  }\r\n\r\n  attributeChangedCallback(name: string /* , oldValue: any, newValue: any */) {\r\n    if (this[readysymbol]) {\r\n      // console.log(name, oldValue, newValue);\r\n      if (name === \"value\") {\r\n        const attrs = createeleattr(this);\r\n        //   console.log(attrs);\r\n        if (true === attrs[\"value\"]) {\r\n          this[handletrue]();\r\n          //\r\n        }\r\n        if (false === attrs[\"value\"]) {\r\n          this[handlefalse]();\r\n          //\r\n        }\r\n      }\r\n\r\n      //\r\n    }\r\n  }\r\n}\r\nexport default function(\r\n  conditon: ReactiveState | boolean,\r\n  iftrue?:\r\n    | Virtualdom\r\n    | string\r\n    | Array<Virtualdom | string | ReactiveState>\r\n    | ReactiveState,\r\n  iffalse?:\r\n    | Virtualdom\r\n    | string\r\n    | Array<Virtualdom | string | ReactiveState>\r\n    | ReactiveState\r\n): Virtualdom {\r\n  if (!(isReactiveState(conditon) || isboolean(conditon))) {\r\n    throw TypeError(invalid_ReactiveState);\r\n  }\r\n  [iftrue, iffalse].forEach(a => {\r\n    if (!(isundefined(a) || isvalidvdom(a))) {\r\n      throw new TypeError(invalid_Virtualdom);\r\n    }\r\n  });\r\n  const vdom = new Virtualdom(Condition, { value: conditon });\r\n  vdom.options = { true: iftrue, false: iffalse };\r\n  return vdom;\r\n  /*  */\r\n}\r\n","import { requestAnimationFrame } from \"./directives\";\r\nimport { isFunction } from \"./util\";\r\nimport ReactiveState, {\r\n  isReactiveState,\r\n  subscribesymbol,\r\n  removeallistenerssymbol,\r\n  addallistenerssymbol\r\n} from \"./primitivestate\";\r\nimport { invalid_ReactiveState } from \"./conditon\";\r\nimport { invalid_Function } from \"./context-mounted-unmounted-\";\r\nexport function watch(\r\n  state: ReactiveState,\r\n  callback: Function,\r\n  statekey?: string\r\n): void {\r\n  if (\r\n    !(\r\n      isReactiveState(state) &&\r\n      // state instanceof ReactiveState\r\n      isFunction(callback)\r\n    )\r\n  ) {\r\n    console.error(state);\r\n    console.error(callback);\r\n    throw TypeError(invalid_ReactiveState + invalid_Function);\r\n  }\r\n\r\n  if (statekey) {\r\n    state[subscribesymbol](callback, statekey);\r\n  } else {\r\n    state[subscribesymbol](callback);\r\n  }\r\n\r\n  requestAnimationFrame(() => {\r\n    state[addallistenerssymbol]();\r\n  });\r\n}\r\nexport function unwatch(state: ReactiveState): void {\r\n  state[removeallistenerssymbol]();\r\n}\r\n\r\nexport function rewatch(state: ReactiveState): void {\r\n  state[addallistenerssymbol]();\r\n}\r\n","export const invalid_custom_element_class = \"invalid custom element class !\";\r\nimport { isobject } from \"./util\";\r\nif (\r\n  //   typeof Proxy !== \"function\" ||\r\n  !isobject(window.customElements) //||\r\n  //   typeof customElements !== \"object\" ||\r\n\r\n  //||\r\n  //   typeof CustomElementRegistry !== \"function\"\r\n) {\r\n  throw new TypeError(\" customElements  not supported !\");\r\n}\r\nimport { isclassextendsHTMLElement } from \"./customelement\";\r\n\r\nfunction 使用value从表中查询key(表: object, 组件状态名: any) {\r\n  return Object.entries(表).find(v => {\r\n    return v[1] === 组件状态名;\r\n  })[0];\r\n}\r\n\r\nimport { get, getPrototypeOf, has } from \"./reflect\";\r\ninterface ElementDefinitionOptions {\r\n  extends?: string;\r\n}\r\nwindow.CustomElementRegistry = get(\r\n  getPrototypeOf(window.customElements),\r\n  \"constructor\"\r\n);\r\nconst { customElements, CustomElementRegistry } = window;\r\n\r\n// export default customElements;\r\nconst elementset = Symbol.for(\"elementset\");\r\nconst elementmap = Symbol.for(\"elementmap\");\r\nexport default (initclass: Function, extendsname?: string) =>\r\n  RandomDefineCustomElement(initclass, extendsname);\r\n\r\nfunction RandomDefineCustomElement(\r\n  initclass: Function,\r\n  extendsname?: string,\r\n  length = 1\r\n): string {\r\n  if (!isclassextendsHTMLElement(initclass)) {\r\n    throw TypeError(invalid_custom_element_class);\r\n  }\r\n\r\n  //如果未注册自定义组件，则用随机名称注册，如果名称重复则重新生成新的随机名\r\n\r\n  if (!customElements[elementset].has(initclass)) {\r\n    const elementname = getrandomstringandnumber(length);\r\n\r\n    if (customElements.get(elementname)) {\r\n      return RandomDefineCustomElement(initclass, extendsname, length + 1);\r\n    } else {\r\n      if (extendsname) {\r\n        customElements.define(elementname, initclass, { extends: extendsname });\r\n      } else {\r\n        customElements.define(elementname, initclass);\r\n      }\r\n    }\r\n\r\n    return elementname;\r\n  } else {\r\n    return 使用value从表中查询key(customElements[elementmap], initclass);\r\n  }\r\n\r\n  //如果已经注册自定义组件，则返回注册的名称\r\n}\r\nif (!customElements[elementset]) {\r\n  customElements[elementset] = new Set();\r\n}\r\nif (!customElements[elementmap]) {\r\n  customElements[elementmap] = {};\r\n}\r\n/* customElements.get = function name(name) {\r\n  return customElements[elementmap].get(name);\r\n};\r\n */\r\ncustomElements.define = function(\r\n  name: string,\r\n  constructor: Function,\r\n  options?: ElementDefinitionOptions\r\n): void {\r\n  if (!isclassextendsHTMLElement(constructor)) {\r\n    console.error(constructor);\r\n    throw TypeError(invalid_custom_element_class);\r\n  }\r\n  if (!customElements[elementset].has(constructor)) {\r\n    if (has(customElements[elementmap], name)) {\r\n      /* 防止定义重名 */\r\n      RandomDefineCustomElement(\r\n        constructor,\r\n        options ? options.extends : undefined\r\n      );\r\n    } else {\r\n      CustomElementRegistry.prototype.define.call(\r\n        customElements,\r\n        name,\r\n        constructor,\r\n        options\r\n      );\r\n      customElements[elementset].add(constructor);\r\n      customElements[elementmap][name] = constructor;\r\n    }\r\n  }\r\n};\r\n\r\ncustomElements[Symbol.iterator] = () => {\r\n  const entries = Object.entries(customElements[elementmap]);\r\n\r\n  return entries[Symbol.iterator].call(entries);\r\n};\r\nfunction getrandomcharactor() {\r\n  return get(\r\n    Array(26)\r\n      .fill(undefined)\r\n      .map((v, i) => 97 + i)\r\n      .map(n => String.fromCharCode(n)),\r\n    Math.floor(Math.random() * 26)\r\n  );\r\n\r\n  // [Math.floor(Math.random() * 26)];\r\n}\r\nfunction getrandomhexnumber() {\r\n  return get(\r\n    Array(16)\r\n      .fill(undefined)\r\n      .map((v, i) => i),\r\n    Math.floor(Math.random() * 16)\r\n  ).toString(16);\r\n\r\n  /*  Array(16)\r\n    .fill(undefined)\r\n    .map((v, i) => i)\r\n    [Math.floor(Math.random() * 16)].toString(16); */\r\n}\r\nfunction getrandomstringandnumber(length = 4) {\r\n  return (\r\n    Array(length)\r\n      .fill(undefined)\r\n      .map(() => getrandomcharactor())\r\n\r\n      .join(\"\") +\r\n    \"-\" +\r\n    Array(length)\r\n      .fill(undefined)\r\n      .map(() => getrandomhexnumber())\r\n      .join(\"\")\r\n  );\r\n}\r\n","import { invalid_custom_element_class } from \"./CustomElementRegistry\";\r\n\r\n//import setlikearray from \"./setlikearay\";\r\n\r\n// const customElementsarray = new Set;\r\nimport RandomDefineCustomElement from \"./CustomElementRegistry\";\r\n/* function getcustomelementname(initclass: any): string {\r\n  return customElements(initclass);\r\n} */\r\nimport { isfunction } from \"./util\";\r\nexport function isclassextendsHTMLElement(initclass: {\r\n  prototype: any;\r\n}): initclass is Class {\r\n  return !!(\r\n    isfunction(initclass) &&\r\n    initclass.prototype &&\r\n    initclass.prototype instanceof HTMLElement\r\n  );\r\n}\r\n\r\nimport { construct } from \"./reflect\";\r\n// import Reflect from \"./reflect\";\r\n\r\nimport { Class } from \"./rendervdomtoreal\";\r\n\r\nexport function createcostumelemet(\r\n  initclass: Class | Function,\r\n  propsjson?: object,\r\n  children?: any[],\r\n  options?: any\r\n): HTMLElement {\r\n  if (isclassextendsHTMLElement(initclass)) {\r\n    // customElementsarray.push(initclass);\r\n    /*   const elementname =\r\n     getcustomelementname(initclass); */\r\n    /* if (customElements.get(elementname) === initclass) {\r\n    } else {\r\n      customElements.define(elementname, initclass);\r\n    } */\r\n    RandomDefineCustomElement(initclass);\r\n    return construct(initclass, [propsjson, children, options]); // (children);\r\n  } else {\r\n    console.error(initclass);\r\n\r\n    throw TypeError(invalid_custom_element_class);\r\n  }\r\n}\r\n","export const bindstatesymbol = Symbol(\"bindstate\");\r\n\r\nexport const reactivestatesymbol = Symbol(\"reactive\");\r\nimport { watch } from \"./watch\";\r\nimport ReactiveState, { textnodesymbol } from \"./primitivestate\";\r\nexport const virtualdomsymbol = Symbol(\"virtualdom\");\r\nimport directives from \"./directives\";\r\nimport onevent, { eventlistenerssymbol } from \"./onevent\";\r\nimport { createcostumelemet } from \"./customelement\";\r\nimport {\r\n  mathnamespace,\r\n  createmathelement,\r\n  svgnamespace,\r\n  createsvgelement,\r\n  createnonescript,\r\n  createnativeelement,\r\n  createElementNS,\r\n  createtextnode,\r\n  changetext\r\n} from \"./dom\";\r\nfunction throwinvalideletype(type) {\r\n  console.error(type);\r\n  throw TypeError(\"invalid element type!\");\r\n}\r\nimport mount from \"./mount\";\r\nimport createeleattr from \"dom-element-attribute-agent-proxy\";\r\nimport { isobject, isArray, isfunction, isstring } from \"./util\";\r\nimport Virtualdom from \"./virtualdom\";\r\nexport default function render(\r\n  vdom: Array<Virtualdom | string | ReactiveState>,\r\n  namespace?: string\r\n): Array<Node | any>;\r\nexport default function render(\r\n  vdom: Virtualdom | string | ReactiveState,\r\n  namespace?: string\r\n): Node | any;\r\nexport default function render(\r\n  vdom:\r\n    | Virtualdom\r\n    | string\r\n    | ReactiveState\r\n    | Array<Virtualdom | string | ReactiveState>,\r\n  namespace?: string\r\n):\r\n  | HTMLElement\r\n  | Text\r\n  | SVGSVGElement\r\n  | DocumentFragment\r\n  | SVGElement\r\n  | Element\r\n  | Array<Node | any> {\r\n  if (typeof vdom === \"string\") {\r\n    return createtextnode(vdom);\r\n  } else if (vdom instanceof ReactiveState) {\r\n    const reactive = vdom;\r\n    const textnode = createtextnode(String(reactive));\r\n    textnode[reactivestatesymbol] = reactive;\r\n    reactive[textnodesymbol] = textnode;\r\n    watch(reactive, (state: { value: string }) => {\r\n      changetext(textnode, String(state));\r\n    });\r\n    const element = textnode;\r\n    element[bindstatesymbol] = new Set();\r\n    element[bindstatesymbol].add(reactive);\r\n    return textnode;\r\n  } else if (vdom instanceof Virtualdom && \"type\" in vdom) {\r\n    const { type } = vdom;\r\n    let element: HTMLElement | SVGSVGElement | SVGElement | Element;\r\n    if (typeof type === \"string\") {\r\n      if (type === \"script\") {\r\n        /* 禁止加载脚本 */\r\n\r\n        return createnonescript();\r\n      } else if (type === \"svg\") {\r\n        /* 没想到svg的创建方式这么特别?否则显示不出svg */\r\n        element = createsvgelement();\r\n      } else if (type === \"math\") {\r\n        /* 没想到svg的创建方式这么特别?否则显示不出svg */\r\n        element = createmathelement();\r\n      } else if (\"\" === type) {\r\n        return render(vdom.children);\r\n      } else {\r\n        element = namespace\r\n          ? createElementNS(namespace, type)\r\n          : createnativeelement(type);\r\n      }\r\n    } else if (typeof type == \"function\") {\r\n      //添加默认props\r\n\r\n      /*static defaultProps = {\r\n        name: 'Omi',\r\n        myAge: 18\r\n  }*/\r\n      if (isobject(type[\"defaultProps\"])) {\r\n        vdom.props = JSON.parse(\r\n          JSON.stringify({ ...type[\"defaultProps\"], ...vdom.props })\r\n        );\r\n      }\r\n\r\n      const propsjson = JSON.parse(\r\n        JSON.stringify({\r\n          ...vdom.props,\r\n          ...Object.fromEntries(\r\n            Object.entries(vdom.bindattr).map(([key, value]) => {\r\n              return [key, value.value];\r\n            })\r\n          )\r\n        })\r\n      );\r\n      element = createcostumelemet(\r\n        type,\r\n        propsjson,\r\n        vdom.children,\r\n        vdom.options\r\n      );\r\n    } else {\r\n      throwinvalideletype(vdom);\r\n      // throw TypeError(\"invalid element type!\");\r\n    }\r\n    handleprops(element, vdom);\r\n\r\n    /* 自定义组件不添加children,而是从构造函数传入 */\r\n    /* web components也可以设置 childnodes,比如说slot */\r\n    /* https://webkit.org/blog/4096/introducing-shadow-dom-api/ */\r\n    /*  */\r\n    /* https://developer.mozilla.org/zh-CN/docs/Web/API/Element/slot */\r\n    if (\r\n      (type && isfunction(type)) ||\r\n      isstring(type)\r\n      // /\r\n      //   /\r\n\r\n      /* typeof type !== \"function\" */\r\n    ) {\r\n      mount(\r\n        vdom.children.map(e => {\r\n          if (type === \"svg\") {\r\n            /* 没想到svg的创建方式这么特别?否则显示不出svg */\r\n            //   element.innerHTML = element.innerHTML;\r\n            return render(e, svgnamespace);\r\n          } else if (type === \"math\") {\r\n            return render(e, mathnamespace);\r\n          } else if (namespace) {\r\n            return render(e, namespace);\r\n          } else {\r\n            return render(e);\r\n          }\r\n        }),\r\n\r\n        element\r\n      );\r\n    }\r\n    return element;\r\n  } else if (isArray(vdom)) {\r\n    return vdom.map(a => render(a));\r\n  } else {\r\n    throwinvalideletype(vdom);\r\n    // throw TypeError(\"invalid element type!\");\r\n  }\r\n}\r\n\r\nexport interface Class {\r\n  new (propsjson?: object, children?: any[], options?: any): HTMLElement;\r\n  prototype: HTMLElement;\r\n}\r\nimport { isReactiveState } from \"./primitivestate\";\r\nfunction handleprops(\r\n  element: HTMLElement | Element | SVGSVGElement | SVGElement,\r\n  vdom: Virtualdom\r\n) {\r\n  ((element, vdom) => {\r\n    Object.entries(vdom.directives).forEach(([name, value]) => {\r\n      if (name in directives && typeof directives[name] === \"function\") {\r\n        directives[name](element, value, vdom);\r\n      } else {\r\n        throw new Error(\"invalid directives \" + name);\r\n      }\r\n    });\r\n\r\n    const attribute1 = createeleattr(element);\r\n    Object.assign(attribute1, vdom.props);\r\n    /* 添加常量的属性 */\r\n    element[virtualdomsymbol] = vdom;\r\n    vdom.element = element;\r\n    /* 添加绑定属性 */\r\n\r\n    Object.entries(vdom.bindattr).forEach(([key, primitivestate]) => {\r\n      attribute1[key] = primitivestate.value;\r\n      watch(primitivestate, (state: { value: any }) => {\r\n        attribute1[key] = state.value;\r\n      });\r\n      /*     primitivestate[subscribesymbol]();\r\n      requestAnimationFrame(() => {\r\n        primitivestate[addallistenerssymbol]();\r\n      }); */\r\n    });\r\n\r\n    /* 添加事件绑定和指令执行 */\r\n\r\n    if (!element[eventlistenerssymbol]) {\r\n      element[eventlistenerssymbol] = [];\r\n    }\r\n\r\n    Object.entries(vdom.onevent).forEach(([event, callbacks]) => {\r\n      onevent(element, event, callbacks);\r\n    });\r\n  })(element, vdom);\r\n  if (!element[bindstatesymbol]) {\r\n    element[bindstatesymbol] = new Set();\r\n  }\r\n\r\n  [Object.values(vdom.bindattr), Object.values(vdom.directives)]\r\n    .flat()\r\n    .filter(\r\n      e => isReactiveState(e)\r\n      // e instanceof ReactiveState\r\n    )\r\n\r\n    .forEach(e => element[bindstatesymbol].add(e));\r\n}\r\n","export default function(target: object) {\r\n  return new Proxy(target, {\r\n    set() {\r\n      return false;\r\n    },\r\n    defineProperty() {\r\n      return false;\r\n    },\r\n    deleteProperty() {\r\n      return false;\r\n    }\r\n  });\r\n}\r\n","const Reflect = window.Reflect;\r\nconst { ownKeys, deleteProperty, apply, construct, defineProperty, get, getOwnPropertyDescriptor, getPrototypeOf, has, set, setPrototypeOf } = Reflect;\r\nfunction isobject(a) {\r\n    return typeof a === \"object\" && a !== null;\r\n}\r\nfunction isfunction(a) {\r\n    return typeof a === \"function\";\r\n}\r\nfunction deepobserveaddpath(target, callback, patharray = [], ancestor = target) {\r\n    if (typeof callback !== \"function\") {\r\n        throw Error(\"observe callback invalid !\");\r\n    }\r\n    if (isfunction(target) || isobject(target)) {\r\n        let fakeobj;\r\n        if (isobject(target)) {\r\n            fakeobj = {};\r\n        }\r\n        else {\r\n            fakeobj = () => { };\r\n        }\r\n        setPrototypeOf(fakeobj, null);\r\n        return (fakeobj => {\r\n            return new Proxy(fakeobj, {\r\n                defineProperty(t, p, a) {\r\n                    return defineProperty(target, p, a);\r\n                },\r\n                deleteProperty(t, p) {\r\n                    callback(ancestor, [...patharray, p], undefined, get(target, p));\r\n                    return deleteProperty(target, p);\r\n                },\r\n                ownKeys() {\r\n                    return ownKeys(target);\r\n                },\r\n                has(t, p) {\r\n                    return has(target, p);\r\n                },\r\n                getPrototypeOf() {\r\n                    return getPrototypeOf(target);\r\n                },\r\n                setPrototypeOf(t, v) {\r\n                    return setPrototypeOf(target, v);\r\n                },\r\n                construct(t, argumentslist) {\r\n                    if (typeof target === \"function\") {\r\n                        return construct(target, argumentslist);\r\n                    }\r\n                },\r\n                apply(t, thisarg, argarray) {\r\n                    if (typeof target === \"function\") {\r\n                        return apply(target, thisarg, argarray);\r\n                    }\r\n                },\r\n                getOwnPropertyDescriptor(t, k) {\r\n                    var descripter = getOwnPropertyDescriptor(target, k);\r\n                    if (descripter) {\r\n                        descripter.configurable = true;\r\n                        return descripter;\r\n                    }\r\n                    else {\r\n                        return;\r\n                    }\r\n                },\r\n                set(t, k, v) {\r\n                    if (typeof callback === \"function\") {\r\n                        callback(ancestor, [...patharray, k], v, get(target, k));\r\n                    }\r\n                    return set(target, k, v);\r\n                },\r\n                get(t, k) {\r\n                    var value = get(target, k);\r\n                    if (isfunction(value) || isobject(value)) {\r\n                        return deepobserveaddpath(value, callback, [...patharray, k], target);\r\n                    }\r\n                    else {\r\n                        return value;\r\n                    }\r\n                }\r\n            });\r\n        })(fakeobj);\r\n    }\r\n    else {\r\n        return target;\r\n    }\r\n}\r\nfunction observedeepagent(target, callback) {\r\n    if (typeof callback !== \"function\") {\r\n        throw Error(\"observe callback  invalid function \");\r\n    }\r\n    if (typeof Proxy !== \"function\") {\r\n        throw Error(\"Proxy unsupported!\");\r\n    }\r\n    if (isfunction(target) || isobject(target)) {\r\n        return deepobserveaddpath(target, callback, [], target);\r\n    }\r\n    else {\r\n        return target;\r\n    }\r\n}\r\n\r\nexport default observedeepagent;\r\n//# sourceMappingURL=index.js.map\r\n","import {\r\n  deleteProperty,\r\n  get,\r\n  getOwnPropertyDescriptor,\r\n  has,\r\n  ownKeys,\r\n  set\r\n} from \"./reflect\";\r\nimport deepobserve from \"deep-observe-agent-proxy\";\r\nimport { isobject, isSet } from \"./util\";\r\nimport isprimitive from \"./isprimitive\";\r\nimport ReactiveState, {\r\n  dispatchsymbol,\r\n  textnodesymbol,\r\n  isReactiveState\r\n} from \"./primitivestate\";\r\nexport default function createstate(\r\n  init: string | number | boolean | undefined | ReactiveState | object | any\r\n): object | ReactiveState {\r\n  if (isprimitive(init)) {\r\n    return new Proxy(new ReactiveState(init), {\r\n      defineProperty() {\r\n        return false;\r\n      },\r\n      deleteProperty() {\r\n        return false;\r\n      },\r\n      set(target, key, value) {\r\n        if (key === textnodesymbol) {\r\n          return set(target, key, value);\r\n        }\r\n        if (key === \"value\" && isprimitive(value)) {\r\n          // if (target[key] !== value) {\r\n          set(target, key, value);\r\n          target[dispatchsymbol]();\r\n          // }\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      }\r\n    });\r\n  } else if (\r\n    isReactiveState(init)\r\n    // init instanceof ReactiveState\r\n  ) {\r\n    // 如果init是个 ReactiveState，则对其解包，并生成新的 ReactiveState\r\n    return createstate(init.value);\r\n  } else if (isobject(init)) {\r\n    return new Proxy(new ReactiveState(init), {\r\n      defineProperty() {\r\n        return false;\r\n      },\r\n      getOwnPropertyDescriptor(target, key) {\r\n        const myvalue = get(target, \"value\");\r\n\r\n        const descripter =\r\n          getOwnPropertyDescriptor(target, key) ||\r\n          getOwnPropertyDescriptor(myvalue, key);\r\n        if (descripter) {\r\n          descripter.configurable = true;\r\n        }\r\n\r\n        return descripter;\r\n      },\r\n      deleteProperty(target, key) {\r\n        const myvalue = get(target, \"value\");\r\n        if (has(myvalue, key)) {\r\n          deleteProperty(myvalue, key);\r\n          target[dispatchsymbol](key);\r\n          return true;\r\n        } else {\r\n          return true;\r\n        }\r\n      },\r\n      has(target, key) {\r\n        const myvalue = get(target, \"value\");\r\n        return has(target, key) || has(myvalue, key);\r\n      },\r\n      get(target, key) {\r\n        const value = get(target, \"value\");\r\n        if (has(target, key)) {\r\n          return get(target, key);\r\n        } else if (has(value, key)) {\r\n          if (isSet(value) && (key === \"add\" || key === \"delete\")) {\r\n            const myvalue = value;\r\n            if (key === \"add\") {\r\n              return (add: any) => {\r\n                if (!Set.prototype.has.call(myvalue, add)) {\r\n                  const returnvalue = Set.prototype[key].call(myvalue, add);\r\n                  target[dispatchsymbol]();\r\n                  return returnvalue;\r\n                }\r\n              };\r\n            } else if (key === \"delete\") {\r\n              return (dele: any) => {\r\n                if (Set.prototype.has.call(myvalue, dele)) {\r\n                  const returnvalue = Set.prototype[key].call(myvalue, dele);\r\n                  target[dispatchsymbol]();\r\n                  return returnvalue;\r\n                }\r\n              };\r\n            }\r\n          } else {\r\n            return deepobserve(get(value, key), () => {\r\n              target[dispatchsymbol](key);\r\n            });\r\n          }\r\n\r\n          /*  */\r\n        }\r\n      },\r\n      ownKeys(target) {\r\n        return Array.from(\r\n          new Set([...ownKeys(target), ...ownKeys(get(target, \"value\"))])\r\n        );\r\n      },\r\n      set(target, key, value) {\r\n        if (key === textnodesymbol) {\r\n          return set(target, key, value);\r\n        }\r\n        const myvalue = get(target, \"value\");\r\n        if (key === \"value\" && isobject(value)) {\r\n          // if (target[key] !== value) {\r\n          set(target, key, value);\r\n          target[dispatchsymbol]();\r\n\r\n          // }\r\n          return true;\r\n        } else if (!has(target, key)) {\r\n          set(myvalue, key, value);\r\n          target[dispatchsymbol](key);\r\n\r\n          //\r\n        } else if (key === \"length\") {\r\n          set(myvalue, key, value);\r\n          target[dispatchsymbol](key);\r\n        } else {\r\n          return false;\r\n        }\r\n        return true;\r\n      }\r\n    });\r\n  } else {\r\n    throw TypeError(\"invalid State\");\r\n  }\r\n}\r\n","import { readysymbol } from \"./readysymbol\";\r\nimport render from \"./rendervdomtoreal\";\r\nimport readonlyproxy from \"./readonlyproxy\";\r\nimport ReactiveState /* , { dispatchsymbol } */ from \"./primitivestate\";\r\nimport createstate from \"./createstate\";\r\nconst attributessymbol = Symbol(\"attributes\");\r\nconst elementsymbol = Symbol(\"element\");\r\nconst vdomsymbol = Symbol(\"componentinnervdom\");\r\nconst mountedsymbol = Symbol(\"mounted\");\r\nconst unmountedsymbol = Symbol(\"unmounted\");\r\n\r\nimport { AttrChange } from \"./attrchange\";\r\nimport {\r\n  openctx,\r\n  closectx,\r\n  getMounted,\r\n  getUnMounted,\r\n  invalid_Function\r\n} from \"./context-mounted-unmounted-\";\r\nexport interface Custom {\r\n  (props?: object, children?: Array<any>):\r\n    | Virtualdom\r\n    | string\r\n    | ReactiveState\r\n    | Array<Virtualdom | ReactiveState | string>;\r\n}\r\nimport { Class } from \"./rendervdomtoreal\";\r\nimport Virtualdom from \"./virtualdom\";\r\nimport createeleattragentreadwrite from \"dom-element-attribute-agent-proxy\";\r\nimport { isobject, isArray, isfunction } from \"./util\";\r\nimport { onunmounted, onmounted } from \"./elementonmountandunmount\";\r\nimport { isvalidvdom } from \"./html\";\r\nimport createApp, { invalid_Virtualdom } from \"./createApp\";\r\n// import { inflate } from \"zlib\";\r\nexport function createComponent(custfun: Custom): Class {\r\n  if (isfunction(custfun)) {\r\n    const defaultProps = custfun[\"defaultProps\"];\r\n    return class Component extends AttrChange {\r\n      [readysymbol] = false;\r\n      [mountedsymbol]: Array<Function>;\r\n      [unmountedsymbol]: Array<Function>;\r\n      static defaultProps = isobject(defaultProps)\r\n        ? JSON.parse(JSON.stringify(defaultProps))\r\n        : undefined;\r\n      [attributessymbol]: { [s: string]: ReactiveState } | object = {};\r\n      [elementsymbol]: Array<Node>;\r\n      [vdomsymbol]: Array<Virtualdom | ReactiveState | string>;\r\n      constructor(\r\n        propsjson: object = {},\r\n        children: any[] = [] /* , options?: any */\r\n      ) {\r\n        super();\r\n        const attrs = createeleattragentreadwrite(this);\r\n        //   const props = {};\r\n        if (isobject(this.constructor[\"defaultProps\"])) {\r\n          Object.assign(attrs, this.constructor[\"defaultProps\"]);\r\n          // Object.assign(props, this.constructor[\"defaultProps\"]);\r\n        }\r\n        if (isobject(propsjson)) {\r\n          Object.assign(attrs, propsjson);\r\n          // Object.assign(props, propsjson);\r\n        }\r\n        //   this[attributessymbol] = createeleattragentreadwrite(this);\r\n        const props = createeleattragentreadwrite(this);\r\n        const thisattributess = Object.fromEntries(\r\n          Object.entries(props).map(([key, value]) => [key, createstate(value)])\r\n        );\r\n        this[attributessymbol] = readonlyproxy(thisattributess);\r\n        openctx();\r\n        let possiblyvirtualdom:\r\n          | string\r\n          | Virtualdom\r\n          | ReactiveState\r\n          | (string | Virtualdom | ReactiveState)[]\r\n          | any;\r\n        try {\r\n          possiblyvirtualdom = custfun(\r\n            readonlyproxy(thisattributess),\r\n            children\r\n          );\r\n        } catch (error) {\r\n          closectx();\r\n          throw error;\r\n        }\r\n\r\n        if (isArray(possiblyvirtualdom)) {\r\n          possiblyvirtualdom = possiblyvirtualdom\r\n            .flat(Infinity)\r\n            .filter(Boolean);\r\n        }\r\n        if (isvalidvdom(possiblyvirtualdom)) {\r\n          const thisvdomsymbol = isArray(possiblyvirtualdom)\r\n            ? possiblyvirtualdom\r\n            : [possiblyvirtualdom];\r\n          //\r\n          this[vdomsymbol] = thisvdomsymbol.flat(Infinity).filter(Boolean);\r\n          this[mountedsymbol] = getMounted();\r\n          this[unmountedsymbol] = getUnMounted();\r\n          closectx();\r\n        } else {\r\n          closectx();\r\n          console.error(possiblyvirtualdom);\r\n          throw Error(invalid_Virtualdom);\r\n        }\r\n\r\n        //   this[mountedsymbol] = getMounted();\r\n        //   this[unmountedsymbol] = getUnMounted();\r\n      }\r\n\r\n      connectedCallback() {\r\n        if (!this[elementsymbol]) {\r\n          this[elementsymbol] = render(this[vdomsymbol]).flat(Infinity);\r\n        }\r\n        if (!this[readysymbol]) {\r\n          createApp(this[elementsymbol], this);\r\n          this[readysymbol] = true;\r\n        }\r\n        this[mountedsymbol].forEach(f => f());\r\n        onmounted(this);\r\n      }\r\n      disconnectedCallback() {\r\n        this[unmountedsymbol].forEach(f => f());\r\n        onunmounted(this);\r\n      }\r\n      attributeChangedCallback(\r\n        name: string /* , oldValue: any, newValue: any */\r\n      ) {\r\n        // console.log(this[attributessymbol]);\r\n        if (this[attributessymbol][name]) {\r\n          /* 当属性改变时要跟ReactiveState同步状态 */\r\n          this[attributessymbol][name].value = createeleattragentreadwrite(\r\n            this\r\n          )[name];\r\n          //   this[attributessymbol][name][dispatchsymbol]();\r\n        }\r\n      }\r\n    };\r\n  } else {\r\n    console.error(custfun);\r\n    throw TypeError(invalid_Function);\r\n  }\r\n}\r\n","import { isobject, isfunction } from \"./util\";\r\nif (\r\n  !isfunction(window.HTMLElement) ||\r\n  //   typeof HTMLElement !== \"function\" ||\r\n  !isfunction(window.Proxy) ||\r\n  //   typeof Proxy !== \"function\" ||\r\n  !isobject(window.customElements) ||\r\n  //   typeof customElements !== \"object\" ||\r\n  !isfunction(window.CustomElementRegistry)\r\n  //||\r\n  //   typeof CustomElementRegistry !== \"function\"\r\n) {\r\n  throw new TypeError(\" browser not supported !\");\r\n}\r\n","import { invalid_Function } from \"./context-mounted-unmounted-\";\r\nimport Virtualdom from \"./virtualdom\";\r\ninterface Extendfun {\r\n  (element: Element, value: any, vdom: Virtualdom): void;\r\n}\r\nimport directives from \"./directives\";\r\nexport default function extenddirectives(options: {\r\n  [s: string]: Extendfun;\r\n}): void {\r\n  Object.entries(options).forEach(([key, value]) => {\r\n    if (typeof value !== \"function\") {\r\n      throw TypeError(invalid_Function);\r\n    } else {\r\n      directives[key] = value;\r\n    }\r\n  });\r\n}\r\n","import ReactiveState, {\r\n  // ReactiveState,\r\n  isReactiveState\r\n} from \"./primitivestate\";\r\nimport directives from \"./extend-directive\";\r\nimport Virtualdom from \"./virtualdom\";\r\nimport { invalid_ReactiveState } from \"./conditon\";\r\nimport { invalid_Virtualdom } from \"./createApp\";\r\ndirectives({\r\n  value(element: any, value: ReactiveState, vdom: Virtualdom) {\r\n    if (\r\n      isReactiveState(value) &&\r\n      //   value instanceof ReactiveState\r\n\r\n      (vdom.type === \"input\" || vdom.type === \"textarea\")\r\n    ) {\r\n      vdom.bindattr[\"value\"] = value;\r\n      [\"change\", \"input\"].forEach(eventname => {\r\n        const origin = vdom.onevent[eventname];\r\n\r\n        const eventsarray = [origin].flat(Infinity);\r\n\r\n        // vdom.onevent[eventname] =\r\n        Reflect.set(\r\n          vdom.onevent,\r\n          eventname,\r\n          eventsarray\r\n            .concat([\r\n              (e: any) => {\r\n                return (value.value = e.target.value);\r\n              }\r\n            ])\r\n            .filter(Boolean)\r\n        );\r\n      });\r\n    } else {\r\n      console.error(value);\r\n      console.error(vdom);\r\n      throw TypeError(invalid_ReactiveState + invalid_Virtualdom);\r\n    }\r\n  }\r\n});\r\n","export default function createRef(init: any): object {\r\n  return { value: init };\r\n}\r\n","import { useMounted, useUnMounted } from \"./context-mounted-unmounted-\";\r\nexport { useMounted, useUnMounted };\r\nimport { createComponent } from \"./createComponent\";\r\nimport \"./CustomElementRegistry\";\r\nexport { createComponent };\r\n// import { isobject, isfunction } from \"./util\";\r\n\r\nimport \"./assetbrowser\";\r\n\r\n//请自行使用babel-preset-env和core-js 3\r\n//import \"./Object-fromEntries\";\r\n// import \"./setImmediate\";\r\n//import \"./array-prototype-flat\";\r\nimport \"./input-textarea-value-directive-Bidirectional-binding\";\r\n\r\nimport html from \"./html\";\r\nimport createElement from \"./createelement\";\r\nexport { html };\r\nexport { createElement, createElement as h };\r\nimport createApp from \"./createApp\";\r\nexport { createApp };\r\nimport createRef from \"./createref\";\r\nexport { createRef };\r\nimport createState from \"./createstate\";\r\nexport { createState };\r\nimport { watch } from \"./watch\";\r\nexport { watch };\r\nimport directives from \"./extend-directive\";\r\n\r\nexport { directives };\r\n//export { RandomDefine };\r\nexport const Fragment = \"\";\r\nimport condition from \"./conditon\";\r\nexport { condition };\r\n"],"names":["Reflect","window","construct","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","has","ownKeys","set","isundefined","a","isnumber","isboolean","isobject","isstring","isfunction","isarray","Array","isArray","gettagtype","getsymbol","Symbol","toString","call","replace","toLowerCase","isSet","Set","invalid_Function","message","ctxopen","Mounted","UnMounted","getMounted","getUnMounted","useMounted","fun","isFunction","push","Error","TypeError","useUnMounted","clearMounted","clearUnMounted","openctx","closectx","readysymbol","document","seteletext","e","v","textContent","setelehtml","innerHTML","appendchild","container","ele","appendChild","createsvgelement","createElementNS","svgnamespace","createnonescript","createDocumentFragment","createnativeelement","type","createElement","namespace","name","createtextnode","data","createTextNode","changetext","textnode","value","nodeValue","String","mathnamespace","createmathelement","domaddlisten","event","addEventListener","domremovelisten","removeEventListener","getdomchildren","from","childNodes","getAttribute","HTMLElementprototype","setAttribute","removeAttribute","HTMLElement","prototype","isString","isReactiveState","ReactiveState","textnodesymbol","eventtargetsymbol","memlisteners","dispatchsymbol","subscribesymbol","removeallistenerssymbol","addallistenerssymbol","[object Object]","init","this","undefined","EventTarget","isprimitive","Object","defineProperty","configurable","writable","toStringTag","forEach","callback","JSON","stringify","eventname","dispatchEvent","CustomEvent","detail","toPrimitive","requestAnimationFrame","ref","html","createhtmlandtextdirective","text","errorname","watch","state","valuestring","objtostylestring","o","entries","map","key","join","asserthtmlelement","Element","createeleattragentreadwrite","isinputtextortextareaflag","isinputtextortextarea","temp","create","outputattrs","Proxy","keys","attributesownkeys","target","getattribute","parse","error","t","setattribute","k","hasAttribute","otherdescipter","enumerable","myvalue","getAttributeNames","geteletagname","tagName","tagname","attributeChangedCallback","AttrChange","qualifiedName","oldValue","isVirtualdom","Virtualdom","props","children","propsentries","assign","bindattr","fromEntries","filter","test","flat","onevent","slice","directives","eventlistenerssymbol","element","firstaddlisteners","console","callarray","removelisteners","readdlisteners","onmounted","Node","bindstatesymbol","rewatch","onunmounted","unwatch","n","r","u","p","length","s","h","apply","f","Map","arguments","typenormalized","propsnormalized","childrennormalized","Infinity","trim","inargs","htm","isvalidvdom","flag","includes","assertvalidvirtualdom","args","vdom","invalid_Virtualdom","eles","createApp","el","isNodeArray","body","documentElement","head","elesarray","mount","render","array","invalid_ReactiveState","truevdomsymbol","falsevdomsymbol","trueelesymbol","falseelesymbol","handletrue","handlefalse","Condition","propsjson","options","super","optionstrue","optionsfalse","Boolean","elementtomount","attrs","createeleattr","conditon","iftrue","iffalse","true","false","statekey","invalid_custom_element_class","customElements","使用value从表中查询key","表","组件状态名","find","CustomElementRegistry","elementset","for","elementmap","initclass","extendsname","RandomDefineCustomElement","isclassextendsHTMLElement","elementname","getrandomstringandnumber","define","extends","constructor","add","iterator","getrandomcharactor","fill","i","fromCharCode","Math","floor","random","getrandomhexnumber","createcostumelemet","reactivestatesymbol","virtualdomsymbol","throwinvalideletype","reactive","handleprops","attribute1","primitivestate","callbacks","values","setPrototypeOf","deepobserveaddpath","patharray","ancestor","fakeobj","argumentslist","thisarg","argarray","descripter","observedeepagent","createstate","returnvalue","dele","deepobserve","attributessymbol","elementsymbol","vdomsymbol","mountedsymbol","unmountedsymbol","createComponent","custfun","defaultProps","Component","thisattributess","readonlyproxy","possiblyvirtualdom","thisvdomsymbol","_c","extenddirectives","origin","eventsarray","concat","createRef","Fragment"],"mappings":"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"}