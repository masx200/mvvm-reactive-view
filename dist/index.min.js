var t,e,n=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var o=t[e];r[o[0]]=o[1]}return r};function r(t){return"object"==typeof t&&null!==t}function o(t){return"string"==typeof t}function i(t){return"function"==typeof t}function c(t){return t instanceof Array&&Array.isArray(t)}function f(t){return Symbol(t)}function u(t){return o(t)||function(t){return"number"==typeof t}(t)||function(t){return"boolean"==typeof t}(t)||function(t){return void 0===t}(t)}"function"!=typeof Object.fromEntries&&(Object.fromEntries=n),"function"!=typeof Array.prototype.flat&&(Array.prototype.flat=function(t=1){return t<=1?this.reduce((t,e)=>t.concat(e),[]):function t(e){return e.reduce((e,n)=>Array.isArray(n)?e.concat(t(n)):e.concat(n),[])}(this)});const s=Symbol("eventtatget"),a=Symbol("memlisteners"),l=f("dispatch"),p=f("subscribe"),y=f("removeallisteners"),v=f("addallisteners");class h extends Array{constructor(n){if(super(),this[t]=new EventTarget,this[e]=[],!u(n)&&!r(n))throw TypeError("invalid State");this.value=n,Object.defineProperty(this,Symbol.toStringTag,{value:"ReactiveState"})}[(t=s,e=a,Symbol.toPrimitive)](){let t=this.value;return u(t)?t:r(t)?JSON.stringify(t):void 0}valueOf(){return this.value}toString(){let t=this.value;return u(t)?String(t):r(t)?JSON.stringify(t):""}[l](t){let e=t?String(t):"value";"value"!==e&&this[s].dispatchEvent(new Event(e)),this[s].dispatchEvent(new Event("value"))}[p](t,e){let n=e?String(e):"value";this[a].push([n,()=>t(this)])}[y](){this[a].forEach(([t,e])=>{this[s].removeEventListener(t,e)})}[v](){this[a].forEach(([t,e])=>{this[s].addEventListener(t,e)})}}class m{constructor(t="",e={},n=[]){this.props={},this.children=[],this.directives={},this.onevent={},this.bindattr={};const r=Object.entries(e);Object.assign(this,{type:t,bindattr:Object.fromEntries(r.filter(([t])=>/[A-Za-z]/.test(t[0])).filter(t=>t[1]instanceof h)),props:Object.fromEntries(r.filter(([t])=>/[A-Za-z]/.test(t[0])).filter(t=>!(t[1]instanceof h))),children:n,onevent:Object.fromEntries(r.filter(([t])=>/\@/.test(t[0])).map(([t,e])=>[t.slice(1),e])),directives:Object.fromEntries(r.filter(([t])=>/\*/.test(t[0])).map(([t,e])=>[t.slice(1),e]))}),Object.defineProperty(this,Symbol.toStringTag,{value:"virtualdom"})}}var g=function(t,e,n,r){for(var o=1;o<e.length;o++){var i=e[o],c="number"==typeof i?n[i]:i,f=e[++o];1===f?r[0]=c:3===f?r[1]=Object.assign(r[1]||{},c):5===f?(r[1]=r[1]||{})[e[++o]]=c:6===f?r[1][e[++o]]+=c+"":r.push(f?t.apply(null,g(t,c,n,["",null])):c)}return r},d=function(t){for(var e,n,r=1,o="",i="",c=[0],f=function(t){1===r&&(t||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?c.push(t||o,0):3===r&&(t||o)?(c.push(t||o,1),r=2):2===r&&"..."===o&&t?c.push(t,3):2===r&&o&&!t?c.push(!0,5,o):r>=5&&((o||!t&&5===r)&&(c.push(o,r,n),r=6),t&&(c.push(t,r,n),r=6)),o=""},u=0;u<t.length;u++){u&&(1===r&&f(),f(u));for(var s=0;s<t[u].length;s++)e=t[u][s],1===r?"<"===e?(f(),c=[c],r=3):o+=e:4===r?"--"===o&&">"===e?(r=1,o=""):o=e+o[0]:i?e===i?i="":o+=e:'"'===e||"'"===e?i=e:">"===e?(f(),r=1):r&&("="===e?(r=5,n=o,o=""):"/"===e&&(r<5||">"===t[u][s+1])?(f(),3===r&&(c=c[0]),r=c,(c=c[0]).push(r,2),r=0):" "===e||"\t"===e||"\n"===e||"\r"===e?(f(),r=2):o+=e),3===r&&"!--"===o&&(r=4,c=c[0])}return f(),c},E="function"==typeof Map,b=E?new Map:{},w=E?function(t){var e=b.get(t);return e||b.set(t,e=d(t)),e}:function(t){for(var e="",n=0;n<t.length;n++)e+=t[n].length+"-"+t[n];return b[e]||(b[e]=d(t))};function S(t="",e={},...n){var c=o(t)||i(t)?t:"",f=r(e)?e:{},u=n.flat(1/0);return"string"==typeof c&&""===c?u:new m(c,f,u)}const R=function(t){var e=g(this,w(t),arguments,[]);return e.length>1?e:e[0]}.bind(S);function O(t){var e=!1;return c(t)?e=!t.map(t=>o(t)||t instanceof m).includes(!1):t instanceof m?O(t.children)&&(e=!0):o(t)&&(e=!0),e}function T(...t){var e=R(...t);if(O(e))return e;throw new TypeError("invalid Virtualdom!\n"+JSON.stringify(e,null,4))}const A=Symbol("eventlisteners");function P(t,e,n){n.forEach(n=>{t[A].push([e,n]),function(t,e,n){t.addEventListener(e,n)}(t,e,n)})}function j(t,e,n){if(!(t instanceof h&&i(e)))throw TypeError("invalid state or callback");n?t[p](e,n):t[p](e),requestAnimationFrame(()=>{t[v]()})}var x={ref(t,e,n){if("object"!=typeof e)throw TypeError("invalid ref");e.value=t},html(t,e,n){if("string"==typeof e)requestAnimationFrame(()=>{t.innerHTML=e});else{if(!(e instanceof h))throw TypeError("invalid html");j(e,e=>{t.innerHTML=String(e.value)}),requestAnimationFrame(()=>{t.innerHTML=String(e.value)})}},text(t,e,n){if("string"==typeof e)requestAnimationFrame(()=>{t.textContent=e});else{if(!(e instanceof h))throw TypeError("invalid text");j(e,e=>{t.textContent=String(e.value)}),requestAnimationFrame(()=>{t.textContent=String(e.value)})}}};const L=new class extends Array{constructor(){super(),Object.defineProperty(this,Symbol.toStringTag,{value:"setlikearray"})}push(...t){return t.forEach(t=>{(i(t)||r(t))&&(this.includes(t)||super.push(t))}),this.length}};function N(t,e){if(function(t){return!!(i(t)&&t.prototype&&t.prototype instanceof HTMLElement)}(t)){L.push(t);const n=function(t){return"c-"+L.indexOf(t)}(t);return customElements.get(n)===t||customElements.define(n,t),Reflect.construct(t,[e])}throw TypeError("invalid custom element class !")}const M="http://www.w3.org/2000/svg";function H(t,e){let n;e.innerHTML="",(n=t instanceof Array?t:[t]).forEach(t=>(function(t,e){t.appendChild(e)})(e,t))}function F(t){!function(t){if(t instanceof HTMLElement||t instanceof SVGElement||t instanceof Element)return!0;throw TypeError("invalid HTMLElement!")}(t);const e="INPUT"===t.tagName&&"text"===Reflect.get(t,"type")||"TEXTAREA"===t.tagName;var n=Object.create(null);return new Proxy(n,{ownKeys(){const n=Reflect.ownKeys(t.attributes).filter(t=>!/\d/.test(String(t)[0]));return e?Array.from(new Set([...n,"value"])):n},get(n,r){if(e&&"value"===r)return Reflect.get(t,"value");var o=t.getAttribute(String(r));if(o&&"string"==typeof o)try{return JSON.parse(String(o))}catch(t){return o}},set(n,r,o){return e&&"value"===r?Reflect.set(t,"value",o):(t.setAttribute(String(r),"object"==typeof(i=o)&&null!==i?JSON.stringify(o):String(o)),!0);var i},deleteProperty:(e,n)=>(t.removeAttribute(String(n)),!0),has:(n,r)=>!(!e||"value"!==r)||t.hasAttribute(String(r)),defineProperty:()=>!1,getOwnPropertyDescriptor(n,r){const o={enumerable:!0,configurable:!0,writable:!0};if(e&&"value"===r)return{value:Reflect.get(t,"value"),...o};var i=t.getAttribute(String(r));return i?{value:i,...o}:void 0},setPrototypeOf:()=>!1,getPrototypeOf:()=>null})}const K=Symbol("virtualdom");function q(){throw TypeError("invalid element type!")}function J(t,e){if("string"==typeof t)return o=t,document.createTextNode(o);if(t instanceof m&&"type"in t){let o;if("string"==typeof t.type){if("script"===t.type)return document.createDocumentFragment();o="svg"===t.type?document.createElementNS(M,"svg"):e?function(t,e){return document.createElementNS(t,e)}(e,t.type):(r=t.type,document.createElement(r))}else"function"==typeof t.type?o=N(t.type,t.children):q();var n=F(o);return Object.assign(n,t.props),o[K]=t,t.element=o,Object.entries(t.bindattr).forEach(([t,e])=>{n[t]=e.value,e[p](e=>{n[t]=e.value}),requestAnimationFrame(()=>{e[v]()})}),Object.entries(t.directives).forEach(([e,n])=>{if(!(e in x&&"function"==typeof x[e]))throw new Error("invalid directives "+e);x[e](o,n,t)}),o[A]||(o[A]=[]),Object.entries(t.onevent).forEach(([t,e])=>{!function(t,e,n){if("function"==typeof n)P(t,e,[n]);else{if(!c(n))throw TypeError("invalid EventListener");P(t,e,n)}}(o,t,e)}),"function"!=typeof t.type&&H(t.children.map(n=>"svg"===t.type?J(n,M):e?J(n,e):J(n)),o),o}var r,o;q()}function D(t,e){const n=e;if(!O(t))throw TypeError("invalid Virtualdom \n"+JSON.stringify(t,null,4));if(!(n instanceof HTMLElement))throw TypeError("invalid container HTMLElement!");if(n===document.body||n===document.documentElement||n===document.head)throw Error("Do not mount  to <html> or <body> <head>.");let r;return H((r=t instanceof Array?t:[t]).map(t=>J(t)),e),e}function k(t){return{value:t}}function C(t){return"object"==typeof t&&null!==t}function V(t){return"function"==typeof t}function z(t,e){if("function"!=typeof e)throw Error("observe callback is not valid function !");return"function"!=typeof Proxy?(setTimeout(()=>{throw Error("\u4e0d\u652f\u6301Proxy!")},0),t):V(t)||C(t)?function t(e,n,r=[],o=e){if("function"!=typeof n)throw Error("observe callback is not valid function !");if(V(e)||C(e)){let i;return i=C(e)?{}:()=>{},Reflect.setPrototypeOf(i,null),(i=>new Proxy(i,{defineProperty:(t,n,r)=>Reflect.defineProperty(e,n,r),deleteProperty:(t,i)=>(n(o,[...r,i],void 0,Reflect.get(e,i)),Reflect.deleteProperty(e,i)),ownKeys:()=>Reflect.ownKeys(e),has:(t,n)=>Reflect.has(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),setPrototypeOf:(t,n)=>Reflect.setPrototypeOf(e,n),construct(t,n){if("function"==typeof e)return Reflect.construct(e,n)},apply(t,n,r){if("function"==typeof e)return Reflect.apply(e,n,r)},getOwnPropertyDescriptor(t,n){var r=Reflect.getOwnPropertyDescriptor(e,n);return r?(r.configurable=!0,r):void 0},set:(t,i,c)=>("function"==typeof n&&n(o,[...r,i],c,Reflect.get(e,i)),Reflect.set(e,i,c)),get(o,i){var c=Reflect.get(e,i);return V(c)||C(c)?t(c,n,[...r,i],e):c}}))(i)}return e}(t,e,[],t):t}function Z(t){if(u(t))return new Proxy(new h(t),{set:(t,e,n)=>!("value"!==e||!u(n))&&(Reflect.set(t,e,n),t[l](),!0)});if(r(t))return new Proxy(new h(t),{get(t,e){const n=Reflect.get(t,"value");return Reflect.has(t,e)?Reflect.get(t,e):Reflect.has(n,e)?z(Reflect.get(n,e),()=>{t[l](e)}):void 0},ownKeys:t=>Array.from(new Set([...Reflect.ownKeys(t),...Reflect.ownKeys(Reflect.get(t,"value"))])),set(t,e,n){const o=Reflect.get(t,"value");if("value"===e&&r(n))return Reflect.set(t,e,n),t[l](),!0;if(Reflect.has(t,e)){if("length"!==e)return!1;Reflect.set(t,e,n),t[l](e)}else Reflect.set(o,e,n),t[l](e);return!0}});throw TypeError("invalid State")}export{D as createApp,S as createElemet,k as createRef,Z as createState,S as h,T as html,j as watch};
//# sourceMappingURL=index.min.js.map
